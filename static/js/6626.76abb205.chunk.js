"use strict";(self.webpackChunkData_Design_AI_for_Urban_Data_and_Viz_Harvard_GSD=self.webpackChunkData_Design_AI_for_Urban_Data_and_Viz_Harvard_GSD||[]).push([[6626],{74477:function(t,e,r){r.d(e,{Ue:function(){return fr}});var n=r(1413),o=r(10064),i=r(15671),a=r(43144),s=r(60136),u=r(29388),l=r(27366),c=r(92026),p=r(49861),f=(r(63780),r(25243),r(69912)),v=(r(32718),r(93169),r(46784)),h=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).raster=void 0,t}return(0,a.Z)(r)}(v.wq);(0,l._)([(0,p.Cb)({json:{write:!0}})],h.prototype,"raster",void 0);var m,d=h=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],h),y=m=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){return(0,i.Z)(this,r),e.apply(this,arguments)}return(0,a.Z)(r,[{key:"clone",value:function(){return new m({raster:this.raster})}}]),r}(d),g=y=m=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],y),w=r(89125),x=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionArguments=null,t.readingBufferSize=0,t}return(0,a.Z)(r,[{key:"bind",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._getRasterValues(),n=0;n<r.length;n++){var o=r[n];if(o&&"object"==typeof o&&"bind"in o&&(!o.rasterInfo||e)){var i=o.bind(t,e);if(!i.success)return i}}return!this.rasterInfo||e?(this.sourceRasterInfos=this._getSourceRasterInfos(t),this._bindSourceRasters()):{success:!0}}},{key:"process",value:function(t){var e=this,r=this._getRasterValues().map((function(r){return e._readRasterValue(r,t)}));return this._processPixels((0,n.Z)((0,n.Z)({},t),{},{pixelBlocks:r}))}},{key:"getPrimaryRasters",value:function(){var t=[],e=[];return this._getPrimaryRasters(this,t,e),{rasters:t,rasterIds:e}}},{key:"_getOutputPixelType",value:function(t){var e;return"unknown"===this.outputPixelType?t:null!==(e=this.outputPixelType)&&void 0!==e?e:t}},{key:"_getRasterValues",value:function(){var t=this,e=this.rasterArgumentNames;return"rasters"===e[0]&&Array.isArray(this.functionArguments.rasters)?this.functionArguments.rasters:e.map((function(e){return t.functionArguments[e]}))}},{key:"_getSourceRasterInfos",value:function(t){var e=this._getRasterValues(),r=t.rasterInfos,n=t.rasterIds;return e.map((function(t){return t&&"object"==typeof t&&"bind"in t&&t.rasterInfo?t.rasterInfo:"string"==typeof t&&n.includes(t)?r[n.indexOf(t)]:r[0]}))}},{key:"_getPrimaryRasterId",value:function(t){return null===t||void 0===t?void 0:t.url}},{key:"_getPrimaryRasters",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=0;n<t.sourceRasters.length;n++){var o=t.sourceRasters[n];if("number"!=typeof o)if("bind"in o)this._getPrimaryRasters(o,e,r);else{var i=o,a=this._getPrimaryRasterId(i);if(null==a)continue;r.includes(a)||(this.mainPrimaryRasterId===a?(e.unshift(i),r.unshift(a)):(e.push(i),r.push(a)))}}}},{key:"_readRasterValue",value:function(t,e){var r=e.primaryPixelBlocks;if((0,c.Wi)(t)||"$$"===t){var n=r[0];return(0,c.Wi)(n)?null:n.clone()}if("string"==typeof t){var o=e.primaryRasterIds.indexOf(t);return-1===o?null:r[o]}if("number"==typeof t){var i=r[0];if((0,c.Wi)(i))return null;var a=new Float32Array(i.width*i.height);a.fill(t);var s=i.clone();return s.pixels=s.pixels.map((function(){return a})),s}return t.process(e)}}]),r}(v.wq);(0,l._)([(0,p.Cb)({json:{write:!0}})],x.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],x.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}}),(0,w.p)((function(t){return null===t||void 0===t?void 0:t.toLowerCase()}))],x.prototype,"outputPixelType",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],x.prototype,"mainPrimaryRasterId",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"sourceRasters",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],x.prototype,"sourceRasterInfos",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],x.prototype,"rasterInfo",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],x.prototype,"readingBufferSize",void 0);var Z=x=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.BaseRasterFunction")],x),b=r(86807),_=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Aspect",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];this.isGCS=t.spatialReference.isGeographic,this.outputPixelType=this._getOutputPixelType("f32");var e=t.clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,this.rasterInfo=e,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return null;var n=t.extent,o=n?{x:n.width/r.width,y:n.height/r.height}:{x:1,y:1};return(0,b.M_)(r,{resolution:o})}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],_.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:g,json:{write:!0,name:"rasterFunctionArguments"}})],_.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],_.prototype,"isGCS",void 0);var A=_=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.AspectFunction")],_),C=r(84652),k=r(27135),N=r(29439),F=r(43404),S=r(96212),T=new Set(["+","-","*","/","(",")"]);function j(t,e,r,n){if("number"==typeof r&&"number"==typeof n)return r+n;var o;if("number"==typeof r){o=n.length;var i=r;(r=new Float32Array(o)).fill(i)}else if(o=r.length,n.constructor===Number){var a=n;(n=new Float32Array(o)).fill(a)}var s=new Float32Array(o);switch(e){case"+":for(var u=0;u<o;u++)(null==t||t[u])&&(s[u]=r[u]+n[u]);break;case"-":for(var l=0;l<o;l++)(null==t||t[l])&&(s[l]=r[l]-n[l]);break;case"*":for(var c=0;c<o;c++)(null==t||t[c])&&(s[c]=r[c]*n[c]);break;case"/":for(var p=0;p<o;p++)(null==t||t[p])&&n[p]&&(s[p]=r[p]/n[p]);break;case"(":case")":throw"encountered error with custom band index equation"}return s}function R(t,e){t.splice(e,1);var r=0,n=0;do{r=0,n=0;for(var o=0;o<t.length;o++)if("("===t[o])r=o;else if(")"===t[o]){n=o;break}n===r+1&&t.splice(r,2)}while(n===r+1);return t}function I(t){if(1===t.length)return{opIndex:0,numIndex:0};for(var e=0,r=0,n=0;n<t.length;n++)if("("===t[n])e=n;else if(")"===t[n]){r=n;break}for(var o=0===r?t:t.slice(e+1,r),i=-1,a=0;a<o.length;a++)if("*"===o[a]||"/"===o[a]){i=a;break}if(i>-1)r>0&&(i+=e+1);else{for(var s=0;s<o.length;s++)if("+"===o[s]||"-"===o[s]){i=s;break}r>0&&(i+=e+1)}for(var u=0,l=0;l<i;l++)"("===t[l]&&u++;return{opIndex:i,numIndex:i-u}}function B(t,e,r){var n,o=function(t,e){(t=t.replace(/ /g,"")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));for(var r=t.split(""),n=[],o=[],i="",a=0;a<r.length;a++){var s=r[a];if(T.has(s))""!==i&&o.push(parseFloat(i)),n.push(s),i="";else{if("b"===s.toLowerCase()){a++,i=s.concat(r[a]),o.push(e[parseInt(i[1],10)-1]),i="";continue}i=i.concat(s),a===r.length-1&&o.push(parseFloat(i))}}return{ops:n,nums:o}}(r,e),i=o.ops,a=o.nums;if(0===i.length){var s=1===a.length?a[0]:e[0];if(s instanceof Float32Array)return[s];var u=new Float32Array(e[0].length);return"number"==typeof s?u.fill(s):u.set(s),[u]}for(;i.length>0;){var l=I(i),c=l.numIndex,p=l.opIndex;if(n=j(t,i[p],a[c],a[c+1]),1===i.length)break;i=R(i,p),a.splice(c,2,n)}return[n]}var P,D=r(17314),M=new F.X({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function E(t,e){var r;if(!(0,D.nk)(t))return t;var n,o=e.equation,i=e.method,a=e.bandIndexes.map((function(t){return t-1})),s=t.pixels,u=t.mask;switch(i){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":n=G(u,s[a[0]],s[a[1]]);break;case"ndwi":n=G(u,s[a[1]],s[a[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":n=function(t,e,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var a=e[i],s=r[i];s&&(o[i]=a/s)}return[o]}(u,s[a[0]],s[a[1]]);break;case"ci-g":case"ci-re":n=function(t,e,r){for(var n=e.length,o=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var a=e[i],s=r[i];s&&(o[i]=a/s-1)}return[o]}(u,s[a[0]],s[a[1]]);break;case"savi":n=function(t,e,r,n){for(var o=r.length,i=new Float32Array(o),a=0;a<o;a++)if(null==t||t[a]){var s=r[a],u=e[a],l=u+s+n;l&&(i[a]=(u-s)/l*(1+n))}return[i]}(u,s[a[0]],s[a[1]],a[2]+1);break;case"tsavi":n=function(t,e,r,n,o,i){for(var a=r.length,s=new Float32Array(a),u=-o*n+i*(1+n*n),l=0;l<a;l++)if(null==t||t[l]){var c=r[l],p=e[l],f=o*p+c+u;f&&(s[l]=n*(p-n*c-o)/f)}return[s]}(u,s[a[0]],s[a[1]],a[2]+1,a[3]+1,a[4]+1);break;case"msavi":n=function(t,e,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var a=r[i],s=e[i];o[i]=.5*(2*(s+1)-Math.sqrt(Math.pow(2*s+1,2)-8*(s-a)))}return[o]}(u,s[a[0]],s[a[1]]);break;case"gemi":n=function(t,e,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var a=r[i],s=e[i];if(1!==a){var u=(2*(s*s-a*a)+1.5*s+.5*a)/(s+a+.5);o[i]=u*(1-.25*u)-(a-.125)/(1-a)}}return[o]}(u,s[a[0]],s[a[1]]);break;case"pvi":n=function(t,e,r,n,o){for(var i=r.length,a=new Float32Array(i),s=Math.sqrt(1+n*n),u=0;u<i;u++)if(null==t||t[u]){var l=r[u],c=e[u];a[u]=(c-n*l-o)/s}return[a]}(u,s[a[0]],s[a[1]],a[2]+1,a[3]+1);break;case"gvitm":n=function(t,e){for(var r=(0,N.Z)(e,6),n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],u=r[5],l=n.length,c=new Float32Array(l),p=0;p<l;p++)(null==t||t[p])&&(c[p]=-.2848*n[p]-.2435*o[p]-.5436*i[p]+.7243*a[p]+.084*s[p]-1.18*u[p]);return[c]}(u,[s[a[0]],s[a[1]],s[a[2]],s[a[3]],s[a[4]],s[a[5]]]);break;case"sultan":n=function(t,e){for(var r=(0,N.Z)(e,6),n=r[0],o=r[2],i=r[3],a=r[4],s=r[5],u=n.length,l=new Float32Array(u),c=new Float32Array(u),p=new Float32Array(u),f=0;f<u;f++)(null==t||t[f])&&(l[f]=s[f]?a[f]/s[f]*100:0,c[f]=n[f]?a[f]/n[f]*100:0,p[f]=i[f]?o[f]/i[f]*(a[f]/i[f])*100:0);return[l,c,p]}(u,[s[a[0]],s[a[1]],s[a[2]],s[a[3]],s[a[4]],s[a[5]]]);break;case"vari":n=function(t,e){for(var r=(0,N.Z)(e,3),n=r[0],o=r[1],i=r[2],a=n.length,s=new Float32Array(a),u=0;u<a;u++)if(null==t||t[u])for(u=0;u<a;u++){var l=n[u],c=o[u],p=c+l-i[u];p&&(s[u]=(c-l)/p)}return[s]}(u,[s[a[0]],s[a[1]],s[a[2]]]);break;case"mtvi2":n=function(t,e){for(var r=(0,N.Z)(e,3),n=r[0],o=r[1],i=r[2],a=n.length,s=new Float32Array(a),u=0;u<a;u++)if(null==t||t[u])for(u=0;u<a;u++){var l=n[u],c=o[u],p=i[u],f=Math.sqrt(Math.pow(2*l+1,2)-6*l-5*Math.sqrt(c)-.5);s[u]=1.5*(1.2*(l-p)-2.5*(c-p))*f}return[s]}(u,[s[a[0]],s[a[1]],s[a[2]]]);break;case"rtvi-core":n=function(t,e){for(var r=(0,N.Z)(e,3),n=r[0],o=r[1],i=r[2],a=n.length,s=new Float32Array(a),u=0;u<a;u++)if(null==t||t[u])for(u=0;u<a;u++){var l=n[u],c=o[u],p=i[u];s[u]=100*(l-c)-10*(l-p)}return[s]}(u,[s[a[0]],s[a[1]],s[a[2]]]);break;case"evi":n=function(t,e){for(var r=(0,N.Z)(e,3),n=r[0],o=r[1],i=r[2],a=n.length,s=new Float32Array(a),u=0;u<a;u++)if(null==t||t[u])for(u=0;u<a;u++){var l=n[u],c=o[u],p=l+6*c-7.5*i[u]+1;p&&(s[u]=2.5*(l-c)/p)}return[s]}(u,[s[a[0]],s[a[1]],s[a[2]]]);break;case"wndwi":n=function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=(0,N.Z)(e,3),o=n[0],i=n[1],a=n[2],s=i.length,u=new Float32Array(s),l=0;l<s;l++)if(null==t||t[l])for(l=0;l<s;l++){var c=o[l],p=i[l],f=a[l],v=c+r*p+(1-r)*f;v&&(u[l]=(c-r*p-(1-r)*f)/v)}return[u]}(u,[s[a[0]],s[a[1]],s[a[2]]],null!==(r=a[3])&&void 0!==r?r:.5);break;case"bai":n=function(t,e,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i])for(i=0;i<n;i++){var a=Math.pow(.1-e[i],2)+Math.pow(.06-r[i],2);a&&(o[i]=1/a)}return[o]}(u,s[a[0]],s[a[1]]);break;case"custom":n=B(u,s,o);break;default:return t}var l=(0,c.pC)(u)?new Uint8Array(u.length):null;(0,c.pC)(u)&&(0,c.pC)(l)&&l.set(u);var p=new S.Z({width:t.width,height:t.height,pixelType:"f32",pixels:n,mask:l});return p.updateStatistics(),p}function G(t,e,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var a=e[i],s=r[i],u=a+s;u&&(o[i]=(a-s)/u)}return[o]}var O=P=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).method="custom",t}return(0,a.Z)(r,[{key:"clone",value:function(){return new P({method:this.method,bandIndexes:this.bandIndexes,raster:(0,C.d9)(this.raster)})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{type:String,write:!0}})],O.prototype,"bandIndexes",void 0),(0,l._)([(0,k.J)(M)],O.prototype,"method",void 0);var L=O=P=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],O),V=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="BandArithmetic",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){this.outputPixelType=this._getOutputPixelType("f32");var t=this.sourceRasterInfos[0],e=t.clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,e.bandCount="sultan"===this.functionArguments.method?t.bandCount:1,this.rasterInfo=e,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return r;var n=this.functionArguments,o=n.method,i=n.bandIndexes,a=i.split(" ").map((function(t){return parseFloat(t)}));return E(r,{method:o,bandIndexes:a,equation:i})}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],V.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],V.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],V.prototype,"rasterArgumentNames",void 0);var z,q=V=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],V),H=r(38511),W=r(57634),X=z=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){return(0,i.Z)(this,r),e.apply(this,arguments)}return(0,a.Z)(r,[{key:"readColorRamp",value:function(t){return(0,W.i)(t)}},{key:"clone",value:function(){var t;return new z({colormap:(0,C.d9)(this.colormap),colormapName:this.colormapName,colorRamp:null===(t=this.colorRamp)||void 0===t?void 0:t.clone(),colorRampName:this.colorRampName})}}]),r}(d);(0,l._)([(0,p.Cb)({type:[[Number]],json:{write:!0}})],X.prototype,"colormap",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],X.prototype,"colormapName",void 0),(0,l._)([(0,p.Cb)({types:W.V,json:{write:!0}})],X.prototype,"colorRamp",void 0),(0,l._)([(0,H.r)("colorRamp")],X.prototype,"readColorRamp",null),(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],X.prototype,"colorRampName",void 0);var U=X=z=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],X),J=r(22850),Y=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Colormap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.sourceRasterInfos[0];if(r.bandCount>1)return{success:!1,error:"colormap-function: source data must be single band"};var n=this.functionArguments,o=n.colormap,i=n.colorRamp;if(null!==(t=o)&&void 0!==t&&t.length||i&&(o=(0,J.XL)(i,256,!0)),null===(e=o)||void 0===e||!e.length)return{success:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");var a=r.clone();return a.pixelType=this.outputPixelType,a.colormap=o,this.rasterInfo=a,{success:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],Y.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:U,json:{write:!0,name:"rasterFunctionArguments"}})],Y.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],Y.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],Y.prototype,"indexedColormap",void 0);var K,$=Y=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.ColormapFunction")],Y),Q=r(93433),tt=r(31201),et=K=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){return(0,i.Z)(this,r),e.apply(this,arguments)}return(0,a.Z)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new K({rasters:(0,C.d9)(this.rasters)})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{write:!0}})],et.prototype,"rasters",void 0),(0,l._)([(0,tt.c)("rasters")],et.prototype,"writeRasters",null);var rt=et=K=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],et),nt=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="CompositeBand",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);var r=e.clone();if(r.attributeTable=null,r.colormap=null,r.pixelType=this.outputPixelType,r.bandCount=t.map((function(t){return t.bandCount})).reduce((function(t,e){return t+e})),t.every((function(t){var e=t.statistics;return(0,c.pC)(e)&&e.length}))){var n=[];t.forEach((function(t){var e=t.statistics;return(0,c.pC)(e)&&n.push.apply(n,(0,Q.Z)(e))})),r.statistics=n}if(t.every((function(t){var e=t.histograms;return(0,c.pC)(e)&&e.length}))){var o=[];t.forEach((function(t){var e=t.histograms;return(0,c.pC)(e)&&o.push.apply(o,(0,Q.Z)(e))})),r.histograms=o}return this.rasterInfo=r,{success:!0}}},{key:"_processPixels",value:function(t){var e=t.pixelBlocks;if(!e)return null;var r=null===e||void 0===e?void 0:e[0];return(0,c.Wi)(r)?null:(0,D.Gd)(e)}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],nt.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:rt,json:{write:!0,name:"rasterFunctionArguments"}})],nt.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],nt.prototype,"rasterArgumentNames",void 0);var ot,it=nt=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.CompositeBandFunction")],nt);!function(t){t[t.UserDefined=-1]="UserDefined",t[t.LineDetectionHorizontal=0]="LineDetectionHorizontal",t[t.LineDetectionVertical=1]="LineDetectionVertical",t[t.LineDetectionLeftDiagonal=2]="LineDetectionLeftDiagonal",t[t.LineDetectionRightDiagonal=3]="LineDetectionRightDiagonal",t[t.GradientNorth=4]="GradientNorth",t[t.GradientWest=5]="GradientWest",t[t.GradientEast=6]="GradientEast",t[t.GradientSouth=7]="GradientSouth",t[t.GradientNorthEast=8]="GradientNorthEast",t[t.GradientNorthWest=9]="GradientNorthWest",t[t.SmoothArithmeticMean=10]="SmoothArithmeticMean",t[t.Smoothing3x3=11]="Smoothing3x3",t[t.Smoothing5x5=12]="Smoothing5x5",t[t.Sharpening3x3=13]="Sharpening3x3",t[t.Sharpening5x5=14]="Sharpening5x5",t[t.Laplacian3x3=15]="Laplacian3x3",t[t.Laplacian5x5=16]="Laplacian5x5",t[t.SobelHorizontal=17]="SobelHorizontal",t[t.SobelVertical=18]="SobelVertical",t[t.Sharpen=19]="Sharpen",t[t.Sharpen2=20]="Sharpen2",t[t.PointSpread=21]="PointSpread",t[t.None=255]="None"}(ot||(ot={}));var at,st=new Map;function ut(t,e,r,n,o,i,a){for(var s=new Float32Array(e*r),u=i.length,l=a?0:n,c=a?n:0,p=a?1:e,f=l;f<r-l;f++)for(var v=f*e,h=c;h<e-c;h++)if(!o||o[v+h]){for(var m=0,d=0;d<u;d++)m+=t[v+h+(d-n)*p]*i[d];s[v+h]=m}return s}function lt(t,e,r,n,o,i,a){for(var s=new Float32Array(e*r),u=Math.floor(n/2),l=Math.floor(o/2),c=u;c<r-u;c++)for(var p=c*e,f=l;f<e-l;f++)if(!i||i[p+f]){for(var v=0,h=0;h<n;h++)for(var m=0;m<o;m++)v+=t[p+f+(h-u)*e+m-l]*a[h*o+m];s[p+f]=v}return s}function ct(t,e,r,n,o){for(var i=Math.floor(n/2),a=0;a<i;a++)for(var s=0;s<e;s++)t[a*e+s]=t[(o-1-a)*e+s],t[(r-1-a)*e+s]=t[(r-o+a)*e+s];for(var u=Math.floor(o/2),l=0;l<r;l++)for(var c=l*e,p=0;p<u;p++)t[c+p]=t[c+o-1-p],t[c+e-p-1]=t[c+e+p-o]}function pt(t,e){var r=function(t){for(var e=Math.sqrt(t.length),r=t.slice(0,e),n=[1],o=1;o<e;o++){for(var i=null,a=0;a<e;a++){var s=t[a+o*e],u=t[a];if(null==i)if(0===u){if(s)return{separable:!1,row:null,col:null}}else i=s/u;else if(s/u!==i)return{separable:!1,row:null,col:null}}if(null==i)return{separable:!1,row:null,col:null};n.push(i)}return{separable:!0,row:r,col:n}}(e.kernel),n=!1!==e.mirrorEdges,o=r.separable?function(t,e,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=t.pixels,i=t.width,a=t.height,s=t.pixelType,u=t.mask,l=o.length,c=[],p=e.length,f=r.length,v=Math.floor(p/2),h=Math.floor(f/2),m=0;m<l;m++){var d=ut(o[m],i,a,v,u,e,!0);d=ut(d,i,a,h,u,r,!1),n&&ct(d,i,a,p,f),c.push(d)}return new S.Z({width:i,height:a,pixelType:s,pixels:c,mask:u})}(t,r.row,r.col,n):function(t,e){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.pixels,o=t.width,i=t.height,a=t.pixelType,s=t.mask,u=n.length,l=[],c=e.kernel,p=e.rows,f=e.cols,v=0;v<u;v++){var h=lt(n[v],o,i,p,f,s,c);r&&ct(h,o,i,p,f),l.push(h)}return new S.Z({width:o,height:i,pixelType:a,pixels:l,mask:s})}(t,e,n),i=e.outputPixelType;return i&&o.clamp(i),o}st.set(ot.None,[0,0,0,0,1,0,0,0,0]),st.set(ot.LineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),st.set(ot.LineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),st.set(ot.LineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),st.set(ot.LineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),st.set(ot.GradientNorth,[-1,-2,-1,0,0,0,1,2,1]),st.set(ot.GradientWest,[-1,0,1,-2,0,2,-1,0,1]),st.set(ot.GradientEast,[1,0,-1,2,0,-2,1,0,-1]),st.set(ot.GradientSouth,[1,2,1,0,0,0,-1,-2,-1]),st.set(ot.GradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),st.set(ot.GradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),st.set(ot.SmoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),st.set(ot.Smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),st.set(ot.Smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),st.set(ot.Sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),st.set(ot.Sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),st.set(ot.Laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),st.set(ot.Laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),st.set(ot.SobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),st.set(ot.SobelVertical,[-1,0,1,-2,0,2,-1,0,1]),st.set(ot.Sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),st.set(ot.Sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),st.set(ot.PointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);var ft=at=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).rows=3,t.cols=3,t.kernel=[0,0,0,0,1,0,0,0,0],t}return(0,a.Z)(r,[{key:"kernelType",set:function(t){this._set("kernelType",t);var e=st.get(t);if(e&&t!==ot.UserDefined&&t!==ot.None){var r=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",r),this._set("rows",r)}}},{key:"clone",value:function(){return new at({cols:this.cols,rows:this.rows,kernel:(0,Q.Z)(this.kernel),kernelType:this.kernelType,raster:(0,C.d9)(this.raster)})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{type:Number,write:!0}})],ft.prototype,"rows",void 0),(0,l._)([(0,p.Cb)({json:{type:Number,write:!0}})],ft.prototype,"cols",void 0),(0,l._)([(0,p.Cb)({json:{name:"type",type:Number,write:!0}})],ft.prototype,"kernelType",null),(0,l._)([(0,p.Cb)({json:{type:[Number],write:!0}})],ft.prototype,"kernel",void 0);var vt=ft=at=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],ft),ht=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Convolution",t.rasterArgumentNames=["raster"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments,e=t.kernelType,r=t.rows,n=t.cols,o=t.kernel;if(!st.has(e))return{success:!1,error:"convolution-function: the specified kernel type is not supported ".concat(e)};if(e!==ot.None&&r*n!==o.length)return{success:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var i=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(i.pixelType);var a=i.clone();a.pixelType=this.outputPixelType;var s=[ot.None,ot.Sharpen,ot.Sharpen2,ot.Sharpening3x3,ot.Sharpening5x5];return"u8"===this.outputPixelType||s.includes(e)||(a.statistics=null,a.histograms=null),this.rasterInfo=a,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r)||this.functionArguments.kernelType===ot.None)return r;var n=this.functionArguments,o=n.kernel,i=n.rows,a=n.cols,s=o.reduce((function(t,e){return t+e}));return 0!==s&&1!==s&&(o=o.map((function(t){return t/s}))),pt(r,{kernel:o,rows:i,cols:a,outputPixelType:this.outputPixelType})}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],ht.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:vt,json:{write:!0,name:"rasterFunctionArguments"}})],ht.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],ht.prototype,"rasterArgumentNames",void 0);var mt,dt=ht=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.ConvolutionFunction")],ht),yt=mt=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).bandIDs=[],t.missingBandAction=D.CD.bestMatch,t}return(0,a.Z)(r,[{key:"clone",value:function(){return new mt({bandIDs:(0,Q.Z)(this.bandIDs),missingBandAction:this.missingBandAction})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{write:!0}})],yt.prototype,"bandIDs",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],yt.prototype,"missingBandAction",void 0);var gt=yt=mt=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],yt),wt=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="ExtractBand",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0],e=t.bandCount,r=this.functionArguments,n=r.bandIDs;if(r.missingBandAction===D.CD.fail&&n.some((function(t){return t<0||t>=e})))return{success:!1,error:"extract-band-function: invalid bandIDs"};this.outputPixelType=this._getOutputPixelType("f32");var o=t.clone();o.pixelType=this.outputPixelType;var i=o.statistics,a=o.histograms;return(0,c.pC)(i)&&i.length&&(o.statistics=n.map((function(t){return i[t]||i[i.length-1]}))),(0,c.pC)(a)&&a.length&&(o.histograms=n.map((function(t){return a[t]||a[a.length-1]}))),this.rasterInfo=o,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return null;var n=r.pixels.length,o=this.functionArguments.bandIDs.map((function(t){return t>=n?n-1:t}));return r.extractBands(o)}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],wt.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:gt,json:{write:!0,name:"rasterFunctionArguments"}})],wt.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],wt.prototype,"rasterArgumentNames",void 0);var xt,Zt=wt=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.ExtractBandFunction")],wt),bt=xt=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).rasters=[],t.processAsMultiband=!1,t}return(0,a.Z)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new xt({method:this.operation,processAsMultiband:this.processAsMultiband,rasters:(0,C.d9)(this.rasters)})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{write:!0}})],bt.prototype,"operation",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],bt.prototype,"rasters",void 0),(0,l._)([(0,tt.c)("rasters")],bt.prototype,"writeRasters",null),(0,l._)([(0,p.Cb)({json:{write:!0}})],bt.prototype,"processAsMultiband",void 0);var _t,At=bt=xt=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],bt),Ct=r(37762);!function(t){t[t.Plus=1]="Plus",t[t.Minus=2]="Minus",t[t.Times=3]="Times",t[t.SquareRoot=4]="SquareRoot",t[t.Power=5]="Power",t[t.ACos=6]="ACos",t[t.ASin=7]="ASin",t[t.ATan=8]="ATan",t[t.ATanH=9]="ATanH",t[t.Abs=10]="Abs",t[t.BitwiseAnd=11]="BitwiseAnd",t[t.BitwiseLeftShift=12]="BitwiseLeftShift",t[t.BitwiseNot=13]="BitwiseNot",t[t.BitwiseOr=14]="BitwiseOr",t[t.BitwiseRightShift=15]="BitwiseRightShift",t[t.BitwiseXOr=16]="BitwiseXOr",t[t.BooleanAnd=17]="BooleanAnd",t[t.BooleanNot=18]="BooleanNot",t[t.BooleanOr=19]="BooleanOr",t[t.BooleanXOr=20]="BooleanXOr",t[t.Cos=21]="Cos",t[t.CosH=22]="CosH",t[t.Divide=23]="Divide",t[t.EqualTo=24]="EqualTo",t[t.Exp=25]="Exp",t[t.Exp10=26]="Exp10",t[t.Exp2=27]="Exp2",t[t.GreaterThan=28]="GreaterThan",t[t.GreaterThanEqual=29]="GreaterThanEqual",t[t.Int=30]="Int",t[t.IsNull=31]="IsNull",t[t.Float=32]="Float",t[t.LessThan=33]="LessThan",t[t.LessThanEqual=34]="LessThanEqual",t[t.Ln=35]="Ln",t[t.Log10=36]="Log10",t[t.Log2=37]="Log2",t[t.Majority=38]="Majority",t[t.Max=39]="Max",t[t.Mean=40]="Mean",t[t.Med=41]="Med",t[t.Min=42]="Min",t[t.Minority=43]="Minority",t[t.Mod=44]="Mod",t[t.Negate=45]="Negate",t[t.NotEqual=46]="NotEqual",t[t.Range=47]="Range",t[t.RoundDown=48]="RoundDown",t[t.RoundUp=49]="RoundUp",t[t.SetNull=50]="SetNull",t[t.Sin=51]="Sin",t[t.SinH=52]="SinH",t[t.Square=53]="Square",t[t.Std=54]="Std",t[t.Sum=55]="Sum",t[t.Tan=56]="Tan",t[t.TanH=57]="TanH",t[t.Variety=58]="Variety",t[t.ACosH=59]="ACosH",t[t.ASinH=60]="ASinH",t[t.ATan2=61]="ATan2",t[t.FloatDivide=64]="FloatDivide",t[t.FloorDivide=65]="FloorDivide",t[t.MajorityIgnoreNoData=66]="MajorityIgnoreNoData",t[t.MaxIgnoreNoData=67]="MaxIgnoreNoData",t[t.MeanIgnoreNoData=68]="MeanIgnoreNoData",t[t.MedIgnoreNoData=69]="MedIgnoreNoData",t[t.MinIgnoreNoData=70]="MinIgnoreNoData",t[t.MinorityIgnoreNoData=71]="MinorityIgnoreNoData",t[t.RangeIgnoreNoData=72]="RangeIgnoreNoData",t[t.StdIgnoreNoData=73]="StdIgnoreNoData",t[t.SumIgnoreNoData=74]="SumIgnoreNoData",t[t.VarietyIgnoreNoData=75]="VarietyIgnoreNoData",t[t.Con=76]="Con"}(_t||(_t={}));function kt(t){var e=t.map((function(t){return t.mask})).filter((function(t){return(0,c.pC)(t)}));if(0===e.length)return null;var r=e[0].length,n=new Uint8Array(r);if(1===e.length)return n.set(e[0]),n;for(var o,i=e[0],a=1;a<e.length;a++){o=e[a];for(var s=0;s<r;s++)n[s]=i[s]|o[s];i=o}return n}function Nt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]+i[u]);return s}function Ft(t,e,r){var n=(0,N.Z)(t,1)[0],o=n.length,i=S.Z.createEmptyBand("f32",o);return i.set(n),i}function St(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]-i[u]);return s}function Tt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]*i[u]);return s}function jt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=0===i[u]?0:o[u]/i[u]);return s}function Rt(t,e,r){return jt(t,e,"f32")}function It(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=0===i[u]?0:Math.floor(o[u]/i[u]));return s}function Bt(t,e,r,n){for(var o=(0,N.Z)(t,1)[0],i=o.length,a=S.Z.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(a[s]=n(o[s]));return a}function Pt(t,e,r,n){for(var o=(0,N.Z)(t,2),i=o[0],a=o[1],s=i.length,u=S.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=n(i[l],a[l]));return u}function Dt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]&i[u]);return s}function Mt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]<<i[u]);return s}function Et(t,e,r){for(var n=(0,N.Z)(t,1)[0],o=n.length,i=S.Z.createEmptyBand(r,o),a=0;a<o;a++)e&&!e[a]||(i[a]=~n[a]);return i}function Gt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]|i[u]);return s}function Ot(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]>>i[u]);return s}function Lt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]^i[u]);return s}function Vt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]&&i[u]?1:0);return s}function zt(t,e,r){for(var n=(0,N.Z)(t,1)[0],o=n.length,i=S.Z.createEmptyBand(r,o),a=0;a<o;a++)e&&!e[a]||(i[a]=n[a]?0:1);return i}function qt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]||i[u]?1:0);return s}function Ht(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=(o[u]?1:0)^(i[u]?1:0));return s}function Wt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]===i[u]?1:0);return s}function Xt(t,e,r,n){for(var o=(0,N.Z)(t,1)[0],i=o.length,a=S.Z.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(a[s]=Math.pow(n,o[s]));return a}function Ut(t,e,r){return Xt(t,e,r,10)}function Jt(t,e,r){return Xt(t,e,r,2)}function Yt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]>i[u]?1:0);return s}function Kt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]>=i[u]?1:0);return s}function $t(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]<i[u]?1:0);return s}function Qt(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]<=i[u]?1:0);return s}function te(t,e,r){var n=(0,N.Z)(t,1)[0].length,o=S.Z.createEmptyBand(r,n);if(!e)return o;for(var i=0;i<n;i++)o[i]=e[i]?0:1;return o}function ee(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]%i[u]);return s}function re(t,e,r){for(var n=(0,N.Z)(t,1)[0],o=n.length,i=S.Z.createEmptyBand(r,o),a=0;a<o;a++)e&&!e[a]||(i[a]=-n[a]);return i}function ne(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=0;u<a;u++)e&&!e[u]||(s[u]=o[u]===i[u]?0:1);return s}function oe(t,e,r){for(var n=(0,N.Z)(t,2),o=n[0],i=n[1],a=o.length,s=S.Z.createEmptyBand(r,a),u=new Uint8Array(a),l=0;l<a;l++)null!=e&&!e[l]||0!==o[l]||(s[l]=i[l],u[l]=255);return{band:s,mask:u}}function ie(t,e,r){for(var n=(0,N.Z)(t,3),o=n[0],i=n[1],a=n[2],s=o.length,u=S.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=o[l]?i[l]:a[l]);return u}function ae(t,e,r){var n=t.length;if(n<2)return t[0];var o=(0,N.Z)(t,1)[0],i=o.length,a=S.Z.createEmptyBand(r,i);a.set(o);for(var s=0;s<i;s++)if(!e||e[s])for(var u=1;u<n;u++){var l=t[u];a[s]<l[s]&&(a[s]=l[s])}return a}function se(t,e,r){var n=t.length;if(n<2)return t[0];var o=(0,N.Z)(t,1)[0],i=o.length,a=S.Z.createEmptyBand(r,i);a.set(o);for(var s=0;s<i;s++)if(!e||e[s])for(var u=1;u<n;u++){var l=t[u];a[s]>l[s]&&(a[s]=l[s])}return a}function ue(t,e,r){var n=t.length;if(n<2)return t[0];var o=(0,N.Z)(t,1)[0],i=o.length,a=S.Z.createEmptyBand(r,i);a.set(o);for(var s=0;s<i;s++)if(!e||e[s]){for(var u=a[s],l=1;l<n;l++){var c=t[l];a[s]<c[s]&&(a[s]=c[s]),u>c[s]&&(u=c[s])}a[s]-=u}return a}function le(t,e,r){var n=t.length;if(n<2)return t[0];var o=(0,N.Z)(t,1)[0],i=o.length,a=S.Z.createEmptyBand(r,i);a.set(o);for(var s=0;s<i;s++)if(!e||e[s]){for(var u=1;u<n;u++){var l=t[u];a[s]+=l[s]}a[s]/=n}return a}function ce(t,e,r){var n=t.length;if(n<2)return t[0];var o=(0,N.Z)(t,1)[0],i=o.length,a=S.Z.createEmptyBand(r,i);a.set(o);for(var s=0;s<i;s++)if(!e||e[s])for(var u=1;u<n;u++){var l=t[u];a[s]+=l[s]}return a}function pe(t,e,r){var n=t.length;if(n<2)return t[0];for(var o=(0,N.Z)(t,1)[0].length,i=S.Z.createEmptyBand(r,o),a=0;a<o;a++)if(!e||e[a]){for(var s=new Float32Array(n),u=0,l=0;l<n;l++){var c=t[l];u+=c[a],s[l]=c[a]}u/=n;for(var p=0,f=0;f<n;f++)p+=(s[f]-u)*s[f]-u;i[a]=Math.sqrt(p/n-1)}return i}function fe(t,e,r){var n=t.length;if(n<2)return t[0];for(var o=Math.floor(n/2),i=(0,N.Z)(t,1)[0].length,a=S.Z.createEmptyBand(r,i),s=new Float32Array(n),u=0;u<i;u++)if(!e||e[u]){for(var l=0;l<n;l++)s[l]=t[l][u];s.sort(),a[u]=s[o]}return a}function ve(t,e,r){var n=t.length;if(n<2)return t[0];for(var o=(0,N.Z)(t,1)[0].length,i=S.Z.createEmptyBand(r,o),a=new Map,s=0;s<o;s++)if(!e||e[s]){var u=void 0;a.clear();for(var l=0;l<n;l++)u=t[l][s],a.set(u,a.has(u)?a.get(u)+1:1);var c,p=0,f=0,v=(0,Ct.Z)(a.keys());try{for(v.s();!(c=v.n()).done;){var h=c.value;(p=a.get(h))>f&&(f=p,u=h)}}catch(m){v.e(m)}finally{v.f()}i[s]=u}return i}function he(t,e,r){var n=t.length;if(n<2)return t[0];for(var o=(0,N.Z)(t,1)[0].length,i=S.Z.createEmptyBand(r,o),a=new Map,s=0;s<o;s++)if(!e||e[s]){var u=void 0;a.clear();for(var l=0;l<n;l++)u=t[l][s],a.set(u,a.has(u)?a.get(u)+1:1);var c,p=0,f=t.length,v=(0,Ct.Z)(a.keys());try{for(v.s();!(c=v.n()).done;){var h=c.value;(p=a.get(h))<f&&(f=p,u=h)}}catch(m){v.e(m)}finally{v.f()}i[s]=u}return i}function me(t,e,r){var n=t.length;if(n<2)return t[0];for(var o=(0,N.Z)(t,1)[0].length,i=S.Z.createEmptyBand(r,o),a=new Set,s=0;s<o;s++)if(!e||e[s]){var u=void 0;a.clear();for(var l=0;l<n;l++)u=t[l][s],a.add(u);i[s]=a.size}return i}function de(t,e,r){return ve(t,null,r)}function ye(t,e,r){return he(t,null,r)}function ge(t,e,r){return me(t,null,r)}function we(t,e,r){return ae(t,null,r)}function xe(t,e,r){return se(t,null,r)}function Ze(t,e,r){return pe(t,null,r)}function be(t,e,r){return ce(t,null,r)}function _e(t,e,r){return le(t,null,r)}function Ae(t,e,r){return fe(t,null,r)}function Ce(t,e,r){return ue(t,null,r)}var ke=new Map,Ne=new Map,Fe=new Map;function Se(){ke.size||(ke.set(4,Math.sqrt),ke.set(6,Math.acos),ke.set(7,Math.asin),ke.set(8,Math.atan),ke.set(9,Math.atanh),ke.set(10,Math.abs),ke.set(21,Math.cos),ke.set(22,Math.cosh),ke.set(25,Math.exp),ke.set(30,Math.floor),ke.set(35,Math.log),ke.set(36,Math.log10),ke.set(37,Math.log2),ke.set(48,Math.floor),ke.set(49,Math.ceil),ke.set(51,Math.sin),ke.set(52,Math.sinh),ke.set(56,Math.tan),ke.set(57,Math.tanh),ke.set(59,Math.acosh),ke.set(60,Math.asinh),ke.set(65,Math.floor),Ne.set(5,Math.pow),Ne.set(61,Math.atan2),Fe.set(1,Nt),Fe.set(2,St),Fe.set(3,Tt),Fe.set(11,Dt),Fe.set(12,Mt),Fe.set(12,Mt),Fe.set(13,Et),Fe.set(14,Gt),Fe.set(15,Ot),Fe.set(16,Lt),Fe.set(17,Vt),Fe.set(18,zt),Fe.set(19,qt),Fe.set(20,Ht),Fe.set(23,jt),Fe.set(24,Wt),Fe.set(26,Ut),Fe.set(27,Jt),Fe.set(28,Yt),Fe.set(29,Kt),Fe.set(31,te),Fe.set(32,Ft),Fe.set(33,$t),Fe.set(34,Qt),Fe.set(44,ee),Fe.set(45,re),Fe.set(46,ne),Fe.set(64,Rt),Fe.set(65,It),Fe.set(76,ie),Fe.set(38,ve),Fe.set(39,ae),Fe.set(40,le),Fe.set(41,fe),Fe.set(42,se),Fe.set(43,he),Fe.set(47,ue),Fe.set(54,pe),Fe.set(55,ce),Fe.set(58,me),Fe.set(66,de),Fe.set(67,we),Fe.set(68,_e),Fe.set(69,Ae),Fe.set(70,xe),Fe.set(71,ye),Fe.set(72,Ce),Fe.set(73,Ze),Fe.set(74,be),Fe.set(75,ge))}var Te=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Local",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0],r=e.bandCount,n=this.functionArguments.processAsMultiband;if(n&&t.some((function(t){return t.bandCount!==r})))return{success:!1,error:"local-function: input rasters do not have same band count"};this.outputPixelType=this._getOutputPixelType("f32");var o=e.clone();return o.pixelType=this.outputPixelType,o.statistics=null,o.histograms=null,n||(o.bandCount=1),this.rasterInfo=o,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=t.pixelBlocks;return(0,c.Wi)(r)||r.some((function(t){return(0,c.Wi)(t)}))?null:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Se();for(var n,o=(0,c.Wg)(kt(t)),i=r.processAsMultiband,a=r.outputPixelType,s=void 0===a?"f32":a,u=i?t[0].pixels.length:1,l=[],p=function(r){var i=t.map((function(t){return t.pixels[r]})),a=void 0;if(e===_t.SetNull){var u=oe(i,o,s);a=u.band,n=u.mask}else Fe.has(e)?a=Fe.get(e)(i,o,s):ke.has(e)?a=Bt(i,o,s,ke.get(e)):Ne.has(e)&&(a=Pt(i,o,s,Ne.get(e)));if(null==a)return{v:null};l.push(a)},f=0;f<u;f++){var v=p(f);if("object"===typeof v)return v.v}n||e===_t.IsNull||(n=o);var h=t[0];return new S.Z({width:h.width,height:h.height,pixelType:s,mask:n,pixels:l})}(r,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:null!==(e=this.outputPixelType)&&void 0!==e?e:void 0})}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],Te.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:At,json:{write:!0,name:"rasterFunctionArguments"}})],Te.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],Te.prototype,"rasterArgumentNames",void 0);var je,Re=Te=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.LocalFunction")],Te),Ie=je=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).includedRanges=null,t.noDataValues=null,t.noDataInterpretation=D.DX.matchAny,t}return(0,a.Z)(r,[{key:"clone",value:function(){var t,e,r,n;return new je({includedRanges:null!==(t=null===(e=this.includedRanges)||void 0===e?void 0:e.slice())&&void 0!==t?t:[],noDataValues:null!==(r=null===(n=this.noDataValues)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],noDataInterpretation:this.noDataInterpretation})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{write:!0}})],Ie.prototype,"includedRanges",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],Ie.prototype,"noDataValues",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],Ie.prototype,"noDataInterpretation",void 0);var Be=Ie=je=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],Ie),Pe=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Mask",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,this.rasterInfo=t;var r=this.functionArguments,n=r.includedRanges,o=r.noDataValues;return null!==n&&void 0!==n&&n.length||null!==o&&void 0!==o&&o.length?(this.lookup=(0,D.nA)(e,this.functionArguments.includedRanges,this.functionArguments.noDataValues),{success:!0}):{success:!1,error:"missing includedRanges or noDataValues argument"}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return null;var n=this.outputPixelType,o=this.lookup,i=this.functionArguments,a=i.includedRanges,s=i.noDataValues,u=i.noDataInterpretation===D.DX.matchAll;return(0,D.sS)(r,{includedRanges:a,noDataValues:s,outputPixelType:n,matchAll:u,lookup:o})}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],Pe.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:Be,json:{write:!0,name:"rasterFunctionArguments"}})],Pe.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],Pe.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],Pe.prototype,"lookup",void 0);var De,Me=Pe=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.MaskFunction")],Pe),Ee=De=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).visibleBandID=0,t.infraredBandID=1,t.scaled=!0,t}return(0,a.Z)(r,[{key:"clone",value:function(){var t=this.visibleBandID,e=this.infraredBandID,r=this.scaled;return new De({visibleBandID:t,infraredBandID:e,scaled:r})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{write:!0}})],Ee.prototype,"visibleBandID",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],Ee.prototype,"infraredBandID",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],Ee.prototype,"scaled",void 0);var Ge=Ee=De=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Ee),Oe=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="NDVI",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments.scaled;this.outputPixelType=this._getOutputPixelType(t?"u8":"f32");var e=this.sourceRasterInfos[0].clone();e.pixelType=this.outputPixelType,e.colormap=null,e.histograms=null;var r=t?[0,200,100,10]:[-1,1,0,.1],n=(0,N.Z)(r,4),o=n[0],i=n[1],a=n[2],s=n[3];return e.statistics=[{min:o,max:i,avg:a,stddev:s}],this.rasterInfo=e,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return null;var n=this.functionArguments;return function(t,e,r,n){for(var o=t.mask,i=t.pixels,a=t.width,s=t.height,u=i[r],l=i[e],c=l.length,p=n?new Uint8Array(c):new Float32Array(c),f=n?100:1,v=n?100:0,h=0;h<c;h++)if(null==o||o[h]){var m=u[h],d=l[h],y=m+d;y&&(p[h]=(m-d)/y*f+v)}var g=new S.Z({width:a,height:s,mask:o,pixelType:n?"u8":"f32",pixels:[p]});return g.updateStatistics(),g}(r,n.visibleBandID,n.infraredBandID,n.scaled)}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],Oe.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:Ge,json:{write:!0,name:"rasterFunctionArguments"}})],Oe.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],Oe.prototype,"rasterArgumentNames",void 0);var Le,Ve=Oe=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.NDVIFunction")],Oe),ze=Le=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).inputRanges=null,t.outputValues=null,t.noDataRanges=null,t.allowUnmatched=!1,t}return(0,a.Z)(r,[{key:"clone",value:function(){return new Le({inputRanges:(0,Q.Z)(this.inputRanges),outputValues:(0,Q.Z)(this.outputValues),noDataRanges:(0,Q.Z)(this.noDataRanges),allowUnmatched:this.allowUnmatched})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{write:!0}})],ze.prototype,"inputRanges",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],ze.prototype,"outputValues",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],ze.prototype,"noDataRanges",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],ze.prototype,"allowUnmatched",void 0);var qe=ze=Le=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],ze),He=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Remap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null;var r=t.statistics,o=this.functionArguments,i=o.allowUnmatched,a=o.outputValues;if((0,c.pC)(r)&&r.length&&!i){for(var s=a[0],u=s,l=0;l<a.length;l++)s=s>a[l]?a[l]:s,u=u>a[l]?u:a[l];for(var p=0;p<r.length;p++)r[p]=(0,n.Z)((0,n.Z)({},r[p]),{},{min:s,max:u})}return this.rasterInfo=t,this.lookup=i?null:(0,D.oB)(e,this.functionArguments.inputRanges,a),{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return null;var n=this.lookup,o=this.outputPixelType;if(n)return(0,D.XV)(r,{lut:[n.lut],offset:n.offset,outputPixelType:o});var i=this.functionArguments,a=i.inputRanges,s=i.outputValues,u=i.noDataRanges,l=i.allowUnmatched;return(0,D.a2)(r,{inputRanges:a,outputValues:s,noDataRanges:u,allowUnmatched:l,outputPixelType:o})}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],He.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:qe,json:{write:!0,name:"rasterFunctionArguments"}})],He.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],He.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],He.prototype,"lookup",void 0);var We,Xe=He=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.RemapFunction")],He),Ue=new F.X({0:"degree",1:"percent-rise",2:"adjusted"},{useNumericKeys:!0}),Je=We=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).slopeType="degree",t.zFactor=1,t.pixelSizePower=.664,t.pixelSizeFactor=.024,t}return(0,a.Z)(r,[{key:"clone",value:function(){return new We({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,raster:this.raster})}}]),r}(d);(0,l._)([(0,k.J)(Ue)],Je.prototype,"slopeType",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{write:!0}})],Je.prototype,"zFactor",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{name:"psPower",write:!0}})],Je.prototype,"pixelSizePower",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{name:"psFactor",write:!0}})],Je.prototype,"pixelSizeFactor",void 0);var Ye=Je=We=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],Je),Ke=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Slope",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){this.outputPixelType=this._getOutputPixelType("f32");var t=this.sourceRasterInfos[0].clone();return t.pixelType=this.outputPixelType,t.statistics=null,t.histograms=null,this.rasterInfo=t,this.isGCS=t.spatialReference.isGeographic,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return null;var n=this.functionArguments,o=n.zFactor,i=n.slopeType,a=n.pixelSizePower,s=n.pixelSizeFactor,u=this.isGCS,l=t.extent,p=l?{x:l.width/r.width,y:l.height/r.height}:{x:1,y:1};return(0,b.yg)(r,{zFactor:o,slopeType:i,pixelSizePower:a,pixelSizeFactor:s,isGCS:u,resolution:p})}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],Ke.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:Ye,json:{write:!0,name:"rasterFunctionArguments"}})],Ke.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],Ke.prototype,"isGCS",void 0);var $e,Qe=Ke=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.SlopeFunction")],Ke),tr=$e=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).statistics=null,t.histograms=null,t}return(0,a.Z)(r,[{key:"clone",value:function(){return new $e({statistics:(0,C.d9)(this.statistics),histograms:(0,C.d9)(this.histograms)})}}]),r}(d);(0,l._)([(0,p.Cb)({json:{write:!0}})],tr.prototype,"statistics",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],tr.prototype,"histograms",void 0);var er=tr=$e=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunctionArguments")],tr),rr=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="StatisticsHistograms",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");var e=t.clone(),r=this.functionArguments,n=r.statistics,o=r.histograms;return e.histograms=o,n&&(e.statistics=n.map((function(t){var e=(0,N.Z)(t,4);return{min:e[0],max:e[1],avg:e[2],stddev:e[3]}}))),this.rasterInfo=e,{success:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],rr.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:er,json:{write:!0,name:"rasterFunctionArguments"}})],rr.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],rr.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],rr.prototype,"indexedColormap",void 0);var nr,or=rr=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunction")],rr),ir=new F.X({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",7:"sigmoid"},{useNumericKeys:!0}),ar=nr=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).computeGamma=!1,t.dynamicRangeAdjustment=!1,t.gamma=[],t.histograms=null,t.statistics=null,t.stretchType="none",t.useGamma=!1,t}return(0,a.Z)(r,[{key:"writeStatistics",value:function(t,e,r){var n;(null===(n=t)||void 0===n?void 0:n.length)&&(Array.isArray(t[0])||(t=t.map((function(t){return[t.min,t.max,t.avg,t.stddev]}))),e[r]=t)}},{key:"clone",value:function(){return new nr({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:(0,C.d9)(this.statistics),gamma:(0,C.d9)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:(0,C.d9)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}}]),r}(d);(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],ar.prototype,"computeGamma",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{name:"dra",write:!0}})],ar.prototype,"dynamicRangeAdjustment",void 0),(0,l._)([(0,p.Cb)({type:[Number],json:{write:!0}})],ar.prototype,"gamma",void 0),(0,l._)([(0,p.Cb)()],ar.prototype,"histograms",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{write:!0}})],ar.prototype,"maxPercent",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{write:!0}})],ar.prototype,"minPercent",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{write:!0}})],ar.prototype,"numberOfStandardDeviations",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{name:"max",write:!0}})],ar.prototype,"outputMax",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{name:"min",write:!0}})],ar.prototype,"outputMin",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{write:!0}})],ar.prototype,"sigmoidStrengthLevel",void 0),(0,l._)([(0,p.Cb)({json:{type:[[Number]],write:!0}})],ar.prototype,"statistics",void 0),(0,l._)([(0,tt.c)("statistics")],ar.prototype,"writeStatistics",null),(0,l._)([(0,k.J)(ir)],ar.prototype,"stretchType",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],ar.prototype,"useGamma",void 0);var sr=ar=nr=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],ar),ur=r(21449),lr=function(t){(0,s.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).functionName="Stretch",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t.cutOffs=null,t}return(0,a.Z)(r,[{key:"_bindSourceRasters",value:function(){this.lookup=null,this.cutOffs=null;var t=this.sourceRasterInfos[0],e=t.pixelType,r=this.functionArguments,o=r.dynamicRangeAdjustment,i=r.gamma,a=r.useGamma;if(!o&&["u8","u16","s8","s16"].includes(e)){var s=(0,ur.AV)(r.toJSON(),{rasterInfo:t});this.lookup=(0,ur.hE)((0,n.Z)((0,n.Z)({pixelType:e},s),{},{gamma:a?i:null}))}else o&&(this.cutOffs=(0,ur.AV)(r.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(e);var u=t.clone();return u.pixelType=this.outputPixelType,u.statistics=null,u.histograms=null,"u8"===this.outputPixelType&&(u.keyProperties.DataType="processed"),this.rasterInfo=u,{success:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,c.Wi)(r))return r;var o=this.lookup;if(o)return(0,D.XV)(r,(0,n.Z)((0,n.Z)({},o),{},{outputPixelType:this.rasterInfo.pixelType}));var i=this.functionArguments,a=this.cutOffs||(0,ur.AV)(i.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:r}),s=i.useGamma?i.gamma:null;return(0,ur.dy)(r,(0,n.Z)((0,n.Z)({},a),{},{gamma:s,outputPixelType:this.outputPixelType}))}}]),r}(Z);(0,l._)([(0,p.Cb)({json:{write:!0,name:"rasterFunction"}})],lr.prototype,"functionName",void 0),(0,l._)([(0,p.Cb)({type:sr,json:{write:!0,name:"rasterFunctionArguments"}})],lr.prototype,"functionArguments",void 0),(0,l._)([(0,p.Cb)()],lr.prototype,"rasterArgumentNames",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],lr.prototype,"lookup",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],lr.prototype,"cutOffs",void 0);var cr=lr=(0,l._)([(0,f.j)("esri.layers.support.rasterFunctions.StretchFunction")],lr),pr=new Map;function fr(t,e){if("rasterFunction"in t)return vr(t,null!==e&&void 0!==e?e:{});throw new o.Z("raster-function-helper","unsupported raster function json.")}function vr(t,e){var r,i=t.rasterFunction,a=t.rasterFunctionArguments,s=null===(r=t.outputPixelType)||void 0===r?void 0:r.toLowerCase();if(null==i||!pr.has(i))throw new o.Z("raster-function-helper","unsupported raster function: ".concat(i));for(var u=pr.get(i),l=("function"==typeof u.ctor?u.ctor:u.ctor.default).fromJSON((0,n.Z)((0,n.Z)({},t),{},{outputPixelType:s})),c=l.rasterArgumentNames,p=[],f=function(t,e){return"rasters"===e[0]&&Array.isArray(t.rasters)?t.rasters:e.map((function(e){return t[e]}))}(a,c),v="rasters"===c[0],h=[],m=0;m<f.length;m++){var d,y=f[m],g=void 0;null==y||"string"==typeof y&&y.startsWith("$")?p.push(null===e||void 0===e?void 0:e.raster):"string"==typeof y?e[y]&&p.push(e[y]):"number"!=typeof y&&"rasterFunction"in y&&(g=vr(y,e),v||(l.functionArguments[c[m]]=g),p.push(g)),v&&h.push(null!==(d=g)&&void 0!==d?d:y)}if(v&&(l.functionArguments.rasters=h),e){var w;l.sourceRasters=p;var x=null===(w=e.raster)||void 0===w?void 0:w.url;x&&(l.mainPrimaryRasterId=x)}return l}pr.set("Aspect",{desc:"Aspect Function",ctor:A,rasterArgumentNames:["raster"]}),pr.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:q,rasterArgumentNames:["raster"]}),pr.set("Colormap",{desc:"Colormap Function",ctor:$,rasterArgumentNames:["raster"]}),pr.set("CompositeBand",{desc:"CompositeBand Function",ctor:it,rasterArgumentNames:["rasters"]}),pr.set("Convolution",{desc:"Convolution Function",ctor:dt,rasterArgumentNames:["raster"]}),pr.set("ExtractBand",{desc:"ExtractBand Function",ctor:Zt,rasterArgumentNames:["raster"]}),pr.set("Local",{desc:"Local Function",ctor:Re,rasterArgumentNames:["rasters"]}),pr.set("Mask",{desc:"Mask Function",ctor:Me,rasterArgumentNames:["raster"]}),pr.set("NDVI",{desc:"NDVI Function",ctor:Ve,rasterArgumentNames:["raster"]}),pr.set("Remap",{desc:"Remap Function",ctor:Xe,rasterArgumentNames:["raster"]}),pr.set("Slope",{desc:"Slope Function",ctor:Qe,rasterArgumentNames:["raster"]}),pr.set("StatisticsHistograms",{desc:"Statistics Histograms Function",ctor:or,rasterArgumentNames:["raster"]}),pr.set("Stretch",{desc:"Stretch Function",ctor:cr,rasterArgumentNames:["raster"]})},32935:function(t,e,r){r.d(e,{Z:function(){return f}});var n=r(15671),o=r(43144),i=r(60136),a=r(29388),s=r(27366),u=r(46784),l=r(49861),c=(r(63780),r(25243),r(69912)),p=function(t){(0,i.Z)(r,t);var e=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),e.apply(this,arguments)}return(0,o.Z)(r,[{key:"affectsPixelSize",get:function(){return!1}},{key:"forwardTransform",value:function(t){return t}},{key:"inverseTransform",value:function(t){return t}}]),r}(u.wq);(0,s._)([(0,l.Cb)()],p.prototype,"affectsPixelSize",null),(0,s._)([(0,l.Cb)({json:{write:!0}})],p.prototype,"spatialReference",void 0);var f=p=(0,s._)([(0,c.j)("esri.layers.support.rasterTransforms.BaseRasterTransform")],p)},3089:function(t,e,r){r.d(e,{Z:function(){return f}});var n=r(15671),o=r(43144),i=r(60136),a=r(29388),s=r(27366),u=r(49861),l=(r(63780),r(25243),r(27135)),c=r(69912),p=function(t){(0,i.Z)(r,t);var e=(0,a.Z)(r);function r(){var t;return(0,n.Z)(this,r),(t=e.apply(this,arguments)).type="gcs-shift",t.tolerance=1e-8,t}return(0,o.Z)(r,[{key:"forwardTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}},{key:"inverseTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}}]),r}(r(32935).Z);(0,s._)([(0,l.J)({GCSShiftXform:"gcs-shift"})],p.prototype,"type",void 0),(0,s._)([(0,u.Cb)()],p.prototype,"tolerance",void 0);var f=p=(0,s._)([(0,c.j)("esri.layers.support.rasterTransforms.GCSShiftTransform")],p)},69405:function(t,e,r){r.d(e,{Z:function(){return x}});var n=r(15671),o=r(43144),i=r(60136),a=r(29388),s=r(29439),u=r(27366),l=(r(59486),r(49861)),c=(r(63780),r(25243),r(27135)),p=r(38511),f=r(69912),v=r(31201),h=r(32935),m=r(585),d=r(53866);function y(t,e,r){var n=e.x,o=e.y;if(r<2)return{x:t[0]+n*t[2]+o*t[4],y:t[1]+n*t[3]+o*t[5]};if(2===r){var i=n*n,a=o*o,s=n*o;return{x:t[0]+n*t[2]+o*t[4]+i*t[6]+s*t[8]+a*t[10],y:t[1]+n*t[3]+o*t[5]+i*t[7]+s*t[9]+a*t[11]}}var u=n*n,l=o*o,c=n*o,p=u*n,f=u*o,v=n*l,h=o*l;return{x:t[0]+n*t[2]+o*t[4]+u*t[6]+c*t[8]+l*t[10]+p*t[12]+f*t[14]+v*t[16]+h*t[18],y:t[1]+n*t[3]+o*t[5]+u*t[7]+c*t[9]+l*t[11]+p*t[13]+f*t[15]+v*t[17]+h*t[19]}}function g(t,e,r){var n=e.xmin,o=e.ymin,i=e.xmax,a=e.ymax,s=e.spatialReference,u=[];if(r<2)u.push({x:n,y:a}),u.push({x:i,y:a}),u.push({x:n,y:o}),u.push({x:i,y:o});else{for(var l=10,c=0;c<l;c++)u.push({x:n,y:o+(a-o)*c/(l-1)}),u.push({x:i,y:o+(a-o)*c/(l-1)});l=8;for(var p=1;p<=l;p++)u.push({x:n+(i-n)*p/l,y:o}),u.push({x:n+(i-n)*p/l,y:a})}u=u.map((function(e){return y(t,e,r)}));var f=u.map((function(t){return t.x})),v=u.map((function(t){return t.y}));return new d.Z({xmin:Math.min.apply(null,f),xmax:Math.max.apply(null,f),ymin:Math.min.apply(null,v),ymax:Math.max.apply(null,v),spatialReference:s})}var w=function(t){(0,i.Z)(r,t);var e=(0,a.Z)(r);function r(){var t;return(0,n.Z)(this,r),(t=e.apply(this,arguments)).polynomialOrder=1,t.type="polynomial",t}return(0,o.Z)(r,[{key:"readForwardCoefficients",value:function(t,e){var r=e.coeffX,n=e.coeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var o=[],i=0;i<r.length;i++)o.push(r[i]),o.push(n[i]);return o}},{key:"writeForwardCoefficients",value:function(t,e,r){for(var n=[],o=[],i=0;i<(null===t||void 0===t?void 0:t.length);i++)i%2==0?n.push(t[i]):o.push(t[i]);e.coeffX=n,e.coeffY=o}},{key:"inverseCoefficients",get:function(){var t=this._get("inverseCoefficients"),e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=function(t){var e=(0,s.Z)(t,6),r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],u=e[5],l=o*u-a*i,c=a*i-o*u;return[(a*n-r*u)/l,(o*n-r*i)/c,u/l,i/c,-a/l,-o/c]}(e)),t},set:function(t){this._set("inverseCoefficients",t)}},{key:"readInverseCoefficients",value:function(t,e){var r=e.inverseCoeffX,n=e.inverseCoeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var o=[],i=0;i<r.length;i++)o.push(r[i]),o.push(n[i]);return o}},{key:"writeInverseCoefficients",value:function(t,e,r){for(var n=[],o=[],i=0;i<(null===t||void 0===t?void 0:t.length);i++)i%2==0?n.push(t[i]):o.push(t[i]);e.inverseCoeffX=n,e.inverseCoeffY=o}},{key:"affectsPixelSize",get:function(){return this.polynomialOrder>0}},{key:"forwardTransform",value:function(t){if("point"===t.type){var e=y(this.forwardCoefficients,t,this.polynomialOrder);return new m.Z({x:e.x,y:e.y,spatialReference:t.spatialReference})}return g(this.forwardCoefficients,t,this.polynomialOrder)}},{key:"inverseTransform",value:function(t){if("point"===t.type){var e=y(this.inverseCoefficients,t,this.polynomialOrder);return new m.Z({x:e.x,y:e.y,spatialReference:t.spatialReference})}return g(this.inverseCoefficients,t,this.polynomialOrder)}}]),r}(h.Z);(0,u._)([(0,l.Cb)({json:{write:!0}})],w.prototype,"polynomialOrder",void 0),(0,u._)([(0,l.Cb)()],w.prototype,"forwardCoefficients",void 0),(0,u._)([(0,p.r)("forwardCoefficients",["coeffX","coeffY"])],w.prototype,"readForwardCoefficients",null),(0,u._)([(0,v.c)("forwardCoefficients")],w.prototype,"writeForwardCoefficients",null),(0,u._)([(0,l.Cb)({json:{write:!0}})],w.prototype,"inverseCoefficients",null),(0,u._)([(0,p.r)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],w.prototype,"readInverseCoefficients",null),(0,u._)([(0,v.c)("inverseCoefficients")],w.prototype,"writeInverseCoefficients",null),(0,u._)([(0,l.Cb)()],w.prototype,"affectsPixelSize",null),(0,u._)([(0,c.J)({PolynomialXform:"polynomial"})],w.prototype,"type",void 0);var x=w=(0,u._)([(0,f.j)("esri.layers.support.rasterTransforms.PolynomialTransform")],w)},64971:function(t,e,r){r.d(e,{j:function(){return d},c:function(){return y}});var n=r(3089),o=r(43144),i=r(15671),a=r(60136),s=r(29388),u=r(27366),l=(r(32718),r(25243),r(63780),r(10064),r(93169),r(27135)),c=r(69912),p=function(t){(0,a.Z)(r,t);var e=(0,s.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).type="identity",t}return(0,o.Z)(r)}(r(32935).Z);(0,u._)([(0,l.J)({IdentityXform:"identity"})],p.prototype,"type",void 0);var f=p=(0,u._)([(0,c.j)("esri.layers.support.rasterTransforms.IdentityTransform")],p),v=r(69405),h={GCSShiftXform:n.Z,IdentityXform:f,PolynomialXform:v.Z},m=Object.keys(h);function d(t){var e=null===t||void 0===t?void 0:t.type;return!t||m.includes(e)}function y(t){if(!(null===t||void 0===t?void 0:t.type))return null;var e=h[null===t||void 0===t?void 0:t.type];if(e){var r=new e;return r.read(t),r}return null}}}]);
//# sourceMappingURL=6626.76abb205.chunk.js.map