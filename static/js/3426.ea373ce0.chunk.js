(self.webpackChunkData_Design_AI_for_Urban_Data_and_Viz_Harvard_GSD=self.webpackChunkData_Design_AI_for_Urban_Data_and_Viz_Harvard_GSD||[]).push([[3426],{10786:function(e,t,n){"use strict";n.r(t),n.d(t,{AppSmartDrawing:function(){return f}});var r=n(29439),i=n(37762),o=n(15671),a=n(43144),s=n(74165),c=n(15861),d=n(33178),u=function(){function e(){var t=this;(0,o.Z)(this,e),this.modelLogisticRegression=void 0,this.modelMultiClassification=void 0,this.isLoaded=!1,l().then((function(e){var n=(0,r.Z)(e,2);t.modelLogisticRegression=n[0],t.modelMultiClassification=n[1],t.isLoaded=!0,console.log(t)})),console.log("executing Smart Drawing example")}return(0,a.Z)(e,[{key:"predictByLogisticRegression",value:function(e){var t=this;if(void 0!==this.modelLogisticRegression)return console.log("=============================="),(0,d.lub)((function(){var n=(0,d.odF)([e]),r=t.modelLogisticRegression.predict(n).dataSync();return t.PredictionPostProcessingLogisticRegression(r[0])}));console.error("no model loaded")}},{key:"PredictionPostProcessingLogisticRegression",value:function(t){var n=Math.floor(t+.5);return e.CLASS_TYPE[n]}},{key:"predictByMultiClassification",value:function(t){var n=this;if(void 0!==this.modelMultiClassification)return(0,d.lub)((function(){var r,o=d.odF([t]),a=n.modelMultiClassification.predict(o),s=[],c=Array.from(a.dataSync()),u=v(c),l=(0,i.Z)(u);try{for(l.s();!(r=l.n()).done;){var h=r.value,f=c[h],g="class:"+e.CLASS_TYPE[h]+", probability:"+f.toFixed(5);console.log(g),s.push(g)}}catch(p){l.e(p)}finally{l.f()}var m=a.argMax(-1).dataSync()[0];return[e.CLASS_TYPE[m],s]}));console.error("no model loaded")}}]),e}();u.CLASS_TYPE={0:"CIRCLE",1:"TRI-GON",2:"ARROW_SINGLE",3:"ARROW_DOUBLE",4:"RECTANGLE",5:"TEXT",6:"CURVE",7:"HEART",8:"CLOUD"};var l=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelLogisticRegression0/model.json",e.next=3,(0,d.FBF)(t);case 3:return n=e.sent,t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelMultiClassification0/model.json",e.next=7,(0,d.FBF)(t);case 7:return r=e.sent,e.abrupt("return",[n,r]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=n;return t.sort((function(t,n){return e[t]>e[n]?-1:e[t]<e[n]?1:0})),t},h=n(87968),f=function(){function e(t){var n=this;(0,o.Z)(this,e),this.rendererCanvas=void 0,this.smartDrawing=void 0,this.vec=[],this.divHost=void 0,this.divText=void 0,this.render=function(e){for(var t=0;t<n.vec.length;++t)e.fillStyle="rgba(255, 0, 0, 0.15)",e.beginPath(),e.arc(n.vec[t][0],n.vec[t][1],5,0,2*Math.PI),e.closePath(),e.fill()},this.mouseDrag=function(e,t){n.vec.push([e,t])},this.mouseUp=function(e,t){n.Predict(n.vec),n.vec=[]},this.divHost=document.getElementById(t);var r=document.createElement("div");this.divHost.appendChild(r),r.id="container-video",r.style.alignItems="center",r.style.marginTop="80px",r.style.marginLeft="auto",r.style.marginRight="auto",r.style.width="300px",r.style.height="400px",this.smartDrawing=new u,this.rendererCanvas=new h.RendererCanvas(r),this.rendererCanvas.canvas.style.position="unset",this.rendererCanvas.canvas.width=300,this.rendererCanvas.canvas.height=300,this.rendererCanvas.canvas.style.background="#999",this.divText=document.createElement("div"),this.divText.textContent="*** FROM DEEP LEARNING MODEL B ***",r.append(this.divText),this.rendererCanvas.start(),this.rendererCanvas.render=function(e){return n.render(e)},this.rendererCanvas.mouseDrag=function(e,t){return n.mouseDrag(e,t)},this.rendererCanvas.mouseUp=function(e,t){return n.mouseUp(e,t)}}return(0,a.Z)(e,[{key:"Predict",value:function(e){var t,n=[],o=(0,i.Z)(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;n.push(new h.Vector3(a[0],a[1],0))}}catch(m){o.e(m)}finally{o.f()}var s=g(n),c=(0,h.getInterpolatedArray)(s,501);console.log(c),console.log("*** FROM DEEP LEARNING MODELS ***");var d=this.smartDrawing.predictByLogisticRegression(c);console.debug("pridiction:%c ".concat(d," from LR Model"),"background: #ddb137; color: black");var u=this.smartDrawing.predictByMultiClassification(c),l=(0,r.Z)(u,2),v=l[0],f=l[1];return console.debug("pridiction:%c ".concat(v," from MC model"),"background: #4e2c7e; color: white"),this.updateDivWithText(f),v}},{key:"updateDivWithText",value:function(e){for(var t="<p>*** FROM DEEP LEARNING MODEL B *** </p>",n=0;n<e.length;++n)t+="<p> ".concat(e[n],"</p>");this.divText.innerHTML=t}},{key:"destroy",value:function(){try{for(;void 0!==this.divHost&&void 0!==this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}catch(e){}}}]),e}(),g=function(e){for(var t=[],n=0;n<e.length;++n)if(n<e.length-1){var r=new h.Vector3(e[n].x,e[n].y,e[n].z),i=new h.Vector3(e[n+1].x,e[n+1].y,e[n+1].z);i.x-=r.x,i.y-=r.y,i.z-=r.z;var o=(0,h.dotProduct)(new h.Vector3(1,0,0),(0,h.normalize)(i));Number.isNaN(o)?t.push(t[t.length-1]):t.push(o)}else{var a=new h.Vector3(e[n].x,e[n].y,e[n].z),s=new h.Vector3(e[0].x,e[0].y,e[0].z);s.x-=a.x,s.y-=a.y,s.z-=a.z;var c=(0,h.dotProduct)(new h.Vector3(1,0,0),(0,h.normalize)(s));Number.isNaN(c)?t.push(t[t.length-1]):t.push(c)}return t}},75410:function(){},48628:function(){},31601:function(){},67792:function(){},34977:function(){},75042:function(){}}]);
//# sourceMappingURL=3426.ea373ce0.chunk.js.map