"use strict";(self.webpackChunkData_Design_AI_for_Urban_Data_and_Viz_Harvard_GSD=self.webpackChunkData_Design_AI_for_Urban_Data_and_Viz_Harvard_GSD||[]).push([[8991],{75746:function(t,e,i){i.d(e,{E:function(){return n}});var r=new(i(8961).Z);function n(t){return r.hasBidiChar(t)?(e="rtl"===r.checkContextual(t)?"IDNNN":"ICNNN",[r.bidiTransform(t,e,"VLYSN"),!0]):[t,!1];var e}},46228:function(t,e,i){i.d(e,{I:function(){return n},v:function(){return a}});var r=i(16889);function n(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=(0,r.uZ)(t,0,l),a=0;a<4;a++)e[i+a]=Math.floor(256*h(n*s[a]))}function a(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0,r=0;r<4;r++)i+=t[e+r]*o[r];return i}var s=[1,256,65536,16777216],o=[1/256,1/65536,1/16777216,1/4294967296],l=a(new Uint8ClampedArray([255,255,255,255]));function h(t){return t-Math.floor(t)}},82272:function(t,e,i){i.d(e,{BN:function(){return u},Yc:function(){return c},mx:function(){return l}});var r=i(74165),n=i(15861),a=i(42265),s="woff2",o=new Map;function l(t){return h.apply(this,arguments)}function h(){return h=(0,n.Z)((0,r.Z)().mark((function t(e){var i,n,l,h;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=c(e),!(n=o.get(i))){t.next=4;break}return t.abrupt("return",n);case 4:return l=new FontFace(e.family,"url('".concat(a.Z.fontsUrl,"/woff2/").concat(i,".").concat(s,"') format('").concat(s,"')")),h=document.fonts,t.abrupt("return",h.has(l)&&"loading"===l.status?l.loaded:(n=l.load(),o.set(i,n),h.add(l),n));case 6:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function u(t){if(!t)return"arial-unicode-ms";var e=t.toLowerCase().split(" ").join("-");switch(e){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return e}}function c(t){var e=function(t){if(!t.weight)return"";switch(t.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(t)+function(t){if(!t.style)return"";switch(t.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}(t);return u(t.family)+(e.length>0?e:"-regular")}},25290:function(t,e,i){i.d(e,{GP:function(){return h},QK:function(){return P},XV:function(){return k},hh:function(){return g},ov:function(){return y},qh:function(){return M},v1:function(){return b},wp:function(){return _},zY:function(){return S},zv:function(){return x}});var r=i(15671),n=i(43144),a=i(37762),s=i(84652),o=i(77981),l=i(84284);function h(t){var e=(0,s.d9)(t);return function(t){t&&((0,o.oU)(t)?d(t.rings):(0,o.l9)(t)?d(t.paths):(0,o.aW)(t)&&p(t.points),u(t))}(e),e}function u(t){t&&((0,o.wp)(t)?t.y=-t.y:(0,o.oU)(t)?f(t.rings):(0,o.l9)(t)?f(t.paths):(0,o.aW)(t)&&c(t.points))}function c(t){if(t)for(var e=t.length,i=0;i<e;i++)t[i][1]=-t[i][1]}function f(t){if(t){var e,i=(0,a.Z)(t);try{for(i.s();!(e=i.n()).done;){c(e.value)}}catch(r){i.e(r)}finally{i.f()}}}function v(t){if(t)for(var e=t.length-1;e>0;--e)t[e][0]-=t[e-1][0],t[e][1]-=t[e-1][1]}function m(t){if(t){var e,i=(0,a.Z)(t);try{for(i.s();!(e=i.n()).done;){v(e.value)}}catch(r){i.e(r)}finally{i.f()}}}function p(t){if(t)for(var e=t.length,i=1;i<e;++i)t[i][0]+=t[i-1][0],t[i][1]+=t[i-1][1]}function d(t){if(t){var e,i=(0,a.Z)(t);try{for(i.s();!(e=i.n()).done;){p(e.value)}}catch(r){i.e(r)}finally{i.f()}}}function _(t){t&&(u(t),(0,o.oU)(t)?m(t.rings):(0,o.l9)(t)?m(t.paths):(0,o.aW)(t)&&v(t.points))}function y(t){if(t){var e,i=(0,a.Z)(t);try{for(i.s();!(e=i.n()).done;){g(e.value)}}catch(r){i.e(r)}finally{i.f()}}}function g(t){t&&t.reverse()}function k(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i]}function P(t){return!(!t||0===t.length)&&t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]}function x(t){return t[4]}function M(t,e){t[4]=e}var b=function(){function t(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.Z)(this,t),this.isClosed=!1,this.multiPath=null,this.acceptPolygon=i,this.acceptPolyline=n,this.geomUnitsPerPoint=a,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1,e&&((0,o.oU)(e)?i&&(this.multiPath=e.rings,this.isClosed=!0):(0,o.l9)(e)?n&&(this.multiPath=e.paths,this.isClosed=!1):(0,o.YX)(e)&&i&&(this.multiPath=C(e).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length)),this.internalPlacement=new l.u}return(0,n.Z)(t,[{key:"next",value:function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var t=this.processPath(this.multiPath[this.pathIndex]);if(t)return t}return this.pathCount=-1,this.pathIndex=-1,this.multiPath=null,null}}]),t}(),S=function(){function t(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.Z)(this,t),this.isClosed=!1,this.multiPath=null,this.inputGeometries=e,this.acceptPolygon=i,this.acceptPolyline=n,this.geomUnitsPerPoint=a,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1}return(0,n.Z)(t,[{key:"next",value:function(){for(;;){if(!this.multiPath){for(var t=this.inputGeometries.next();t;){if((0,o.oU)(t)?this.acceptPolygon&&(this.multiPath=t.rings,this.isClosed=!0):(0,o.l9)(t)?this.acceptPolyline&&(this.multiPath=t.paths,this.isClosed=!1):(0,o.YX)(t)&&this.acceptPolygon&&(this.multiPath=C(t).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length,this.pathIndex=-1;break}t=this.inputGeometries.next()}if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var e=this.processPath(this.multiPath[this.pathIndex]);if(e)return e}this.pathCount=-1,this.pathIndex=-1,this.multiPath=null}}}]),t}();function C(t){return{rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}}},35747:function(t,e,i){i.d(e,{M:function(){return a}});var r=i(15671),n=i(43144),a=(i(84652),function(){function t(e){(0,r.Z)(this,t),this._geometry=e}return(0,n.Z)(t,[{key:"next",value:function(){var t=this._geometry;return this._geometry=null,t}}]),t}())},81434:function(t,e,i){i.d(e,{h:function(){return zt},W:function(){return Et}});var r=i(37762),n=i(15671),a=i(43144),s=i(84652),o=i(77981),l=i(25290),h=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new u(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();h.instance=null;var u=function(){function t(e,i,r){(0,n.Z)(this,t),this._inputGeometries=e,this._angleTolerance=void 0!==i.angleTolerance?i.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if((0,o.oU)(t)){this._isClosed=!0;var e=(0,s.d9)(t);return this._processMultipath(e.rings),e}if((0,o.l9)(t)){this._isClosed=!1;var i=(0,s.d9)(t);return this._processMultipath(i.paths),i}if((0,o.YX)(t)){if(this._maxCosAngle)return t;this._isClosed=!0;var r=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];return this._processPath(r),{rings:[r]}}t=this._inputGeometries.next()}return null}},{key:"_processMultipath",value:function(t){if(t){var e,i=(0,r.Z)(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;this._processPath(n)}}catch(a){i.e(a)}finally{i.f()}}}},{key:"_processPath",value:function(t){if(t){var e,i,r,n,a,s,o=t.length,h=t[0];this._isClosed&&++o;for(var u=1;u<o;++u){var c,f=(c=this._isClosed&&u===o-1?t[0]:t[u])[0]-h[0],v=c[1]-h[1],m=Math.sqrt(f*f+v*v);u>1&&m>0&&r>0&&(e*f+i*v)/m/r<=this._maxCosAngle&&(0,l.qh)(h,1),1===u&&(n=f,a=v,s=m),m>0&&(h=c,e=f,i=v,r=m)}this._isClosed&&r>0&&s>0&&(e*n+i*a)/s/r<=this._maxCosAngle&&(0,l.qh)(t[0],1)}}}]),t}(),c=i(60136),f=i(29388),v=i(48202),m=.03,p=function(){function t(){(0,n.Z)(this,t),this._path=[]}return(0,a.Z)(t,[{key:"path",value:function(){return this._path}},{key:"addPath",value:function(t,e){e||t.reverse(),Array.prototype.push.apply(this._path,t),e||t.reverse()}},{key:"startPath",value:function(t){this._path.push(t)}},{key:"lineTo",value:function(t){this._path.push(t)}},{key:"close",value:function(){var t=this._path;t.length>1&&(t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]||t.push([t[0][0],t[0][1]]))}}],[{key:"mergePath",value:function(t,e){e&&Array.prototype.push.apply(t,e)}}]),t}(),d=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"normalize",value:function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);0!==e&&(t[0]/=e,t[1]/=e)}},{key:"calculateLength",value:function(t,e){var i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)}},{key:"calculateSegLength",value:function(t,e){return this.calculateLength(t[e],t[e+1])}},{key:"calculatePathLength",value:function(t){for(var e=0,i=t?t.length:0,r=0;r<i-1;++r)e+=this.calculateSegLength(t,r);return e}},{key:"calculatePathArea",value:function(t){for(var e=0,i=t?t.length:0,r=0;r<i-1;++r)e+=(t[r+1][0]-t[r][0])*(t[r+1][1]+t[r][1]);return e/2}},{key:"getCoord2D",value:function(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i]}},{key:"getSegCoord2D",value:function(t,e,i){return this.getCoord2D(t[e],t[e+1],i)}},{key:"getAngle",value:function(t,e,i){var r=e[0]-t[0],n=e[1]-t[1];return Math.atan2(n,r)}},{key:"getSegAngle",value:function(t,e,i){return this.getAngle(t[e],t[e+1],i)}},{key:"getAngleCS",value:function(t,e,i){var r=e[0]-t[0],n=e[1]-t[1],a=Math.sqrt(r*r+n*n);return a>0?[r/a,n/a]:[1,0]}},{key:"getSegAngleCS",value:function(t,e,i){return this.getAngleCS(t[e],t[e+1],i)}},{key:"cut",value:function(t,e,i,r){return[i<=0?t[e]:this.getSegCoord2D(t,e,i),r>=1?t[e+1]:this.getSegCoord2D(t,e,r)]}},{key:"addSegment",value:function(t,e,i){i&&t.push(e[0]),t.push(e[1])}},{key:"getSubCurve",value:function(t,e,i){var r=[];return this.appendSubCurve(r,t,e,i)?r:null}},{key:"appendSubCurve",value:function(t,e,i,r){for(var n=e?e.length-1:0,a=0,s=!0,o=0;o<n;){var l=this.calculateSegLength(e,o);if(0!==l){if(s){if(a+l>i){var h=(i-a)/l,u=1,c=!1;a+l>=r&&(u=(r-a)/l,c=!0);var f=this.cut(e,o,h,u);if(f&&this.addSegment(t,f,s),c)break;s=!1}}else{if(a+l>r){var v=this.cut(e,o,0,(r-a)/l);v&&this.addSegment(t,v,s);break}this.addSegment(t,[e[o],e[o+1]],s)}a+=l,++o}else++o}return!0}},{key:"getCIMPointAlong",value:function(t,e){for(var i=t?t.length-1:0,r=0,n=-1;n<i;){++n;var a=this.calculateSegLength(t,n);if(0!==a){if(r+a>e){var s=(e-r)/a;return this.getCoord2D(t[n],t[n+1],s)}r+=a}}return null}},{key:"isEmpty",value:function(t,e){if(!t||t.length<=1)return!0;for(var i=t?t.length-1:0,r=-1;r<i;){if(t[++r+1][0]!==t[r][0]||t[r+1][1]!==t[r][1])return!1;if(e&&t[r+1][2]!==t[r][2])return!1}return!0}},{key:"offset",value:function(t,e,i,r,n){if(!t||t.length<2)return null;for(var a=0,s=t[a++],o=a;a<t.length;){var l=t[a];l[0]===s[0]&&l[1]===s[1]||(a!==o&&(t[o]=t[a]),s=t[o++]),a++}var h=t[0][0]===t[o-1][0]&&t[0][1]===t[o-1][1];if(h&&--o,o<(h?3:2))return null;var u=[];s=h?t[o-1]:null;for(var c=t[0],f=0;f<o;f++){var m=f===o-1?h?t[0]:null:t[f+1];if(s)if(m){var p=[m[0]-c[0],m[1]-c[1]];this.normalize(p);var d=[c[0]-s[0],c[1]-s[1]];this.normalize(d);var _=d[0]*p[1]-d[1]*p[0],y=d[0]*p[0]+d[1]*p[1];if(0===_&&1===y){c=m;continue}if(_>=0==e<=0){if(y<1){var g=[p[0]-d[0],p[1]-d[1]];this.normalize(g);var k=Math.sqrt((1+y)/2);if(k>1/r){var P=-Math.abs(e)/k;u.push([c[0]-g[0]*P,c[1]-g[1]*P])}}}else switch(i){case v.id.Mitered:var x=Math.sqrt((1+y)/2);if(x>0&&1/x<r){var M=[p[0]-d[0],p[1]-d[1]];this.normalize(M);var b=Math.abs(e)/x;u.push([c[0]-M[0]*b,c[1]-M[1]*b]);break}case v.id.Bevelled:u.push([c[0]+d[1]*e,c[1]-d[0]*e]),u.push([c[0]+p[1]*e,c[1]-p[0]*e]);break;case v.id.Rounded:if(y<1){u.push([c[0]+d[1]*e,c[1]-d[0]*e]);var S=Math.floor(2.5*(1-y));if(S>0)for(var C=1/S,w=C,I=1;I<S;I++,w+=C){var Z=[d[1]*(1-w)+p[1]*w,-d[0]*(1-w)-p[0]*w];this.normalize(Z),u.push([c[0]+Z[0]*e,c[1]+Z[1]*e])}u.push([c[0]+p[1]*e,c[1]-p[0]*e])}break;case v.id.Square:default:if(_<0)u.push([c[0]+(d[1]+d[0])*e,c[1]+(d[1]-d[0])*e]),u.push([c[0]+(p[1]-p[0])*e,c[1]-(p[0]+p[1])*e]);else{var N=Math.sqrt((1+Math.abs(y))/2),L=[p[0]-d[0],p[1]-d[1]];this.normalize(L);var A=e/N;u.push([c[0]-L[0]*A,c[1]-L[1]*A])}}}else{var T=[c[0]-s[0],c[1]-s[1]];this.normalize(T),u.push([c[0]+T[1]*e,c[1]-T[0]*e])}else{var z=[m[0]-c[0],m[1]-c[1]];this.normalize(z),u.push([c[0]+z[1]*e,c[1]-z[0]*e])}s=c,c=m}return u.length<(h?3:2)?null:(h&&u.push([u[0][0],u[0][1]]),u)}}]),t}(),_=1.7320508075688772,y=v.TF.OpenEnded,g=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new k(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();g.instance=null;var k=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s;return(0,n.Z)(this,i),(s=e.call(this,t,!1,!0))._curveHelper=new d,s._width=(void 0!==r.width?r.width:5)*a,s._arrowType=void 0!==r.geometricEffectArrowType?r.geometricEffectArrowType:void 0!==r.arrowType?r.arrowType:y,s._offsetFlattenError=m*a,s}return(0,a.Z)(i,[{key:"processPath",value:function(t){switch(this._arrowType){case v.TF.OpenEnded:default:return this._constructSimpleArrow(t,!0);case v.TF.Block:return this._constructSimpleArrow(t,!1);case v.TF.Crossed:return this._constructCrossedArrow(t)}}},{key:"_constructSimpleArrow",value:function(t,e){var i=this._curveHelper.calculatePathLength(t),r=this._width;i<2*r&&(r=i/2);var n=this._curveHelper.getSubCurve(t,0,i-r);if(!n)return null;var a=r/2;if(this._curveHelper.isEmpty(n,!1))return null;var s=this._constructOffset(n,-a);if(!s)return null;var o=this._constructOffset(n,a);if(!o)return null;var l=this._constructArrowBasePoint(s,-a/2);if(!l)return null;var h=this._constructArrowBasePoint(o,a/2);if(!h)return null;var u=t[t.length-1];e||(this._makeControlPoint(o,!0),this._makeControlPoint(s,!0));var c=new p;return c.addPath(o,!0),c.lineTo(h),this._makeControlPoint(c.path()),c.lineTo(u),this._makeControlPoint(c.path()),c.lineTo(l),this._makeControlPoint(c.path()),c.addPath(s,!1),e?{paths:[c.path()]}:(c.close(),{rings:[c.path()]})}},{key:"_constructCrossedArrow",value:function(t){var e=this._curveHelper.calculatePathLength(t),i=this._width;e<i*(1+_+1)&&(i=e/(1+_+1));var r=this._curveHelper.getSubCurve(t,0,e-i*(1+_));if(!r)return null;var n=i/2;if(this._curveHelper.isEmpty(r,!1))return null;var a=this._constructOffset(r,n);if(!a)return null;var s=this._constructOffset(r,-n);if(!s)return null;var o=this._curveHelper.getSubCurve(t,0,e-i);if(!o)return null;if(this._curveHelper.isEmpty(o,!1))return null;var l=this._constructOffset(o,n);if(!l)return null;var h=this._constructOffset(o,-n);if(!h)return null;var u=l[l.length-1],c=this._constructArrowBasePoint(l,n/2);if(!c)return null;var f=h[h.length-1],v=this._constructArrowBasePoint(h,-n/2);if(!v)return null;var m=t[t.length-1];this._makeControlPoint(a,!1),this._makeControlPoint(s,!1);var d=new p;return d.addPath(a,!0),this._makeControlPoint(d.path()),d.lineTo(f),d.lineTo(v),this._makeControlPoint(d.path()),d.lineTo(m),this._makeControlPoint(d.path()),d.lineTo(c),this._makeControlPoint(d.path()),d.lineTo(u),this._makeControlPoint(d.path()),d.addPath(s,!1),{paths:[d.path()]}}},{key:"_constructOffset",value:function(t,e){return this._curveHelper.offset(t,e,v.id.Rounded,4,this._offsetFlattenError)}},{key:"_constructArrowBasePoint",value:function(t,e){if(!t||t.length<2)return null;var i=t[t.length-2],r=t[t.length-1],n=[r[0]-i[0],r[1]-i[1]];return this._curveHelper.normalize(n),[r[0]+n[1]*e,r[1]-n[0]*e]}},{key:"_makeControlPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,l.qh)(e?t[0]:t[t.length-1],1)}}]),i}(l.zY),P=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new x(t,e,i,r)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();P.instance=null;var x=function(){function t(e,i,r,a){(0,n.Z)(this,t),this._inputGeometries=e,this._curveHelper=new d,this._size=(void 0!==i.size?i.size:1)*r,this._offsetFlattenError=m*r}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if((0,o.YX)(t))if(this._size>0){var e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]],i=this._curveHelper.offset(e,this._size,v.id.Rounded,4,this._offsetFlattenError);if(i)return{rings:[i]}}else{if(!(this._size<0))return t;if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._size>0)return{xmin:t.xmin-this._size,xmax:t.xmax+this._size,ymin:t.ymin-this._size,ymax:t.ymax+this._size}}if((0,o.oU)(t)){if(0===this._size)return t;var n,a=[],s=(0,r.Z)(t.rings);try{for(s.s();!(n=s.n()).done;){var l=n.value,h=this._curveHelper.offset(l,this._size,v.id.Rounded,4,this._offsetFlattenError);h&&a.push(h)}}catch(y){s.e(y)}finally{s.f()}if(a.length)return{rings:a}}if((0,o.l9)(t)&&this._size>0){var u,c=[],f=(0,r.Z)(t.paths);try{for(f.s();!(u=f.n()).done;){var m=u.value;if(m&&m.length>1){var p=this._curveHelper.offset(m,this._size,v.id.Rounded,4,this._offsetFlattenError),d=this._curveHelper.offset(m,-this._size,v.id.Rounded,4,this._offsetFlattenError);if(p&&d){for(var _=d.length-1;_>=0;_--)p.push(d[_]);p.push([p[0][0],p[0][1]]),c.push(p)}}}}catch(y){f.e(y)}finally{f.f()}if(c.length)return{rings:c}}(0,o.wp)(t)&&this._size,t=this._inputGeometries.next()}return null}}]),t}(),M=i(29439),b=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new S(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();b.instance=null;var S=function(){function t(e,i,r){var a;(0,n.Z)(this,t),this._defaultPointSize=20,this._inputGeometries=e,this._geomUnitsPerPoint=r,this._rule=null!==(a=i.rule)&&void 0!==a?a:v.Em.FullGeometry,this._defaultSize=this._defaultPointSize*r}return(0,a.Z)(t,[{key:"next",value:function(){for(var t;t=this._inputGeometries.next();){var e=void 0;if((0,o.wp)(t)?e=this._processGeom([[[t.x,t.y]]]):(0,o.aW)(t)?e=this._processGeom([t.points]):(0,o.l9)(t)?e=this._processGeom(t.paths):(0,o.oU)(t)&&(e=this._processGeom(t.rings)),e&&e.length)return{paths:e}}return null}},{key:"_clone",value:function(t){return[t[0],t[1]]}},{key:"_mid",value:function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}},{key:"_mix",value:function(t,e,i,r){return[t[0]*e+i[0]*r,t[1]*e+i[1]*r]}},{key:"_add",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"_add2",value:function(t,e,i){return[t[0]+e,t[1]+i]}},{key:"_sub",value:function(t,e){return[t[0]-e[0],t[1]-e[1]]}},{key:"_dist",value:function(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}},{key:"_norm",value:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}},{key:"_normalize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e/this._norm(t);t[0]*=i,t[1]*=i}},{key:"_leftPerpendicular",value:function(t){var e=-t[1],i=t[0];t[0]=e,t[1]=i}},{key:"_leftPerp",value:function(t){return[-t[1],t[0]]}},{key:"_rightPerpendicular",value:function(t){var e=t[1],i=-t[0];t[0]=e,t[1]=i}},{key:"_rightPerp",value:function(t){return[t[1],-t[0]]}},{key:"_dotProduct",value:function(t,e){return t[0]*e[0]+t[1]*e[1]}},{key:"_crossProduct",value:function(t,e){return t[0]*e[1]-t[1]*e[0]}},{key:"_rotateDirect",value:function(t,e,i){var r=t[0]*e-t[1]*i,n=t[0]*i+t[1]*e;t[0]=r,t[1]=n}},{key:"_makeCtrlPt",value:function(t){var e=[t[0],t[1]];return(0,l.qh)(e,1),e}},{key:"_addAngledTicks",value:function(t,e,i,r){var n=this._sub(i,e);this._normalize(n);var a,s=this._crossProduct(n,this._sub(r,e));a=s>0?this._rightPerp(n):this._leftPerp(n);var o=Math.abs(s)/2,l=[];l.push([e[0]+(a[0]-n[0])*o,e[1]+(a[1]-n[1])*o]),l.push(e),l.push(i),l.push([i[0]+(a[0]+n[0])*o,i[1]+(a[1]+n[1])*o]),t.push(l)}},{key:"_addBezier2",value:function(t,e,i,r,n){if(0!=n--){var a=this._mid(e,i),s=this._mid(i,r),o=this._mid(a,s);this._addBezier2(t,e,a,o,n),this._addBezier2(t,o,s,r,n)}else t.push(r)}},{key:"_addBezier3",value:function(t,e,i,r,n,a){if(0!=a--){var s=this._mid(e,i),o=this._mid(i,r),l=this._mid(r,n),h=this._mid(s,o),u=this._mid(o,l),c=this._mid(h,u);this._addBezier3(t,e,s,h,c,a),this._addBezier3(t,c,u,l,n,a)}else t.push(n)}},{key:"_add90DegArc",value:function(t,e,i,r,n){var a=null!==n&&void 0!==n?n:this._crossProduct(this._sub(i,e),this._sub(r,e))>0,s=this._mid(e,i),o=this._sub(s,e);a?this._leftPerpendicular(o):this._rightPerpendicular(o),s[0]+=o[0],s[1]+=o[1],this._addBezier3(t,e,this._mix(e,.33333,s,.66667),this._mix(i,.33333,s,.66667),i,4)}},{key:"_addArrow",value:function(t,e,i){var r=e[0],n=e[1],a=e[e.length-1],s=this._sub(r,n);this._normalize(s);var o=this._crossProduct(s,this._sub(a,n)),l=.5*o,h=this._leftPerp(s),u=[a[0]-h[0]*o,a[1]-h[1]*o],c=e.length-1,f=[];f.push(i?[-h[0],-h[1]]:h);for(var v=[-s[0],-s[1]],m=1;m<c-1;m++){var p=this._sub(e[m+1],e[m]);this._normalize(p);var d=this._dotProduct(p,v),_=this._crossProduct(p,v),y=Math.sqrt((1+d)/2),g=this._sub(p,v);this._normalize(g),g[0]/=y,g[1]/=y,f.push(_<0?[-g[0],-g[1]]:g),v=p}f.push(this._rightPerp(v));for(var k=f.length-1;k>0;k--)t.push([e[k][0]+f[k][0]*l,e[k][1]+f[k][1]*l]);t.push([u[0]+f[0][0]*l,u[1]+f[0][1]*l]),t.push([u[0]+f[0][0]*o,u[1]+f[0][1]*o]),t.push(r),t.push([u[0]-f[0][0]*o,u[1]-f[0][1]*o]),t.push([u[0]-f[0][0]*l,u[1]-f[0][1]*l]);for(var P=1;P<f.length;P++)t.push([e[P][0]-f[P][0]*l,e[P][1]-f[P][1]*l])}},{key:"_cp2",value:function(t,e,i){return t.length>=2?t[1]:this._add2(t[0],e*this._defaultSize,i*this._defaultSize)}},{key:"_cp3",value:function(t,e,i,r){if(t.length>=3)return t[2];var n=this._mix(t[0],1-i,e,i),a=this._sub(e,t[0]);return this._normalize(a),this._rightPerpendicular(a),[n[0]+a[0]*r*this._defaultSize,n[1]+a[1]*r*this._defaultSize]}},{key:"_arrowPath",value:function(t){if(t.length>2)return t;var e=t[0],i=this._cp2(t,-4,0),r=this._sub(e,i);this._normalize(r);var n=this._rightPerp(r);return[e,i,[e[0]+(n[0]-r[0])*this._defaultSize,e[1]+(n[1]-r[1])*this._defaultSize]]}},{key:"_arrowLastSeg",value:function(t){var e,i=t[0],r=this._cp2(t,-4,0);if(t.length>=3)e=t[t.length-1];else{var n=this._sub(i,r);this._normalize(n);var a=this._rightPerp(n);e=[i[0]+(a[0]-n[0])*this._defaultSize,i[1]+(a[1]-n[1])*this._defaultSize]}return[r,e]}},{key:"_processGeom",value:function(t){if(!t)return null;var e,i=[],n=(0,r.Z)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(a&&0!==a.length){var s=a.length,o=a[0];switch(this._rule){case v.Em.PerpendicularFromFirstSegment:var h=this._cp2(a,0,-1),u=this._cp3(a,h,.5,4),c=[];c.push(u),c.push(this._mid(o,h)),i.push(c);break;case v.Em.ReversedFirstSegment:var f=this._cp2(a,0,-1);i.push([f,o]);break;case v.Em.PerpendicularToSecondSegment:var m=this._cp2(a,-4,1),p=this._cp3(a,m,.882353,-1.94),d=[];d.push(this._mid(m,p)),d.push(o),i.push(d);break;case v.Em.SecondSegmentWithTicks:var _=this._cp2(a,-4,1),y=this._cp3(a,_,.882353,-1.94),g=this._sub(y,_),k=void 0;k=this._crossProduct(g,this._sub(o,_))>0?this._rightPerp(k):this._leftPerp(g);var P=[];P.push([_[0]+(k[0]-g[0])/3,_[1]+(k[1]-g[1])/3]),P.push(_),P.push(y),P.push([y[0]+(k[0]+g[0])/3,y[1]+(k[1]+g[1])/3]),i.push(P);break;case v.Em.DoublePerpendicular:var x=this._cp2(a,0,-1),b=this._cp3(a,x,.5,3),S=this._mid(o,x),C=this._sub(S,b);this._normalize(C);var w=this._crossProduct(C,this._sub(o,b));this._leftPerpendicular(C);var I=[];I.push(o),I.push([b[0]+C[0]*w,b[1]+C[1]*w]),i.push(I);var Z=[];Z.push([b[0]-C[0]*w,b[1]-C[1]*w]),Z.push(x),i.push(Z);break;case v.Em.OppositeToFirstSegment:var N=this._cp2(a,0,-1),L=this._cp3(a,N,.5,3),A=this._mid(o,N),T=this._sub(A,L);this._normalize(T);var z=this._crossProduct(T,this._sub(o,L));this._leftPerpendicular(T);var E=[];E.push([L[0]+T[0]*z,L[1]+T[1]*z]),E.push([L[0]-T[0]*z,L[1]-T[1]*z]),i.push(E);break;case v.Em.TriplePerpendicular:var O=this._cp2(a,0,-1),R=this._cp3(a,O,.5,4),F=this._mid(o,O),G=this._sub(F,R);this._normalize(G);var H=this._crossProduct(G,this._sub(o,R));this._leftPerpendicular(G);var X=[];X.push([R[0]+G[0]*H*.8,R[1]+G[1]*H*.8]),X.push([F[0]+.8*(o[0]-F[0]),F[1]+.8*(o[1]-F[1])]),i.push(X),i.push([R,F]);var D=[];D.push([R[0]-G[0]*H*.8,R[1]-G[1]*H*.8]),D.push([F[0]+.8*(O[0]-F[0]),F[1]+.8*(O[1]-F[1])]),i.push(D);break;case v.Em.HalfCircleFirstSegment:var Y=this._cp2(a,0,-1),U=this._cp3(a,Y,.5,4),W=this._mid(o,Y),B=this._sub(Y,o),V=Math.cos(Math.PI/18),J=Math.sin(Math.PI/18),q=Math.sqrt((1+V)/2),j=Math.sqrt((1-V)/2),$=[],Q=void 0;this._crossProduct(B,this._sub(U,o))>0?($.push(o),B=this._sub(o,W),Q=Y):($.push(Y),B=this._sub(Y,W),Q=o),this._rotateDirect(B,q,j),B[0]/=q,B[1]/=q;for(var K=1;K<=18;K++)$.push(this._add(W,B)),this._rotateDirect(B,V,J);$.push(Q),i.push($);break;case v.Em.HalfCircleSecondSegment:var tt=this._cp2(a,0,-1),et=this._cp3(a,tt,1,-1),it=this._sub(o,tt);this._normalize(it);var rt=this._crossProduct(it,this._sub(et,tt))/2;this._leftPerpendicular(it);var nt=[tt[0]+it[0]*rt,tt[1]+it[1]*rt];it=this._sub(tt,nt);var at=Math.cos(Math.PI/18),st=Math.sin(Math.PI/18);rt>0&&(st=-st);for(var ot=[tt],lt=1;lt<=18;lt++)this._rotateDirect(it,at,st),ot.push(this._add(nt,it));i.push(ot);break;case v.Em.HalfCircleExtended:var ht=this._cp2(a,0,-2),ut=this._cp3(a,ht,1,-1),ct=void 0;if(s>=4)ct=a[3];else{var ft=this._sub(o,ht);ct=this._add(ut,ft)}var vt=this._dist(ht,ut)/2/.75,mt=this._sub(ht,o);this._normalize(mt,vt);var pt=this._sub(ut,ct);this._normalize(pt,vt);var dt=[ct,ut];i.push(dt);var _t=[this._clone(ut)];this._addBezier3(_t,ut,this._add(ut,pt),this._add(ht,mt),ht,4),_t.push(o),i.push(_t);break;case v.Em.OpenCircle:for(var yt=this._cp2(a,-2,0),gt=this._sub(yt,o),kt=Math.cos(Math.PI/18),Pt=-Math.sin(Math.PI/18),xt=[yt],Mt=1;Mt<=33;Mt++)this._rotateDirect(gt,kt,Pt),xt.push(this._add(o,gt));i.push(xt);break;case v.Em.CoverageEdgesWithTicks:var bt=this._cp2(a,0,-1),St=void 0,Ct=void 0;if(s>=3)St=a[2];else{var wt=this._sub(bt,o),It=this._leftPerp(wt);St=[o[0]+It[0]-.25*wt[0],o[1]+It[1]-.25*wt[1]]}if(s>=4)Ct=a[3];else{var Zt=this._mid(o,bt),Nt=this._sub(o,bt);this._normalize(Nt),this._leftPerpendicular(Nt);var Lt=this._crossProduct(Nt,this._sub(St,Zt));this._rightPerpendicular(Nt),Ct=[St[0]+Nt[0]*Lt*2,St[1]+Nt[1]*Lt*2]}var At=this._sub(bt,o),Tt=void 0,zt=void 0;Tt=this._crossProduct(At,this._sub(St,o))>0?this._rightPerp(At):this._leftPerp(At),(zt=[]).push(St),zt.push(o),zt.push([o[0]+(Tt[0]-At[0])/3,o[1]+(Tt[1]-At[1])/3]),i.push(zt),Tt=this._crossProduct(At,this._sub(Ct,bt))>0?this._rightPerp(Tt):this._leftPerp(At),(zt=[]).push([bt[0]+(Tt[0]+At[0])/3,bt[1]+(Tt[1]+At[1])/3]),zt.push(bt),zt.push(Ct),i.push(zt);break;case v.Em.GapExtentWithDoubleTicks:var Et=this._cp2(a,0,2),Ot=this._cp3(a,Et,0,1),Rt=void 0;if(s>=4)Rt=a[3];else{var Ft=this._sub(Et,o);Rt=this._add(Ot,Ft)}this._addAngledTicks(i,o,Et,this._mid(Ot,Rt)),this._addAngledTicks(i,Ot,Rt,this._mid(o,Et));break;case v.Em.GapExtentMidline:var Gt=this._cp2(a,2,0),Ht=this._cp3(a,Gt,0,1),Xt=void 0;if(s>=4)Xt=a[3];else{var Dt=this._sub(Gt,o);Xt=this._add(Ht,Dt)}var Yt=[];Yt.push(this._mid(o,Ht)),Yt.push(this._mid(Gt,Xt)),i.push(Yt);break;case v.Em.Chevron:var Ut=this._cp2(a,-1,-1),Wt=void 0;if(s>=3)Wt=a[2];else{var Bt=this._sub(Ut,o);this._leftPerpendicular(Bt),Wt=this._add(o,Bt)}i.push([Ut,this._makeCtrlPt(o),Wt]);break;case v.Em.PerpendicularWithArc:var Vt=this._cp2(a,0,-2),Jt=this._cp3(a,Vt,.5,-1),qt=this._sub(Vt,o),jt=this._norm(qt);qt[0]/=jt,qt[1]/=jt;var $t=this._crossProduct(qt,this._sub(Jt,o)),Qt=this._dotProduct(qt,this._sub(Jt,o));Qt<.05*jt?Qt=.05*jt:Qt>.95*jt&&(Qt=.95*jt);var Kt=[o[0]+qt[0]*Qt,o[1]+qt[1]*Qt];this._leftPerpendicular(qt);var te=[];te.push([Kt[0]-qt[0]*$t,Kt[1]-qt[1]*$t]),te.push([Kt[0]+qt[0]*$t,Kt[1]+qt[1]*$t]),i.push(te);var ee=[Vt[0]+qt[0]*$t,Vt[1]+qt[1]*$t];qt=this._sub(Vt,ee);var ie=Math.cos(Math.PI/18),re=Math.sin(Math.PI/18);$t<0&&(re=-re),te=[o,Vt];for(var ne=1;ne<=9;ne++)this._rotateDirect(qt,ie,re),te.push(this._add(ee,qt));i.push(te);break;case v.Em.ClosedHalfCircle:for(var ae=this._cp2(a,2,0),se=this._mid(o,ae),oe=this._sub(ae,se),le=Math.cos(Math.PI/18),he=Math.sin(Math.PI/18),ue=[o,ae],ce=1;ce<=18;ce++)this._rotateDirect(oe,le,he),ue.push(this._add(se,oe));i.push(ue);break;case v.Em.TripleParallelExtended:var fe=this._cp2(a,0,-2),ve=this._cp3(a,fe,1,-2),me=this._mid(o,fe),pe=this._sub(ve,fe);this._normalize(pe);var de=Math.abs(this._crossProduct(pe,this._sub(me,fe)))/2,_e=this._dist(fe,ve),ye=[fe,o];ye.push([o[0]+pe[0]*_e*.5,o[1]+pe[1]*_e*.5]),i.push(ye);var ge=[];ge.push([me[0]-pe[0]*de,me[1]-pe[1]*de]),ge.push([me[0]+pe[0]*_e*.375,me[1]+pe[1]*_e*.375]),(0,l.qh)(ge[ge.length-1],1),ge.push([me[0]+pe[0]*_e*.75,me[1]+pe[1]*_e*.75]),i.push(ge);var ke=[fe,ve];i.push(ke);break;case v.Em.ParallelWithTicks:var Pe=this._cp2(a,3,0),xe=this._cp3(a,Pe,.5,-1),Me=this._sub(xe,Pe);this._normalize(Me);var be=this._crossProduct(Me,this._sub(xe,o));this._leftPerpendicular(Me),this._addAngledTicks(i,o,Pe,xe),this._addAngledTicks(i,this._mix(o,1,Me,be),this._mix(Pe,1,Me,be),this._mid(o,Pe));break;case v.Em.Parallel:var Se=this._cp2(a,3,0),Ce=this._cp3(a,Se,.5,-1),we=this._sub(Se,o);this._normalize(we);var Ie=this._leftPerp(we),Ze=this._crossProduct(we,this._sub(Ce,o)),Ne=[o,Se];i.push(Ne),(Ne=[]).push([o[0]+Ie[0]*Ze,o[1]+Ie[1]*Ze]),Ne.push([Se[0]+Ie[0]*Ze,Se[1]+Ie[1]*Ze]),i.push(Ne);break;case v.Em.PerpendicularToFirstSegment:var Le=this._cp2(a,3,0),Ae=this._cp3(a,Le,.5,-1),Te=this._mid(o,Le),ze=this._sub(Le,o);this._normalize(ze);var Ee=this._crossProduct(ze,this._sub(Ae,o));this._leftPerpendicular(ze);var Oe=[];Oe.push([Te[0]-ze[0]*Ee*.25,Te[1]-ze[1]*Ee*.25]),Oe.push([Te[0]+ze[0]*Ee*1.25,Te[1]+ze[1]*Ee*1.25]),i.push(Oe);break;case v.Em.ParallelOffset:var Re=this._cp2(a,3,0),Fe=this._cp3(a,Re,.5,-1),Ge=this._sub(Re,o);this._normalize(Ge);var He=this._crossProduct(Ge,this._sub(Fe,o));this._leftPerpendicular(Ge);var Xe=[];Xe.push([o[0]-Ge[0]*He,o[1]-Ge[1]*He]),Xe.push([Re[0]-Ge[0]*He,Re[1]-Ge[1]*He]),i.push(Xe);var De=[];De.push([o[0]+Ge[0]*He,o[1]+Ge[1]*He]),De.push([Re[0]+Ge[0]*He,Re[1]+Ge[1]*He]),i.push(De);break;case v.Em.OffsetOpposite:var Ye=this._cp2(a,3,0),Ue=this._cp3(a,Ye,.5,-1),We=this._sub(Ye,o);this._normalize(We);var Be=this._crossProduct(We,this._sub(Ue,o));this._leftPerpendicular(We);var Ve=[];Ve.push([o[0]-We[0]*Be,o[1]-We[1]*Be]),Ve.push([Ye[0]-We[0]*Be,Ye[1]-We[1]*Be]),i.push(Ve);break;case v.Em.OffsetSame:var Je=this._cp2(a,3,0),qe=this._cp3(a,Je,.5,-1),je=this._sub(Je,o);this._normalize(je);var $e=this._crossProduct(je,this._sub(qe,o));this._leftPerpendicular(je);var Qe=[];Qe.push([o[0]+je[0]*$e,o[1]+je[1]*$e]),Qe.push([Je[0]+je[0]*$e,Je[1]+je[1]*$e]),i.push(Qe);break;case v.Em.CircleWithArc:var Ke=this._cp2(a,3,0),ti=this._cp3(a,Ke,.5,-1),ei=void 0,ii=void 0;if(s>=4)ei=a[3],ii=this._crossProduct(this._sub(ei,Ke),this._sub(ti,Ke))>0;else{ei=Ke,ii=this._crossProduct(this._sub(ei,o),this._sub(ti,o))>0;var ri=24*this._geomUnitsPerPoint,ni=this._sub(ei,o);this._normalize(ni,ri);var ai=Math.sqrt(2)/2;this._rotateDirect(ni,ai,ii?ai:-ai),Ke=this._add(o,ni)}for(var si=this._sub(Ke,o),oi=Math.cos(Math.PI/18),li=Math.sin(Math.PI/18),hi=[Ke],ui=1;ui<=36;ui++)this._rotateDirect(si,oi,li),hi.push(this._add(o,si));this._add90DegArc(hi,Ke,ei,ti,ii),(0,l.qh)(hi[hi.length-8],1),i.push(hi);break;case v.Em.DoubleJog:var ci=void 0,fi=void 0,vi=this._cp2(a,-3,1);if(ci=s>=3?a[2]:this._add(o,this._sub(o,vi)),s>=4)fi=a[3];else{var mi=o;o=vi,fi=ci;var pi=this._dist(o,mi),di=this._dist(fi,mi),_i=30*this._geomUnitsPerPoint;.5*pi<_i&&(_i=.5*pi),.5*di<_i&&(_i=.5*di),vi=this._mix(o,_i/pi,mi,(pi-_i)/pi),ci=this._mix(fi,_i/di,mi,(di-_i)/di)}var yi=this._mid(o,vi),gi=this._mid(fi,ci),ki=this._dist(o,vi),Pi=this._dist(ci,fi),xi=Math.min(ki,Pi)/8;xi=Math.min(xi,24*this._geomUnitsPerPoint);var Mi=Math.cos(Math.PI/4),bi=this._sub(o,vi);this._normalize(bi,xi),this._crossProduct(bi,this._sub(fi,vi))>0?this._rotateDirect(bi,Mi,-Mi):this._rotateDirect(bi,Mi,Mi);var Si=[];Si.push(vi),Si.push(this._add(yi,bi)),Si.push(this._sub(yi,bi)),Si.push(o),i.push(Si),bi=this._sub(fi,ci),this._normalize(bi,xi),this._crossProduct(bi,this._sub(o,ci))<0?this._rotateDirect(bi,Mi,Mi):this._rotateDirect(bi,Mi,-Mi),(Si=[]).push(ci),Si.push(this._add(gi,bi)),Si.push(this._sub(gi,bi)),Si.push(fi),i.push(Si);break;case v.Em.PerpendicularOffset:var Ci=this._cp2(a,-4,1),wi=this._cp3(a,Ci,.882353,-1.94),Ii=this._sub(wi,Ci);this._crossProduct(Ii,this._sub(o,Ci))>0?this._rightPerpendicular(Ii):this._leftPerpendicular(Ii);var Zi=[Ii[0]/8,Ii[1]/8],Ni=this._sub(this._mid(Ci,wi),Zi);i.push([Ni,o]);break;case v.Em.LineExcludingLastSegment:for(var Li=this._arrowPath(a),Ai=[],Ti=Li.length-2;Ti--;)Ai.push(Li[Ti]);i.push(Ai);break;case v.Em.MultivertexArrow:var zi=this._arrowPath(a),Ei=[];this._addArrow(Ei,zi,!1),i.push(Ei);break;case v.Em.CrossedArrow:var Oi=this._arrowPath(a),Ri=[];this._addArrow(Ri,Oi,!0),i.push(Ri);break;case v.Em.ChevronArrow:var Fi=this._arrowLastSeg(a),Gi=(0,M.Z)(Fi,2),Hi=Gi[0],Xi=Gi[1],Di=10*this._geomUnitsPerPoint,Yi=this._sub(o,Hi);this._normalize(Yi);var Ui=this._crossProduct(Yi,this._sub(Xi,Hi)),Wi=this._leftPerp(Yi),Bi=[Xi[0]-Wi[0]*Ui*2,Xi[1]-Wi[1]*Ui*2],Vi=[];Vi.push([Xi[0]+Yi[0]*Di,Xi[1]+Yi[1]*Di]),Vi.push(o),Vi.push([Bi[0]+Yi[0]*Di,Bi[1]+Yi[1]*Di]),i.push(Vi);break;case v.Em.ChevronArrowOffset:var Ji=this._arrowLastSeg(a),qi=(0,M.Z)(Ji,2),ji=qi[0],$i=qi[1],Qi=this._sub(o,ji);this._normalize(Qi);var Ki=this._crossProduct(Qi,this._sub($i,ji));this._leftPerpendicular(Qi);var tr=[$i[0]-Qi[0]*Ki,$i[1]-Qi[1]*Ki],er=[];er.push([tr[0]+Qi[0]*Ki*.5,tr[1]+Qi[1]*Ki*.5]),er.push(this._mid(tr,o)),er.push([tr[0]-Qi[0]*Ki*.5,tr[1]-Qi[1]*Ki*.5]),i.push(er);break;case v.Em.PartialFirstSegment:var ir=this._arrowLastSeg(a),rr=(0,M.Z)(ir,2),nr=rr[0],ar=rr[1],sr=this._sub(o,nr);this._normalize(sr);var or=this._crossProduct(sr,this._sub(ar,nr));this._leftPerpendicular(sr);var lr=[ar[0]-sr[0]*or,ar[1]-sr[1]*or];i.push([nr,lr]);break;case v.Em.Arch:var hr=this._cp2(a,0,-1),ur=this._cp3(a,hr,.5,1),cr=this._sub(o,hr),fr=this._mix(ur,1,cr,.55),vr=this._mix(ur,1,cr,-.55),mr=[o];this._addBezier2(mr,o,fr,ur,4),this._addBezier2(mr,ur,vr,hr,4),i.push(mr);break;case v.Em.CurvedParallelTicks:var pr=this._cp2(a,-4,1),dr=this._cp3(a,pr,.882353,-1.94),_r=this._sub(dr,pr);this._crossProduct(_r,this._sub(o,pr))>0?this._rightPerpendicular(_r):this._leftPerpendicular(_r);var yr=[_r[0]/8,_r[1]/8],gr=this._sub(this._mid(pr,dr),yr),kr=this._sub(this._mix(pr,.75,dr,.25),yr),Pr=this._sub(this._mix(pr,.25,dr,.75),yr),xr=[pr];this._addBezier2(xr,pr,kr,gr,3),this._addBezier2(xr,gr,Pr,dr,3),i.push(xr);for(var Mr=0;Mr<8;Mr++){var br=xr[2*Mr+1],Sr=[this._clone(br)];Sr.push(this._add(br,[_r[0]/4,_r[1]/4])),i.push(Sr)}break;case v.Em.Arc90Degrees:var Cr=this._cp2(a,0,-1),wr=this._cp3(a,Cr,.5,1),Ir=[Cr];this._add90DegArc(Ir,Cr,o,wr),i.push(Ir);break;case v.Em.FullGeometry:default:i.push(a)}}}}catch(Zr){n.e(Zr)}finally{n.f()}return i}}]),t}(),C=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new I(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();C.instance=null;var w,I=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s;return(0,n.Z)(this,i),(s=e.call(this,t,!0,!0))._curveHelper=new d,s._beginCut=(void 0!==r.beginCut?r.beginCut:1)*a,s._endCut=(void 0!==r.endCut?r.endCut:1)*a,s._middleCut=(void 0!==r.middleCut?r.middleCut:0)*a,s._invert=void 0!==r.invert&&r.invert,s._beginCut<0&&(s._beginCut=0),s._endCut<0&&(s._endCut=0),s._middleCut<0&&(s._middleCut=0),s}return(0,a.Z)(i,[{key:"processPath",value:function(t){var e=this._beginCut,i=this._endCut,r=this._middleCut,n=this._curveHelper.calculatePathLength(t),a=[];if(this._invert)if(0===e&&0===i&&0===r);else if(e+i+r>=n)a.push(t);else{var s=this._curveHelper.getSubCurve(t,0,e);s&&a.push(s),(s=this._curveHelper.getSubCurve(t,.5*(n-r),.5*(n+r)))&&a.push(s),(s=this._curveHelper.getSubCurve(t,n-i,i))&&a.push(s)}else if(0===e&&0===i&&0===r)a.push(t);else if(e+i+r>=n);else if(0===r){var o=this._curveHelper.getSubCurve(t,e,n-i);o&&a.push(o)}else{var l=this._curveHelper.getSubCurve(t,e,.5*(n-r));l&&a.push(l),(l=this._curveHelper.getSubCurve(t,.5*(n+r),n-i))&&a.push(l)}return 0===a.length?null:{paths:a}}}]),i}(l.zY),Z=1e-7,N=function(){function t(){(0,n.Z)(this,t),this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}return(0,a.Z)(t,[{key:"isEmpty",value:function(){return 0===this._values.length}},{key:"size",value:function(){return this._values.length}},{key:"init",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._setEmpty(),!t||0===t.length)return!1;for(var r=0;r<t.length;r++){var n=Math.abs(t[r]);i&&n<Z&&(n=Z),this._values.push(n),this._length+=n}return e&&1&t.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}},{key:"scale",value:function(t){for(var e=this._values?this._values.length:0,i=0;i<e;++i)this._values[i]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t}},{key:"addValue",value:function(t){this._length+=t,this._values.push(t)}},{key:"firstValue",value:function(){return this._values[0]}},{key:"lastValue",value:function(){return this._values[this._values.length-1]}},{key:"nextValue",value:function(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}},{key:"reset",value:function(){this._currentValue=-1}},{key:"length",value:function(){return this._length}},{key:"_setEmpty",value:function(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}]),t}(),L=(0,a.Z)((function t(){(0,n.Z)(this,t),this.pt=null,this.ca=0,this.sa=0}));!function(t){t[t.FAIL=0]="FAIL",t[t.END=1]="END",t[t.CONTINUE=2]="CONTINUE"}(w||(w={}));var A=function(){function t(){(0,n.Z)(this,t),this.reset()}return(0,a.Z)(t,[{key:"reset",value:function(){this.segment=-1,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}},{key:"isValid",value:function(){return-1!==this.segment}},{key:"copyTo",value:function(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd}}]),t}(),T=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,n.Z)(this,i),(t=e.call(this,r,a))._tolerance=m,t._currentPosition=new A,t}return(0,a.Z)(i,[{key:"updateTolerance",value:function(t){this._tolerance=m*t}},{key:"init",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return i?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._path=t,this._seg=-1,this._setPosAtNextPart()}},{key:"curPositionIsValid",value:function(){return this._currentPosition.isValid()}},{key:"nextPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.FAIL,i=new A;return!!this._nextPosition(t,i,null,e)&&(i.copyTo(this._currentPosition),!0)}},{key:"curPointAndAngle",value:function(t){t.pt=this._getPoint(this._currentPosition);var e=this._getAngle(this._currentPosition),i=(0,M.Z)(e,2),r=i[0],n=i[1];t.ca=r,t.sa=n}},{key:"nextPointAndAngle",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.FAIL,r=new A;if(!this._nextPosition(t,r,null,i))return!1;r.copyTo(this._currentPosition),e.pt=this._getPoint(r);var n=this._getAngle(r),a=(0,M.Z)(n,2),s=a[0],o=a[1];return e.ca=s,e.sa=o,!0}},{key:"nextCurve",value:function(t){if(0===t)return null;var e=[],i=new A;return this._nextPosition(t,i,e,w.END)?(i.copyTo(this._currentPosition),e):null}},{key:"isPathEnd",value:function(){return this._currentPosition.isPathEnd}},{key:"getPathEnd",value:function(){if(-1===this._currentPosition.segment)throw new Error("missing segment");return this._path[this._currentPosition.segment+1]}},{key:"_nextPosition",value:function(t,e,i,r){if(this._currentPosition.isPathEnd)return!1;var n=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(n/=this._currentPosition.segmentLength),this._currentPosition.copyTo(e);e.abscissa+t*this._partLengthRatio>e.segmentLength+this._tolerance;){if(i){if(0===i.length)if(0===n){var a=this._path[e.segment];i.push([a[0],a[1]])}else i.push(this.getSegCoord2D(this._path,e.segment,n));var s=this._path[e.segment+1];i.push([s[0],s[1]])}if(n=0,t-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this._nextSegment(),e.segmentLength=this.calculateSegLength(this._path,e.segment),e.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return r!==w.FAIL&&(e.segmentLength=this.calculateSegLength(this._path,e.segment),e.isPartEnd=!0,r===w.END?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+t,!0);this._currentPosition.copyTo(e)}}if(e.abscissa+=t*this._partLengthRatio,i){if(0===i.length)if(0===n){var o=this._path[e.segment];i.push([o[0],o[1]])}else i.push(this.getSegCoord2D(this._path,e.segment,n));var l=e.abscissa/e.segmentLength;if(1===l){var h=this._path[e.segment+1];i.push([h[0],h[1]])}else i.push(this.getSegCoord2D(this._path,e.segment,l))}return this._partSegCount||Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0),!0}},{key:"_getPoint",value:function(t){if(-1===t.segment)throw new Error("missing segment");var e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegCoord2D(this._path,t.segment,e)}},{key:"_getAngle",value:function(t){if(-1===t.segment)throw new Error("missing segment");var e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegAngleCS(this._path,t.segment,e)}},{key:"_setPosAtNextPart",value:function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===(0,l.zv)(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var t=this._partSegCount;t;)this._previousSegment(),--t;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;var e=this._getStartPointIndex();this._ctrlPtBegin=1===(0,l.zv)(this._path[e]);var i=e+this._partSegCount+1;if(i>=this._path.length&&(i=0),this._ctrlPtEnd=1===(0,l.zv)(this._path[i]),this._patternLength>0){var r=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,n=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap,a=Math.round((this._partLength-(r+n))/this._patternLength);a<=0&&(a=r+n>0?0:1),this._partLengthRatio=this._partLength/(r+n+a*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}},{key:"_hasNextSegment",value:function(){return this._seg<this._path.length-2}},{key:"_previousSegment",value:function(){return--this._seg}},{key:"_nextSegment",value:function(){return++this._seg}},{key:"_getStartPointIndex",value:function(){return this._seg}},{key:"_getEndPointIndex",value:function(){return this._seg+1}}]),i}(d),z=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new E(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();z.instance=null;var E=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s,o,l;return(0,n.Z)(this,i),(l=e.call(this,t,!0,!0))._firstCurve=null,l._walker=new T,l._walker.updateTolerance(a),l._endings=r.lineDashEnding,l._customDashPos=-(null!==(s=r.offsetAlongLine)&&void 0!==s?s:0)*a,l._offsetAtEnd=(null!==(o=r.customEndingOffset)&&void 0!==o?o:0)*a,l._pattern=new N,l._pattern.init(r.dashTemplate,!0),l._pattern.scale(a),l}return(0,a.Z)(i,[{key:"processPath",value:function(t){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[t]};if(!this.iteratePath){var e=!0;switch(this._endings){case v.sj.HalfPattern:case v.sj.HalfGap:default:this._pattern.extPtGap=0;break;case v.sj.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case v.sj.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case v.sj.NoConstraint:this.isClosed||(e=!1);break;case v.sj.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var i=this._walker.calculatePathLength(t);if(this._pattern.isEmpty()||i<.1*this._pattern.length())return{paths:[t]};if(!this._walker.init(t,this._pattern,e))return{paths:[t]}}var r;if(this.iteratePath)r=this._pattern.nextValue();else{var n;switch(this._endings){case v.sj.HalfPattern:default:n=.5*this._pattern.firstValue();break;case v.sj.HalfGap:n=.5*-this._pattern.lastValue();break;case v.sj.FullGap:n=-this._pattern.lastValue();break;case v.sj.FullPattern:n=0;break;case v.sj.NoConstraint:case v.sj.Custom:n=-this._customDashPos}var a=n/this._pattern.length();n=(a-=Math.floor(a))*this._pattern.length(),this._pattern.reset(),r=this._pattern.nextValue();for(var s=!1;n>=r;)n-=r,r=this._pattern.nextValue(),s=!s;r-=n,s?(this._walker.nextPosition(r),r=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(r),r=this._pattern.nextValue(),this._walker.nextPosition(r),r=this._pattern.nextValue())}var o=this._walker.nextCurve(r);return o?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),p.mergePath(o,this._firstCurve),this._firstCurve=null)):(r=this._pattern.nextValue(),!this._walker.nextPosition(r)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(o=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,o=this._firstCurve,this._firstCurve=null),{paths:[o]}}}]),i}(l.zY),O=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new R(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();O.instance=null;var R=function(){function t(e,i,r){switch((0,n.Z)(this,t),this._inputGeometries=e,this._curveHelper=new d,this._width=(void 0!==i.width?i.width:2)*r,i.method){case v.$y.Mitered:default:this._method=v.id.Mitered;break;case v.$y.Bevelled:this._method=v.id.Bevelled;break;case v.$y.Rounded:case v.$y.TrueBuffer:this._method=v.id.Rounded;break;case v.$y.Square:this._method=v.id.Square}this._option=i.option,this._offsetFlattenError=m*r}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if((0,o.YX)(t)&&this._width>0){if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)-2*this._width<0)return t;var e=[];return e.push([[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]),e.push([[t.xmin+this._width,t.ymin+this._width],[t.xmax-this._width,t.ymin+this._width],[t.xmax-this._width,t.ymax-this._width],[t.xmin+this._width,t.ymax-this._width],[t.xmin+this._width,t.ymin+this._width]]),{rings:e}}if((0,o.oU)(t)&&this._width>0){var i,n=[],a=(0,r.Z)(t.rings);try{for(a.s();!(i=a.n()).done;){var s=i.value,l=this._curveHelper.calculatePathLength(s),h=this._curveHelper.offset(s,this._width,this._method,4,this._offsetFlattenError);h&&(l<0&&h.reverse(),n.push(h))}}catch(u){a.e(u)}finally{a.f()}if(n.length)return{rings:n}}t=this._inputGeometries.next()}return null}}]),t}(),F=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new G(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();F.instance=null;var G=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s;return(0,n.Z)(this,i),(s=e.call(this,t,!1,!0))._curveHelper=new d,s._length=(void 0!==r.length?r.length:20)*a,s._angle=void 0!==r.angle?r.angle:225,s._position=void 0!==r.position?r.position:50,s._length<0&&(s._length=-s._length),s._position<20&&(s._position=20),s._position>80&&(s._position=80),s._mirror=!1,s}return(0,a.Z)(i,[{key:"processPath",value:function(t){if(this._curveHelper.isEmpty(t,!1))return null;var e=t[0],i=t[t.length-1],r=[i[0]-e[0],i[1]-e[1]];this._curveHelper.normalize(r);var n=[e[0]+(i[0]-e[0])*this._position/100,e[1]+(i[1]-e[1])*this._position/100],a=Math.cos((90-this._angle)/180*Math.PI),s=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(s=-s),this._mirror=!this._mirror,{paths:[[e,[n[0]-this._length/2*a,n[1]-this._length/2*s],[n[0]+this._length/2*a,n[1]+this._length/2*s],i]]}}}]),i}(l.zY),H=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new X(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();H.instance=null;var X=function(){function t(e,i,r){(0,n.Z)(this,t),this._inputGeometries=e,this._offsetX=void 0!==i.offsetX?i.offsetX*r:0,this._offsetY=void 0!==i.offsetY?-i.offsetY*r:0}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if((0,o.YX)(t))return{xmin:t.xmin+this._offsetX,xmax:t.xmax+this._offsetX,ymin:t.ymin+this._offsetY,ymax:t.ymax+this._offsetY};if((0,o.oU)(t)){var e=(0,s.d9)(t);return this._moveMultipath(e.rings,this._offsetX,this._offsetY),e}if((0,o.l9)(t)){var i=(0,s.d9)(t);return this._moveMultipath(i.paths,this._offsetX,this._offsetY),i}if((0,o.aW)(t)){var r=(0,s.d9)(t);return this._movePath(r.points,this._offsetX,this._offsetY),r}if((0,o.wp)(t))return{x:t.x+this._offsetX,y:t.y+this._offsetY};t=this._inputGeometries.next()}return null}},{key:"_moveMultipath",value:function(t,e,i){if(t){var n,a=(0,r.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;this._movePath(s,e,i)}}catch(o){a.e(o)}finally{a.f()}}}},{key:"_movePath",value:function(t,e,i){if(t){var n,a=(0,r.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;s[0]+=e,s[1]+=i}}catch(o){a.e(o)}finally{a.f()}}}}]),t}(),D=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new Y(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();D.instance=null;var Y=function(){function t(e,i,r){var a;(0,n.Z)(this,t),this._inputGeometries=e,this._curveHelper=new d,this._offset=(null!==(a=i.offset)&&void 0!==a?a:1)*r,this._method=i.method,this._option=i.option,this._offsetFlattenError=m*r}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(0===this._offset)return t;if((0,o.YX)(t)){if(this._method===v.id.Rounded&&this._offset>0){var e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]],i=this._curveHelper.offset(e,-this._offset,this._method,4,this._offsetFlattenError);return i?{rings:[i]}:null}if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._offset>0)return{xmin:t.xmin-this._offset,xmax:t.xmax+this._offset,ymin:t.ymin-this._offset,ymax:t.ymax+this._offset}}if((0,o.oU)(t)){var n,a=[],s=(0,r.Z)(t.rings);try{for(s.s();!(n=s.n()).done;){var l=n.value,h=this._curveHelper.offset(l,-this._offset,this._method,4,this._offsetFlattenError);h&&a.push(h)}}catch(d){s.e(d)}finally{s.f()}if(a.length)return{rings:a}}if((0,o.l9)(t)){var u,c=[],f=(0,r.Z)(t.paths);try{for(f.s();!(u=f.n()).done;){var m=u.value,p=this._curveHelper.offset(m,-this._offset,this._method,4,this._offsetFlattenError);p&&c.push(p)}}catch(d){f.e(d)}finally{f.f()}if(c.length)return{paths:c}}t=this._inputGeometries.next()}return null}}]),t}(),U=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new W(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();U.instance=null;var W=function(){function t(e,i,r){(0,n.Z)(this,t),this._inputGeometries=e,this._reverse=void 0===i.reverse||i.reverse}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(!this._reverse)return t;if((0,o.l9)(t)){var e=(0,s.d9)(t);return(0,l.ov)(e.paths),e}t=this._inputGeometries.next()}return null}}]),t}(),B=i(65156),V=i(376),J=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new q(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();J.instance=null;var q=function(){function t(e,i,r){(0,n.Z)(this,t),this._inputGeometries=e,this._rotateAngle=void 0!==i.angle?i.angle*Math.PI/180:0}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(0===this._rotateAngle)return t;var e=(0,B.Ue)();(0,V.$P)(e,t);var i=(e[2]+e[0])/2,r=(e[3]+e[1])/2;if((0,o.YX)(t)){var n={rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]};return this._rotateMultipath(n.rings,i,r),n}if((0,o.oU)(t)){var a=(0,s.d9)(t);return this._rotateMultipath(a.rings,i,r),a}if((0,o.l9)(t)){var l=(0,s.d9)(t);return this._rotateMultipath(l.paths,i,r),l}if((0,o.aW)(t)){var h=(0,s.d9)(t);return this._rotatePath(h.points,i,r),h}if((0,o.wp)(t))return t;t=this._inputGeometries.next()}return null}},{key:"_rotateMultipath",value:function(t,e,i){if(t){var n,a=(0,r.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;this._rotatePath(s,e,i)}}catch(o){a.e(o)}finally{a.f()}}}},{key:"_rotatePath",value:function(t,e,i){if(t){var n,a=Math.cos(this._rotateAngle),s=Math.sin(this._rotateAngle),o=(0,r.Z)(t);try{for(o.s();!(n=o.n()).done;){var l=n.value,h=l[0]-e,u=l[1]-i;l[0]=e+h*a-u*s,l[1]=i+h*s+u*a}}catch(c){o.e(c)}finally{o.f()}}}}]),t}(),j=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new $(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();j.instance=null;var $=function(){function t(e,i,r){(0,n.Z)(this,t),this._inputGeometries=e,this._xFactor=void 0!==i.xScaleFactor?i.xScaleFactor:1.15,this._yFactor=void 0!==i.yScaleFactor?i.yScaleFactor:1.15}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(1===this._xFactor&&1===this._yFactor)return t;var e=(0,B.Ue)();(0,V.$P)(e,t);var i=(e[2]+e[0])/2,r=(e[3]+e[1])/2;if((0,o.YX)(t)){var n={rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]};return this._scaleMultipath(n.rings,i,r),n}if((0,o.oU)(t)){var a=(0,s.d9)(t);return this._scaleMultipath(a.rings,i,r),a}if((0,o.l9)(t)){var l=(0,s.d9)(t);return this._scaleMultipath(l.paths,i,r),l}if((0,o.aW)(t)){var h=(0,s.d9)(t);return this._scalePath(h.points,i,r),h}if((0,o.wp)(t))return t;t=this._inputGeometries.next()}return null}},{key:"_scaleMultipath",value:function(t,e,i){if(t){var n,a=(0,r.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;this._scalePath(s,e,i)}}catch(o){a.e(o)}finally{a.f()}}}},{key:"_scalePath",value:function(t,e,i){if(t){var n,a=(0,r.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,o=(s[0]-e)*this._xFactor,l=(s[1]-i)*this._yFactor;s[0]=e+o,s[1]=i+l}}catch(h){a.e(h)}finally{a.f()}}}}]),t}(),Q=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new K(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();Q.instance=null;var K=function(){function t(e,i,r){(0,n.Z)(this,t),this._inputGeometries=e,this._height=(void 0!==i.amplitude?i.amplitude:2)*r,this._period=(void 0!==i.period?i.period:3)*r,this._style=i.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new N,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new T,this._walker.updateTolerance(r)}return(0,a.Z)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(0===this._height||0===this._period)return t;if((0,o.l9)(t)){var e=this._processGeom(t.paths);if(e.length)return{paths:e}}if((0,o.oU)(t)){var i=this._processGeom(t.rings);if(i.length)return{rings:i}}t=this._inputGeometries.next()}return null}},{key:"_processGeom",value:function(t){var e,i=[],n=(0,r.Z)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(this._walker.init(a,this._pattern))switch(this._style){case v.zQ.Sinus:default:i.push(this._constructCurve(a,!1));break;case v.zQ.Square:i.push(this._constructSquare(a));break;case v.zQ.Triangle:i.push(this._constructTriangle(a));break;case v.zQ.Random:i.push(this._constructCurve(a,!0))}else i.push(a)}}catch(s){n.e(s)}finally{n.f()}return i}},{key:"_constructCurve",value:function(t,e){var i=new p,r=this._walker.calculatePathLength(t),n=Math.round(r/this._period);0===n&&(n=1);var a=16*n+1,s=r/n,o=this._period/16,l=1/a,h=2*Math.PI*r/s,u=2*Math.PI*Math.random(),c=2*Math.PI*Math.random(),f=2*Math.PI*Math.random(),v=.75-Math.random()/2,m=.75-Math.random()/2,d=new L;this._walker.curPointAndAngle(d),i.startPath(d.pt);for(var _=0;;){if(!this._walker.nextPointAndAngle(o,d)){i.lineTo(t[t.length-1]);break}var y=_,g=void 0;if(_+=l,e){var k=this._height/2*(1+.3*Math.sin(v*h*y+u));g=k*Math.sin(h*y+c),g+=k*Math.sin(m*h*y+f),g/=2}else g=.5*this._height*Math.sin(.5*h*y);i.lineTo([d.pt[0]-g*d.sa,d.pt[1]+g*d.ca])}return i.path()}},{key:"_constructSquare",value:function(t){var e=new p,i=this._walker.calculatePathLength(t);Math.round(i/this._period);for(var r=!0;;){var n=!1;if(this._walker.curPositionIsValid()){var a=new L;this._walker.curPointAndAngle(a);var s=new L;if(this._walker.nextPointAndAngle(this._period,s)){var o=new L;this._walker.nextPointAndAngle(this._period,o)&&(r?(e.startPath(a.pt),r=!1):e.lineTo(a.pt),e.lineTo([a.pt[0]-this._height/2*a.sa,a.pt[1]+this._height/2*a.ca]),e.lineTo([s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca]),e.lineTo([s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca]),e.lineTo([o.pt[0]+this._height/2*o.sa,o.pt[1]-this._height/2*o.ca]),n=!0)}}if(!n){e.lineTo(this._walker.getPathEnd());break}}return e.path()}},{key:"_constructTriangle",value:function(t){var e=new p,i=this._walker.calculatePathLength(t);Math.round(i/this._period);for(var r=!0;;){var n=!1;if(this._walker.curPositionIsValid()){var a=new L;this._walker.curPointAndAngle(a);var s=new L;if(this._walker.nextPointAndAngle(this._period/2,s)){var o=new L;this._walker.nextPointAndAngle(this._period,o)&&(this._walker.nextPosition(this._period/2)&&(r?(e.startPath(a.pt),r=!1):e.lineTo(a.pt),e.lineTo([s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca]),e.lineTo([o.pt[0]+this._height/2*o.sa,o.pt[1]-this._height/2*o.ca])),n=!0)}}if(!n){e.lineTo(this._walker.getPathEnd());break}}return e.path()}}]),t}(),tt=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new et(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();tt.instance=null;var et=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s,o;return(0,n.Z)(this,i),(o=e.call(this,t,!0,!0))._geometryWalker=new T,o._geometryWalker.updateTolerance(a),o._angleToLine=null===(s=r.angleToLine)||void 0===s||s,o._offset=(r.offset?r.offset:0)*a,o._originalEndings=r.endings,o._offsetAtEnd=(r.customEndingOffset?r.customEndingOffset:0)*a,o._position=-(r.offsetAlongLine?r.offsetAlongLine:0)*a,o._pattern=new N,o._pattern.init(r.placementTemplate,!1),o._pattern.scale(a),o._endings=o._originalEndings,o}return(0,a.Z)(i,[{key:"processPath",value:function(t){if(this._pattern.isEmpty())return null;var e;if(this.iteratePath)e=this._pattern.nextValue();else{this._originalEndings===v.JS.WithFullGap&&this.isClosed?this._endings=v.JS.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;var i,r=!0;switch(this._endings){case v.JS.NoConstraint:i=-this._position,i=this._adjustPosition(i),r=!1;break;case v.JS.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case v.JS.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case v.JS.WithMarkers:i=0;break;case v.JS.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(t,this._pattern,r))return null;this._pattern.reset();for(var n=0;i>n;)i-=n,n=this._pattern.nextValue();e=n-=i,this.iteratePath=!0}var a=new L;return this._geometryWalker.nextPointAndAngle(e,a)?this._endings===v.JS.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===v.JS.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca),this._angleToLine&&this.internalPlacement.setRotateCS(a.ca,a.sa),this.internalPlacement):(this.iteratePath=!1,null)}},{key:"_adjustPosition",value:function(t){var e=t/this._pattern.length();return(e-=Math.floor(e))*this._pattern.length()}}]),i}(l.v1),it=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new rt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();it.instance=null;var rt=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s;return(0,n.Z)(this,i),(s=e.call(this,t,!1,!0))._curveHelper=new d,s._angleToLine=void 0===r.angleToLine||r.angleToLine,s._offset=void 0!==r.offset?r.offset*a:0,s._type=r.extremityPlacement,s._position=void 0!==r.offsetAlongLine?r.offsetAlongLine*a:0,s._beginProcessed=!1,s}return(0,a.Z)(i,[{key:"processPath",value:function(t){var e;switch(this._type){case v.Tx.Both:default:this._beginProcessed?(e=this._atExtremities(t,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(e=this._atExtremities(t,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case v.Tx.JustBegin:e=this._atExtremities(t,this._position,!0);break;case v.Tx.JustEnd:e=this._atExtremities(t,this._position,!1);case v.Tx.None:}return e}},{key:"_atExtremities",value:function(t,e,i){var r=t.length;if(r<2)return null;for(var n,a=i?1:r-2,s=i?r:-1,o=i?1:-1,h=0,u=i?t[0]:t[r-1],c=a;c!==s;c+=o){n=u,u=t[c];var f=this._curveHelper.calculateLength(n,u);if(h+f>e){var v=(e-h)/f,m=this._curveHelper.getAngleCS(n,u,v),p=(0,M.Z)(m,2),d=p[0],_=p[1],y=(0,l.XV)(n,u,v);return this.internalPlacement.setTranslate(y[0]-this._offset*_,y[1]+this._offset*d),this._angleToLine&&this.internalPlacement.setRotateCS(-d,-_),this.internalPlacement}h+=f}return null}}]),i}(l.v1),nt=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new at(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();nt.instance=null;var at=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s;return(0,n.Z)(this,i),(s=e.call(this,t,!0,!0))._walker=new T,s._walker.updateTolerance(a),s._angleToLine=void 0===r.angleToLine||r.angleToLine,s._offset=void 0!==r.offset?r.offset*a:0,s._beginGap=void 0!==r.beginPosition?r.beginPosition*a:0,s._endGap=void 0!==r.endPosition?r.endPosition*a:0,s._flipFirst=void 0===r.flipFirst||r.flipFirst,s._pattern=new N,s._pattern.init(r.positionArray,!1,!1),s._subPathLen=0,s._posCount=s._pattern.size(),s._isFirst=!0,s._prevPos=0,s}return(0,a.Z)(i,[{key:"processPath",value:function(t){if(this._pattern.isEmpty())return null;var e;if(this.iteratePath){var i=this._pattern.nextValue()*this._subPathLen,r=this._beginGap+i;e=r-this._prevPos,this._prevPos=r}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=this._walker.calculatePathLength(t)-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();var n=this._pattern.nextValue()*this._subPathLen,a=this._beginGap+n;e=a-this._prevPos,this._prevPos=a,this.iteratePath=!0}var s=new L;if(!this._walker.nextPointAndAngle(e,s,w.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(s.pt[0]-this._offset*s.sa,s.pt[1]+this._offset*s.ca);var o,l,h=this._isFirst&&this._flipFirst;return this._angleToLine?(o=s.ca,l=s.sa):(o=1,l=0),h&&(o=-o,l=-l),this.internalPlacement.setRotateCS(o,l),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}]),i}(l.v1),st=i(84936),ot=i(84284);var lt=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new ht(t,e,i,r)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();lt.instance=null;var ht=function(){function t(e,i,r,a){var s,o;if((0,n.Z)(this,t),this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._stepX=Math.abs(null!==(s=i.stepX)&&void 0!==s?s:16)*r,this._stepY=Math.abs(null!==(o=i.stepY)&&void 0!==o?o:16)*r,0!==this._stepX&&0!==this._stepY&&e&&function(t){return void 0!==t.rings}(e)&&e.rings){var l;if(this._gridType=null!==(l=i.gridType)&&void 0!==l?l:v.bj.Fixed,this._gridType===v.bj.Random){var h,u,c=null!==(h=i.seed)&&void 0!==h?h:13;this._randomLCG=new st.Z(1*c),this._randomness=(null!==(u=i.randomness)&&void 0!==u?u:100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0}else{var f,m,p,d;if(this._randomness=0,this._gridAngle=null!==(f=i.gridAngle)&&void 0!==f?f:0,this._shiftOddRows=null!==(m=i.shiftOddRows)&&void 0!==m&&m,this._offsetX=(null!==(p=i.offsetX)&&void 0!==p?p:0)*r,this._offsetY=(null!==(d=i.offsetY)&&void 0!==d?d:0)*r,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginX=0,this._graphicOriginY=0,this._internalPlacement=new ot.u,this._calculateMinMax(e),this._geometry=e}}return(0,a.Z)(t,[{key:"next",value:function(){return this._geometry?this._nextInside():null}},{key:"_calculateMinMax",value:function(t){var e,i,n,a,s,o,l,h;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,s=o=Number.MAX_VALUE,l=h=-Number.MAX_VALUE;var u,c=(0,r.Z)(t.rings);try{for(c.s();!(u=c.n()).done;)for(var f=u.value,v=f?f.length:0,m=0;m<v;++m)e=f[m][0]-this._graphicOriginX-this._offsetX,i=f[m][1]-this._graphicOriginY-this._offsetY,n=this._cosAngle*e-this._sinAngle*i,a=this._sinAngle*e+this._cosAngle*i,s=Math.min(s,n),l=Math.max(l,n),o=Math.min(o,a),h=Math.max(h,a)}catch(p){c.e(p)}finally{c.f()}s+=this._graphicOriginX,l+=this._graphicOriginX,o+=this._graphicOriginY,h+=this._graphicOriginY,this._xMin=Math.round(s/this._stepX),this._xMax=Math.round(l/this._stepX),this._yMin=Math.round(o/this._stepY),this._yMax=Math.round(h/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1}},{key:"_nextInside",value:function(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}var t=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(t+=.5*this._stepX);var e=this._currentY*this._stepY+this._offsetY,i=void 0,r=void 0;return this._currentX++,this._gridType===v.bj.Random?(i=this._graphicOriginX+t+this._stepX*this._randomness*(.5-this._randomLCG.getFloat())*2/3,r=this._graphicOriginY+e+this._stepY*this._randomness*(.5-this._randomLCG.getFloat())*2/3):(i=this._graphicOriginX+this._cosAngle*t+this._sinAngle*e,r=this._graphicOriginY-this._sinAngle*t+this._cosAngle*e),this._internalPlacement.setTranslate(i,r),this._internalPlacement}}}]),t}(),ut=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new ct(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();ut.instance=null;var ct=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s;return(0,n.Z)(this,i),(s=e.call(this,t,!0,!0))._curveHelper=new d,s._angleToLine=void 0===r.angleToLine||r.angleToLine,s._offset=void 0!==r.offset?r.offset*a:0,s._relativeTo=r.relativeTo,s._position=void 0!==r.startPointOffset?r.startPointOffset*a:0,s._epsilon=.001*a,s}return(0,a.Z)(i,[{key:"processPath",value:function(t){var e=this._position;if(this._relativeTo===v.CS.SegmentMidpoint){for(this.iteratePath||(this._segmentCount=t.length,this._curSegment=1,this.iteratePath=!0);this._curSegment<this._segmentCount;){var i=this._curSegment;this._curSegment++;var r=t[i-1],n=t[i],a=this._curveHelper.calculateLength(r,n);if(!(a<this._epsilon)){var s=.5+this._position/a,o=this._curveHelper.getAngleCS(r,n,s),h=(0,M.Z)(o,2),u=h[0],c=h[1],f=(0,l.XV)(r,n,s);return this.internalPlacement.setTranslate(f[0]-this._offset*c,f[1]+this._offset*u),this._angleToLine&&this.internalPlacement.setRotateCS(u,c),this.internalPlacement}}return this.iteratePath=!1,null}this._relativeTo===v.CS.LineEnd&&(0,l.hh)(t);var m=this.onLine(t,e);return this._relativeTo===v.CS.LineEnd&&(0,l.hh)(t),m}},{key:"onLine",value:function(t,e){var i,r=!1;switch(this._relativeTo){case v.CS.LineMiddle:default:i=this._curveHelper.calculatePathLength(t)/2+e;break;case v.CS.LineBeginning:i=e;break;case v.CS.LineEnd:i=e,r=!0}for(var n,a=t.length,s=0,o=t[0],h=1;h<a;++h){n=o,o=t[h];var u=this._curveHelper.calculateLength(n,o);if(s+u>i){var c=(i-s)/u,f=this._curveHelper.getAngleCS(n,o,c),m=(0,M.Z)(f,2),p=m[0],d=m[1],_=(0,l.XV)(n,o,c),y=r?-this._offset:this._offset;return this.internalPlacement.setTranslate(_[0]-y*d,_[1]+y*p),this._angleToLine&&(r?this.internalPlacement.setRotateCS(-p,-d):this.internalPlacement.setRotateCS(p,d)),this.internalPlacement}s+=u}return null}}]),i}(l.v1),ft=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new vt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();ft.instance=null;var vt=function(t){(0,c.Z)(i,t);var e=(0,f.Z)(i);function i(t,r,a){var s;return(0,n.Z)(this,i),(s=e.call(this,t,!0,!0))._curveHelper=new d,s._angleToLine=void 0===r.angleToLine||r.angleToLine,s._offset=void 0!==r.offset?r.offset*a:0,s._endPoints=void 0===r.placeOnEndPoints||r.placeOnEndPoints,s._controlPoints=void 0===r.placeOnControlPoints||r.placeOnControlPoints,s._regularVertices=void 0===r.placeOnRegularVertices||r.placeOnRegularVertices,s._tags=[],s._tagIterator=0,s}return(0,a.Z)(i,[{key:"processPath",value:function(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;var e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);var i=e[0],r=e[1];if(0!==this._offset){var n=Math.cos(e[2]),a=Math.sin(e[2]);i-=this._offset*a,r+=this._offset*n}return this.internalPlacement.setTranslate(i,r),this._tagIterator++,this.internalPlacement}},{key:"_preparePath",value:function(t){this._tags.length=0,this._tagIterator=0;for(var e,i,r=(0,l.QK)(t),n=t.length-1,a=0,s=0,o=0,h=0,u=0;a<n;){e=t[++a-1],i=t[a];var c=(0,l.zv)(e),f=(0,l.zv)(i);(this._angleToLine||0!==this._offset)&&(h=this._curveHelper.getAngle(e,i,0)),1===a?r?(s=h,o=c):(this._endPoints||this._controlPoints&&1===c)&&this._tags.push([e[0],e[1],h]):1===c?this._controlPoints&&this._tags.push([e[0],e[1],mt(u,h)]):this._regularVertices&&this._tags.push([e[0],e[1],mt(u,h)]),(this._angleToLine||0!==this._offset)&&(u=this._curveHelper.getAngle(e,i,1)),a===n&&(r?1===f||1===o?this._controlPoints&&this._tags.push([i[0],i[1],mt(u,s)]):this._regularVertices&&this._tags.push([i[0],i[1],mt(u,s)]):(this._endPoints||this._controlPoints&&1===f)&&this._tags.push([i[0],i[1],u]))}this._tagIterator=0}}]),i}(l.v1);function mt(t,e){for(var i=Math.PI;Math.abs(e-t)>i+2e-15;)e-t>i?e-=2*i:e+=2*i;return(t+e)/2}var pt=i(93169),dt=i(4954),_t=i(92026),yt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt;(0,n.Z)(this,t),this._data=[],this._compare=e}return(0,a.Z)(t,[{key:"size",get:function(){return this._data.length}},{key:"enqueue",value:function(t){if(null!=t){var e=this._data,i=this._compare;e.push(t);for(var r=e.length-1>>>0,n=e[r];r>0;){var a=r-1>>1,s=e[a];if(!(i(s,n)<=0))break;e[a]=n,e[r]=s,r=a}}}},{key:"dequeue",value:function(){var t=this._data,e=this._compare,i=t[0],r=t.pop();if(0===t.length)return i;t[0]=r;for(var n,a,s=0,o=t.length,l=t[0],h=null;;){var u=2*s+1,c=2*s+2;if(h=null,u<o&&(e(n=t[u],l)>0&&(h=u)),c<o&&(a=t[c],(null===h&&e(a,l)<=0||null!==h&&e(a,n)<=0)&&(h=c)),null===h)break;t[s]=t[h],t[h]=l,s=h}return i}}]),t}(),gt=function(t,e){return t<e?-1:t>e?1:0},kt=i(69662),Pt=i(66504);function xt(t,e){var i,n=e.rings,a=0,s=(0,r.Z)(n);try{for(s.s();!(i=s.n()).done;)for(var o=i.value,l=o.length,h=1;h<l;++h){var u=o[h-1],c=o[h];u[1]>t[1]!=c[1]>t[1]&&((c[0]-u[0])*(t[1]-u[1])-(c[1]-u[1])*(t[0]-u[0])>0?a++:a--)}}catch(f){s.e(f)}finally{s.f()}return 0!==a}function Mt(t,e,i){if(i&&xt(t,e))return{coord:t,distance:0};var n,a=1/0,s=0,o=0,l=[0,0],h=e.rings,u=(0,r.Z)(h);try{for(u.s();!(n=u.n()).done;){var c=n.value;if(!(c.length<2))for(var f=0;f<c.length-1;f++){(0,kt.Tx)(l,t,c,f);var v=Zt(t,l);v<a&&(a=v,s=l[0],o=l[1])}}}catch(m){u.e(m)}finally{u.f()}return{coord:[s,o],distance:Math.sqrt(a)}}function bt(t,e,i,n){var a,s=[e,0],o=1/0,l=1/0,h=!1,u=!1,c=[[e,n[1]-1],[e,n[3]+1]],f=[0,0],v=[0,0],m=[0,0],p=[[0,0],[0,0]],d=(0,B.Ue)(),_=t.rings,y=(0,r.Z)(_);try{for(y.s();!(a=y.n()).done;){var g=a.value;if(!(g.length<2))for(var k=1;k<g.length;k++)if(p[0][0]=g[k-1][0],p[0][1]=g[k-1][1],p[1][0]=g[k][0],p[1][1]=g[k][1],null!==St(d,p)&&(v[0]=c[0][0],v[1]=c[0][1],m[0]=c[1][0],m[1]=c[1][1],0!==Ct(d,v,m)&&(0,Pt.UT)(c[0],c[1],p[0],p[1],f))){var P=f[1];o>l?P<o&&(o=P,h=!0):P<l&&(l=P,u=!0)}}}catch(x){y.e(x)}finally{y.f()}return h&&u?s[1]=(o+l)/2:s[0]=s[1]=NaN,s}function St(t,e){if(e.length<2)return null;t||(t=(0,B.Ue)());var i=(0,M.Z)(e[0],2),r=i[0],n=i[1],a=(0,M.Z)(e[1],2),s=a[0],o=a[1];return t[0]=Math.min(r,s),t[1]=Math.min(n,o),t[2]=Math.max(r,s),t[3]=Math.max(n,o),t}function Ct(t,e,i){var r=wt(e,t),n=wt(i,t),a=t[0],s=t[1],o=t[2],l=t[3];if(r&n)return 0;if(!(r|n))return 4;var h=(r?1:0)|(n?2:0);do{var u=i[0]-e[0],c=i[1]-e[1];if(u>c)3&r?(1&r?(e[1]+=c*(a-e[0])/u,e[0]=a):(e[1]+=c*(o-e[0])/u,e[0]=o),r=wt(e,t)):3&n?(1&n?(i[1]+=c*(a-i[0])/u,i[0]=a):(i[1]+=c*(o-i[0])/u,i[0]=o),n=wt(i,t)):r?(4&r?(e[0]+=u*(s-e[1])/c,e[1]=s):(e[0]+=u*(l-e[1])/c,e[1]=l),r=wt(e,t)):(4&n?(i[0]+=u*(s-i[1])/c,i[1]=s):(i[0]+=u*(l-i[1])/c,i[1]=l),n=wt(i,t));else if(12&r?(4&r?(e[0]+=u*(s-e[1])/c,e[1]=s):(e[0]+=u*(l-e[1])/c,e[1]=l),r=wt(e,t)):12&n?(4&n?(i[0]+=u*(s-i[1])/c,i[1]=s):(i[0]+=u*(l-i[1])/c,i[1]=l),n=wt(i,t)):r?(1&r?(e[1]+=c*(a-e[0])/u,e[0]=a):(e[1]+=c*(o-e[0])/u,e[0]=o),r=wt(e,t)):(1&n?(i[1]+=c*(a-i[0])/u,i[0]=a):(i[1]+=c*(o-i[0])/u,i[0]=o),n=wt(i,t)),r&n)return 0}while(r|n);return h}function wt(t,e){return(t[0]<e[0]?1:0)|(t[0]>e[2]?1:0)<<1|(t[1]<e[1]?1:0)<<2|(t[1]>e[3]?1:0)<<3}function It(t,e,i){return t+(e-t)*i}function Zt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function Nt(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;var i=isNaN(t),r=isNaN(e);return i<r?-1:i>r?1:0}var Lt=(0,a.Z)((function t(e,i,r,a){(0,n.Z)(this,t),this.x=e,this.y=i,this.cellSize=r,this.distancefromCellCenter=(0,kt.ko)(e,i,a),this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2}));var At=function(){function t(){(0,n.Z)(this,t)}return(0,a.Z)(t,[{key:"execute",value:function(t,e,i,r){return new Tt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();At.instance=null;var Tt=function(){function t(e,i,r){(0,n.Z)(this,t),this._geometry=e,this._offsetX=void 0!==i.offsetX?i.offsetX*r:0,this._offsetY=void 0!==i.offsetY?i.offsetY*r:0,this._method=void 0!==i.method?i.method:v.Lh.OnPolygon,this._internalPlacement=new ot.u}return(0,a.Z)(t,[{key:"next",value:function(){var t=this._geometry;return this._geometry=null,t&&function(t){return void 0!==t.rings}(t)?this._polygonCenter(t):null}},{key:"_polygonCenter",value:function(t){var e=!1;switch(this._method){case v.Lh.CenterOfMass:var i=(0,dt.NA)(t);i&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),e=!0);break;case v.Lh.BoundingBoxCenter:var r=(0,B.Ue)();(0,V.$P)(r,t),r&&(this._internalPlacement.setTranslate((r[2]+r[0])/2+this._offsetX,(r[3]+r[1])/2+this._offsetY),e=!0);break;case v.Lh.OnPolygon:default:var n;n=(0,pt.Z)("polylabel-placement-enabled")?function(t){if(!t||!t.rings||0===t.rings.length)return null;var e=(0,V.lC)((0,B.Ue)(),t.rings[0]);if(!e)return null;var i=e[2]-e[0],r=e[3]-e[1];if(0===i||0===r)return[e[0]+i/2,e[1]+r/2];var n=Math.max(Math.min(i,r)/100,1),a=new yt((function(t,e){return e.maxDistanceToPolygon-t.maxDistanceToPolygon})),s=Math.min(i,r),o=s/2,l=0,h=0;for(l=e[0];l<e[2];l+=s)for(h=e[1];h<e[3];h+=s)a.enqueue(new Lt(l+o,h+o,o,t));var u=(0,dt.a)(t.rings,!1);if(null===u)return null;for(var c,f=new Lt(u[0],u[1],0,t);a.size>0;)(c=(0,_t.Wg)(a.dequeue())).distancefromCellCenter>f.distancefromCellCenter&&(f=c),c.maxDistanceToPolygon-f.distancefromCellCenter<=n||(o=c.cellSize/2,a.enqueue(new Lt(c.x-o,c.y-o,o,t)),a.enqueue(new Lt(c.x+o,c.y-o,o,t)),a.enqueue(new Lt(c.x-o,c.y+o,o,t)),a.enqueue(new Lt(c.x+o,c.y+o,o,t)));return[f.x,f.y]}(t):function(t){var e=t.rings;if(!e||0===e.length)return null;var i=(0,V.$P)((0,B.Ue)(),t);if(!i)return null;for(var r=4*(Math.abs(i[0])+Math.abs(i[2])+Math.abs(i[1])+Math.abs(i[3])+1)*222045e-19,n=0,a=0,s=0;s<e.length;s++){var o=(0,kt.Sm)(e[s]);o>a&&(a=o,n=s)}if(Math.abs(a)<=2*r*r){var l=(0,V.lC)((0,B.Ue)(),e[n]);return[(l[0]+l[2])/2,(l[1]+l[3])/2]}var h=(0,dt.DS)(e[n],!1,(0,B.Ue)());if(null===h)return null;if(1===e.length&&e[0].length<4)return h;var u=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],c=[NaN,NaN,NaN,NaN],f=[NaN,NaN,NaN,NaN],v=!1,m=Mt(h,t,!0);0===m.distance&&(v=!0,u[0][0]=h[0],u[0][1]=h[1],m=Mt(h,t,!1)),c[0]=m.distance,f[0]=0;var p=[NaN,NaN],d=!1,_=.25,y=-1,g=(0,V.lC)((0,B.Ue)(),e[n]),k=NaN;do{if(k=NaN,u[1]=bt(t,It(g[0],g[2],_),0,i),isNaN(u[1][0])||isNaN(u[1][1])||(k=(m=Mt(u[1],t,!1)).distance),!isNaN(k)&&k>r&&xt(u[1],t))d=!0,c[1]=k,f[1]=Zt(u[1],h);else if(!isNaN(k)&&k>y&&(y=k,p[0]=u[1][0],p[1]=u[1][1]),(_-=.01)<.1){if(!(y>=0))break;d=!0,c[1]=y,u[1][0]=p[0],u[1][1]=p[1],f[1]=Zt(u[1],h)}}while(!d);d=!1,_=.5,y=-1;var P=.01,x=1;do{if(k=NaN,u[2]=bt(t,It(g[0],g[2],_),0,i),isNaN(u[2][0])||isNaN(u[2][1])||(k=(m=Mt(u[2],t,!1)).distance),!isNaN(k)&&k>r&&xt(u[2],t))d=!0,c[2]=k,f[2]=Zt(u[2],h);else if(!isNaN(k)&&k>y)y=k,p[0]=u[2][0],p[1]=u[2][1];else if(k>y&&(y=k,p[0]=u[2][0],p[1]=u[2][1]),_=.5+P*x,P+=.01,x*=-1,_<.3||_>.7){if(!(y>=0))break;d=!0,c[2]=y,u[2][0]=p[0],u[2][1]=p[1],f[2]=Zt(u[2],h)}}while(!d);d=!1,_=.75,y=-1;do{if(k=NaN,u[3]=bt(t,It(g[0],g[2],_),0,i),isNaN(u[3][0])||isNaN(u[3][1])||(k=(m=Mt(u[3],t,!1)).distance),!isNaN(k)&&k>r&&xt(u[3],t))d=!0,c[3]=k,f[3]=Zt(u[3],h);else if(k>y&&(y=k,p[0]=u[3][0],p[1]=u[3][1]),(_+=.01)>.9){if(!(y>=0))break;d=!0,c[3]=y,u[3][0]=p[0],u[3][1]=p[1],f[3]=Zt(u[3],h)}}while(!d);for(var M,b=[0,1,2,3],S=v?0:1,C=S;C<4;C++)for(var w=S;w<3;w++){var I=f[w],Z=f[w+1];Nt(I,Z)>0&&(M=b[w],b[w]=b[w+1],b[w+1]=M,f[w]=Z,f[w+1]=I)}for(var N=S,L=0,A=0,T=S;T<4;T++){switch(T){case 0:A=2*c[b[T]];break;case 1:A=1.66666666*c[b[T]];break;case 2:A=1.33333333*c[b[T]];break;case 3:A=c[b[T]]}A>L&&(L=A,N=b[T])}return u[N]}(t),null!==n&&(this._internalPlacement.setTranslate(n[0]+this._offsetX,n[1]+this._offsetY),e=!0)}return e?this._internalPlacement:null}}]),t}();function zt(t){if(!t)return null;switch(t.type){case"CIMGeometricEffectAddControlPoints":return h.local();case"CIMGeometricEffectArrow":return g.local();case"CIMGeometricEffectBuffer":return P.local();case"CIMGeometricEffectControlMeasureLine":return b.local();case"CIMGeometricEffectCut":return C.local();case"CIMGeometricEffectDashes":return z.local();case"CIMGeometricEffectDonut":return O.local();case"CIMGeometricEffectJog":return F.local();case"CIMGeometricEffectMove":return H.local();case"CIMGeometricEffectOffset":return D.local();case"CIMGeometricEffectReverse":return U.local();case"CIMGeometricEffectRotate":return J.local();case"CIMGeometricEffectScale":return j.local();case"CIMGeometricEffectWave":return Q.local()}return null}function Et(t){if(!t)return null;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":return tt.local();case"CIMMarkerPlacementAtExtremities":return it.local();case"CIMMarkerPlacementAtRatioPositions":return nt.local();case"CIMMarkerPlacementInsidePolygon":return lt.local();case"CIMMarkerPlacementOnLine":return ut.local();case"CIMMarkerPlacementOnVertices":return ft.local();case"CIMMarkerPlacementPolygonCenter":return At.local()}return null}},84284:function(t,e,i){i.d(e,{u:function(){return a}});var r=i(15671),n=i(43144),a=function(){function t(){(0,r.Z)(this,t),this.setIdentity()}return(0,n.Z)(t,[{key:"getAngle",value:function(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}},{key:"setIdentity",value:function(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}},{key:"setTranslate",value:function(t,e){this.tx=t,this.ty=e}},{key:"setTranslateZ",value:function(t){this.tz=t}},{key:"setRotateCS",value:function(t,e){this.rz=void 0,this.rzCos=t,this.rzSin=e}},{key:"setRotate",value:function(t){this.rz=t,this.rzCos=void 0,this.rzSin=void 0}},{key:"setRotateY",value:function(t){this.ry=t}},{key:"setScale",value:function(t){this.s=t}},{key:"setMeasure",value:function(t){this.m=t}}]),t}()},66726:function(t,e,i){i.d(e,{cD:function(){return X},uQ:function(){return G},Tu:function(){return H},zA:function(){return R},x1:function(){return U},et:function(){return B},g:function(){return W}});var r=i(11752),n=i(61120),a=i(60136),s=i(29388),o=i(29439),l=i(37762),h=i(15671),u=i(43144),c=i(75746),f=i(82272),v=i(84652),m=i(32718),p=i(92026),d=i(13005),_=i(17842),y=i(65156),g=i(376),k=i(4954),P=i(77981),x=i(35747),M=i(51995),b=function(){function t(){(0,h.Z)(this,t)}return(0,u.Z)(t,[{key:"applyColorSubstituition",value:function(t,e){if(!e)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));var i=t.width,r=t.height,n=this._rasterizationCanvas,a=n.getContext("2d");t!==n&&(n.width=i,n.height=r,a.drawImage(t,0,0,i,r));var s=a.getImageData(0,0,i,r).data;if(e){var h,u=(0,l.Z)(e);try{for(u.s();!(h=u.n()).done;){var c=h.value;if(c&&c.oldColor&&4===c.oldColor.length&&c.newColor&&4===c.newColor.length){var f=(0,o.Z)(c.oldColor,4),v=f[0],m=f[1],p=f[2],d=f[3],_=(0,o.Z)(c.newColor,4),y=_[0],g=_[1],k=_[2],P=_[3];if(v===y&&m===g&&p===k&&d===P)continue;for(var x=0;x<s.length;x+=4)v===s[x]&&m===s[x+1]&&p===s[x+2]&&d===s[x+3]&&(s[x]=y,s[x+1]=g,s[x+2]=k,s[x+3]=P)}}}catch(b){u.e(b)}finally{u.f()}}var M=new ImageData(s,i,r);return a.putImageData(M,0,0),n}},{key:"tintImageData",value:function(t,e){if(!e)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));var i=t.width,r=t.height,n=this._rasterizationCanvas,a=n.getContext("2d");t!==n&&(n.width=i,n.height=r,a.drawImage(t,0,0,i,r));for(var s=a.getImageData(0,0,i,r),o=new Uint8Array(s.data),l=new M.Z(e),h=[l.r/255,l.g/255,l.b/255,l.a],u=0;u<o.length;u+=4)o[u+0]*=h[0],o[u+1]*=h[1],o[u+2]*=h[2],o[u+3]*=h[3];var c=new ImageData(new Uint8ClampedArray(o.buffer),i,r);return a.putImageData(c,0,0),n}}]),t}(),S=i(81434),C=i(84284),w=i(48202);function I(t){var e=t.getFrame(0);if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return e;var i=document.createElement("canvas");i.width=t.width,i.height=t.height;var r=i.getContext("2d");return e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0),i}var Z=i(691),N=i(22532),L=i(31027),A=i(38999),T=i(94109),z=i(47975),E=Math.PI/180,O=m.Z.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),R=function(){function t(e){(0,h.Z)(this,t),this._t=e}return(0,u.Z)(t,[{key:"clone",value:function(){return new t(this._t.slice())}},{key:"transform",value:function(t){var e=this._t;return[e[0]*t[0]+e[1]*t[1]+e[2],e[3]*t[0]+e[4]*t[1]+e[5]]}},{key:"scale",value:function(t,e){var i=this._t;return i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=e,i[4]*=e,i[5]*=e,this}},{key:"scaleRatio",value:function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}},{key:"translate",value:function(t,e){var i=this._t;return i[2]+=t,i[5]+=e,this}},{key:"rotate",value:function(e){return t.multiply(this,t.createRotate(e),this)}},{key:"angle",value:function(){var t=this._t[0],e=this._t[3],i=Math.sqrt(t*t+e*e);return[t/i,e/i]}},{key:"invert",value:function(){var e=this._t,i=e[0]*e[4]-e[1]*e[3];if(0===i)return new t([0,0,0,0,0,0]);i=1/i;var r=(e[1]*e[5]-e[2]*e[4])*i,n=(e[2]*e[3]-e[0]*e[5])*i;return new t([e[4]*i,-e[1]*i,r,-e[3]*i,e[0]*i,n])}}],[{key:"createIdentity",value:function(){return new t([1,0,0,0,1,0])}},{key:"createScale",value:function(e,i){return new t([e,0,0,0,i,0])}},{key:"createTranslate",value:function(e,i){return new t([0,0,e,0,0,i])}},{key:"createRotate",value:function(e){var i=Math.cos(e),r=Math.sin(e);return new t([i,-r,0,r,i,0])}},{key:"multiply",value:function(t,e,i){var r=t._t,n=e._t,a=r[0]*n[0]+r[3]*n[1],s=r[1]*n[0]+r[4]*n[1],o=r[2]*n[0]+r[5]*n[1]+n[2],l=r[0]*n[3]+r[3]*n[4],h=r[1]*n[3]+r[4]*n[4],u=r[2]*n[3]+r[5]*n[4]+n[5],c=i._t;return c[0]=a,c[1]=s,c[2]=o,c[3]=l,c[4]=h,c[5]=u,i}}]),t}(),F=function(){function t(e,i){(0,h.Z)(this,t),this._resourceManager=e,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new d.Z(C.u,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(i||R.createIdentity()),this._sizeTransfos.push(i?i.scaleRatio():1)}return(0,u.Z)(t,[{key:"setTransform",value:function(t,e){this._transfos=[t||R.createIdentity()],this._sizeTransfos=[e||(t?t.scaleRatio():1)]}},{key:"setGeomUnitsPerPoint",value:function(t){this._geomUnitsPerPoint=t}},{key:"transformPt",value:function(t){return this._transfos[this._transfos.length-1].transform(t)}},{key:"transformSize",value:function(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}},{key:"reverseTransformPt",value:function(t){return this._transfos[this._transfos.length-1].invert().transform(t)}},{key:"reverseTransformSize",value:function(t){return t/this._sizeTransfos[this._sizeTransfos.length-1]}},{key:"getTransformAngle",value:function(){return this._transfos[this._transfos.length-1].angle()}},{key:"geomUnitsPerPoint",value:function(){return this.isEmbedded()?1:this._geomUnitsPerPoint}},{key:"isEmbedded",value:function(){return this._transfos.length>1}},{key:"back",value:function(){return this._transfos[this._transfos.length-1]}},{key:"push",value:function(t,e){var i=e?t.scaleRatio():1;R.multiply(t,this.back(),t),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*i)}},{key:"pop",value:function(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}},{key:"drawSymbol",value:function(t,e,i){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(t,e);break;case"CIMTextSymbol":this.drawTextSymbol(t,e,i)}}},{key:"drawMultiLayerSymbol",value:function(t,e){if(t){var i=t.symbolLayers;if(i){var r=t.effects;if(r&&r.length>0){var n=this.executeEffects(r,e);if(n)for(var a=n.next();a;)this.drawSymbolLayers(i,a),a=n.next()}else this.drawSymbolLayers(i,e)}}}},{key:"executeEffects",value:function(t,e){var i,r=this._resourceManager.geometryEngine,n=new x.M(e),a=(0,l.Z)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=(0,S.h)(s);o&&(n=o.execute(n,s,this.geomUnitsPerPoint(),r))}}catch(h){a.e(h)}finally{a.f()}return n}},{key:"drawSymbolLayers",value:function(t,e){for(var i=t.length;i--;){var r=t[i];if(r&&!1!==r.enable){var n=r.effects;if(n&&n.length>0){var a=this.executeEffects(n,e);if(a)for(var s=null;(s=a.next())&&(this.drawSymbolLayer(r,s),!this._earlyReturn););}else this.drawSymbolLayer(r,e);if(this._earlyReturn)return}}}},{key:"drawSymbolLayer",value:function(t,e){switch(t.type){case"CIMSolidFill":this.drawSolidFill(e,t.color);break;case"CIMHatchFill":this.drawHatchFill(e,t);break;case"CIMPictureFill":this.drawPictureFill(e,t);break;case"CIMGradientFill":this.drawGradientFill(e,t);break;case"CIMSolidStroke":this.drawSolidStroke(e,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(e,t);break;case"CIMGradientStroke":this.drawGradientStroke(e,t);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(t,e)}}},{key:"drawHatchFill",value:function(t,e){var i=this._buildHatchPolyline(e,t,this.geomUnitsPerPoint());i&&(this.pushClipPath(t),this.drawMultiLayerSymbol(e.lineSymbol,i),this.popClipPath())}},{key:"drawPictureFill",value:function(t,e){}},{key:"drawGradientFill",value:function(t,e){}},{key:"drawPictureStroke",value:function(t,e){}},{key:"drawGradientStroke",value:function(t,e){}},{key:"drawMarkerLayer",value:function(t,e){var i=t.markerPlacement;if(i){var r=(0,S.W)(i);if(r){var n="CIMMarkerPlacementInsidePolygon"===i.type||"CIMMarkerPlacementPolygonCenter"===i.type&&i.clipAtBoundary;n&&this.pushClipPath(e);var a=r.execute(e,i,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine);if(a)for(var s=null;(s=a.next())&&(this.drawMarker(t,s),!this._earlyReturn););n&&this.popClipPath()}}else{var h,u,c=this._placementPool.acquire();if((0,P.wp)(e))c.tx=e.x,c.ty=e.y,this.drawMarker(t,c);else if((0,P.oU)(e))h=(0,k.tO)(e),u=(0,o.Z)(h,2),c.tx=u[0],c.ty=u[1],this.drawMarker(t,c);else{var f,v=(0,l.Z)(e.points);try{for(v.s();!(f=v.n()).done;){var m=f.value;if(c.tx=m[0],c.ty=m[1],this.drawMarker(t,c),this._earlyReturn)break}}catch(p){v.e(p)}finally{v.f()}}this._placementPool.release(c)}}},{key:"drawMarker",value:function(t,e){switch(t.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(t,e);break;case"CIMVectorMarker":this.drawVectorMarker(t,e)}}},{key:"drawPictureMarker",value:function(t,e){var i,r,n,a,s;if(t){var o=this._resourceManager.getResource(t.url),l=null!==(i=t.size)&&void 0!==i?i:10;if(!((0,p.Wi)(o)||l<=0)){var h=o.width,u=o.height;if(h&&u){var c=h/u,f=null!==(r=t.scaleX)&&void 0!==r?r:1,v=R.createIdentity(),m=t.anchorPoint;if(m){var d=m.x,_=m.y;"Absolute"!==t.anchorPointUnits&&(d*=l*c*f,_*=l),v.translate(-d,-_)}var y=null!==(n=t.rotation)&&void 0!==n?n:0;t.rotateClockwise&&(y=-y),this._mapRotation&&(y+=this._mapRotation),y&&v.rotate(y*E);var g=null!==(a=t.offsetX)&&void 0!==a?a:0,k=null!==(s=t.offsetY)&&void 0!==s?s:0;if(g||k){if(this._mapRotation){var P=E*this._mapRotation,x=Math.cos(P),M=Math.sin(P),b=g*M+k*x;g=g*x-k*M,k=b}v.translate(g,k)}var S=this.geomUnitsPerPoint();1!==S&&v.scale(S,S);var C=e.getAngle();C&&v.rotate(C),v.translate(e.tx,e.ty),this.push(v,!1),this.drawImage(t,l),this.pop()}}}}},{key:"drawVectorMarker",value:function(t,e){var i,r,n,a;if(t){var s=t.markerGraphics;if(s){var o=null!==(i=t.size)&&void 0!==i?i:10,h=t.frame,u=h?h.ymax-h.ymin:0,c=o&&u?o/u:1,f=R.createIdentity();h&&f.translate(.5*-(h.xmax+h.xmin),.5*-(h.ymax+h.ymin));var v=t.anchorPoint;if(v){var m=v.x,p=v.y;"Absolute"!==t.anchorPointUnits?h&&(m*=h.xmax-h.xmin,p*=h.ymax-h.ymin):(m/=c,p/=c),f.translate(-m,-p)}1!==c&&f.scale(c,c);var d=null!==(r=t.rotation)&&void 0!==r?r:0;t.rotateClockwise&&(d=-d),this._mapRotation&&(d+=this._mapRotation),d&&f.rotate(d*E);var _=null!==(n=t.offsetX)&&void 0!==n?n:0,y=null!==(a=t.offsetY)&&void 0!==a?a:0;if(_||y){if(this._mapRotation){var g=E*this._mapRotation,k=Math.cos(g),P=Math.sin(g),x=_*P+y*k;_=_*k-y*P,y=x}f.translate(_,y)}var M=this.geomUnitsPerPoint();1!==M&&f.scale(M,M);var b=e.getAngle();b&&f.rotate(b),f.translate(e.tx,e.ty),this.push(f,t.scaleSymbolsProportionally);var S,C=(0,l.Z)(s);try{for(C.s();!(S=C.n()).done;){var w=S.value;if(w&&w.symbol&&w.geometry||O.error("Invalid marker graphic",w),this.drawSymbol(w.symbol,w.geometry,w.textString),this._earlyReturn)break}}catch(I){C.e(I)}finally{C.f()}this.pop()}}}},{key:"drawTextSymbol",value:function(t,e,i){var r,n,a,s;if(t&&(0,P.wp)(e)&&!((null!==(r=t.height)&&void 0!==r?r:10)<=0)){var o=R.createIdentity(),l=null!==(n=t.angle)&&void 0!==n?n:0;(l=-l)&&o.rotate(l*E);var h=null!==(a=t.offsetX)&&void 0!==a?a:0,u=null!==(s=t.offsetY)&&void 0!==s?s:0;(h||u)&&o.translate(h,u);var c=this.geomUnitsPerPoint();1!==c&&o.scale(c,c),o.translate(e.x,e.y),this.push(o,!1),this.drawText(t,i),this.pop()}}},{key:"_buildHatchPolyline",value:function(t,e,i){var r=(void 0!==t.separation?t.separation:4)*i,n=void 0!==t.rotation?t.rotation:0;if(0===r)return null;r<0&&(r=-r);for(var a=0,s=.5*r;a>s;)a-=r;for(;a<-s;)a+=r;var o=(0,y.Ue)();(0,g.$P)(o,e),o[0]-=s,o[1]-=s,o[2]+=s,o[3]+=s;for(var l=[[o[0],o[1]],[o[0],o[3]],[o[2],o[3]],[o[2],o[1]]];n>180;)n-=180;for(;n<0;)n+=180;var h,u,c,f,v=Math.cos(n*E),m=Math.sin(n*E),p=-r*m,d=r*v;a=(void 0!==t.offsetX?t.offsetX*i:0)*m-(void 0!==t.offsetY?t.offsetY*i:0)*v,h=c=Number.MAX_VALUE,u=f=-Number.MAX_VALUE;for(var _=0,k=l;_<k.length;_++){var P=k[_],x=P[0],M=P[1],b=v*x+m*M,S=-m*x+v*M;h=Math.min(h,b),c=Math.min(c,S),u=Math.max(u,b),f=Math.max(f,S)}for(var C=v*h-m*(c=Math.floor(c/r)*r)-p*a/r,w=m*h+v*c-d*a/r,I=v*u-m*c-p*a/r,Z=m*u+v*c-d*a/r,N=1+Math.round((f-c)/r),L=[],A=0;A<N;A++)C+=p,w+=d,I+=p,Z+=d,L.push([[C,w],[I,Z]]);return{paths:L}}}]),t}(),G=function(t){(0,a.Z)(i,t);var e=(0,s.Z)(i);function i(t,r){var n;return(0,h.Z)(this,i),(n=e.call(this,t,r)).reset(),n}return(0,u.Z)(i,[{key:"reset",value:function(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}},{key:"envelope",value:function(){return new Z.Z(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}},{key:"bounds",value:function(){return(0,y.al)(this._xmin,this._ymin,this._xmax,this._ymax)}},{key:"drawSolidFill",value:function(t){if(t&&!(this._clipCount>0))if((0,P.oU)(t))this._processPath(t.rings,0);else if((0,P.l9)(t))this._processPath(t.paths,0);else if((0,P.YX)(t)){var e=Y(t);e&&this._processPath(e.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}},{key:"drawSolidStroke",value:function(t,e,i){if(t&&!(this._clipCount>0)){var r=.5*this.transformSize(i);if((0,P.oU)(t))this._processPath(t.rings,r);else if((0,P.l9)(t))this._processPath(t.paths,r);else if((0,P.YX)(t)){var n=Y(t);n&&this._processPath(n.rings,r)}else console.error("drawSolidStroke unexpected geometry type!")}}},{key:"drawMarkerLayer",value:function(t,e){(0,P.oU)(e)&&t.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._processPath(e.rings,0):(0,r.Z)((0,n.Z)(i.prototype),"drawMarkerLayer",this).call(this,t,e)}},{key:"drawHatchFill",value:function(t,e){this.drawSolidFill(t)}},{key:"drawPictureFill",value:function(t,e){this.drawSolidFill(t)}},{key:"drawGradientFill",value:function(t,e){this.drawSolidFill(t)}},{key:"drawPictureStroke",value:function(t,e){this.drawSolidStroke(t,null,e.width)}},{key:"drawGradientStroke",value:function(t,e){this.drawSolidStroke(t,null,e.width)}},{key:"pushClipPath",value:function(t){this.drawSolidFill(t),this._clipCount++}},{key:"popClipPath",value:function(){this._clipCount--}},{key:"drawImage",value:function(t,e){var i,r=t.url,n=null!==(i=t.scaleX)&&void 0!==i?i:1,a=n*e,s=e,o=this._resourceManager.getResource(r);!e&&(0,p.pC)(o)&&(a=n*o.width,s=o.height),this._merge(this.transformPt([-a/2,-s/2]),0),this._merge(this.transformPt([-a/2,s/2]),0),this._merge(this.transformPt([a/2,-s/2]),0),this._merge(this.transformPt([a/2,s/2]),0)}},{key:"drawText",value:function(t,e){if(e&&0!==e.length){this._textRasterizer||(this._textRasterizer=new N.Z);var i=V(t),r=this._textRasterizer.computeTextSize(e,i),n=(0,o.Z)(r,2),a=n[0],s=n[1],l=0;switch(t.horizontalAlignment){case"Left":l=a/2;break;case"Right":l=-a/2}var h=0;switch(t.verticalAlignment){case"Bottom":h=s/2;break;case"Top":h=-s/2;break;case"Baseline":h=s/6}this._merge(this.transformPt([-a/2+l,-s/2+h]),0),this._merge(this.transformPt([-a/2+l,s/2+h]),0),this._merge(this.transformPt([a/2+l,-s/2+h]),0),this._merge(this.transformPt([a/2+l,s/2+h]),0)}}},{key:"_processPath",value:function(t,e){if(t){var i,r=(0,l.Z)(t);try{for(r.s();!(i=r.n()).done;){var n=i.value,a=n?n.length:0;if(a>1){this._merge(this.transformPt(n[0]),e);for(var s=1;s<a;s++)this._merge(this.transformPt(n[s]),e)}}}catch(o){r.e(o)}finally{r.f()}}}},{key:"_merge",value:function(t,e){t[0]-e<this._xmin&&(this._xmin=t[0]-e),t[0]+e>this._xmax&&(this._xmax=t[0]+e),t[1]-e<this._ymin&&(this._ymin=t[1]-e),t[1]+e>this._ymax&&(this._ymax=t[1]+e)}}]),i}(F),H=function(t){(0,a.Z)(i,t);var e=(0,s.Z)(i);function i(){var t;return(0,h.Z)(this,i),(t=e.apply(this,arguments))._searchPoint=[0,0],t._searchDistPoint=0,t}return(0,u.Z)(i,[{key:"hitTest",value:function(t,e,i,r,n,a){var s=a*(0,_.F2)(1);this.setTransform(),this.setGeomUnitsPerPoint(s),this._searchPoint=[(t[0]+t[2])/2,(t[1]+t[3])/2],this._searchDistPoint=(t[2]-t[0])/2/s,this._textInfo=r;var o=e&&("CIMPointSymbol"===e.type&&"Map"!==e.angleAlignment||"CIMTextSymbol"===e.type);return this._mapRotation=o?n:0,this._earlyReturn=!1,this.drawSymbol(e,i),this._earlyReturn}},{key:"drawSolidFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawHatchFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawPictureFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawGradientFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawSolidStroke",value:function(t,e,i,r,n,a){this._hitTestStroke(t,i)}},{key:"drawPictureStroke",value:function(t,e){this._hitTestStroke(t,e.width)}},{key:"drawGradientStroke",value:function(t,e){this._hitTestStroke(t,e.width)}},{key:"drawMarkerLayer",value:function(t,e){t.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._hitTestFill(e):(0,r.Z)((0,n.Z)(i.prototype),"drawMarkerLayer",this).call(this,t,e)}},{key:"pushClipPath",value:function(t){}},{key:"popClipPath",value:function(){}},{key:"drawImage",value:function(t,e){var i,r=t.url,n=null!==(i=t.scaleX)&&void 0!==i?i:1,a=this._resourceManager.getResource(r);if(!(0,p.Wi)(a)&&0!==a.height&&0!==e){var s=e*this.geomUnitsPerPoint(),o=s*n*(a.width/a.height),l=this.reverseTransformPt(this._searchPoint),h=this._searchDistPoint;Math.abs(l[0])<o/2+h&&Math.abs(l[1])<s/2+h&&(this._earlyReturn=!0)}}},{key:"drawText",value:function(t,e){var i,r,n=this._textInfo;if(n){var a=n.get(t);if(a){var s=a.text,o=a.mosaicItem;if(o&&0!==o.glyphMosaicItems.length){var h,u=null!==(i=t.height)&&void 0!==i?i:10,f=B(t.lineGapType,null!==(r=t.lineGap)&&void 0!==r?r:0,u),v=(0,c.E)(s)[1],m=o.glyphMosaicItems,p=(0,z.Nr)(m,v,{scale:u/T.Ex,angle:0,xOffset:0,yOffset:0,hAlign:U(t.horizontalAlignment),vAlign:W(t.verticalAlignment),maxLineWidth:512,lineHeight:T.xm*Math.max(.25,Math.min(f||1,4)),decoration:t.font.decoration||"none",isCIM:!0}),d=this.reverseTransformPt(this._searchPoint),_=d[0],y=d[1],g=(0,l.Z)(p.glyphs);try{for(g.s();!(h=g.n()).done;){var k=h.value;if(_>k.xTopLeft&&_<k.xBottomRight&&y>-k.yBottomRight&&y<-k.yTopLeft){this._earlyReturn=!0;break}}}catch(P){g.e(P)}finally{g.f()}}}}}},{key:"_hitTestFill",value:function(t){var e=null;if((0,P.YX)(t)){var i=t;e=[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]}else if((0,P.oU)(t))e=t.rings;else{if(!(0,P.l9)(t))return;e=t.paths}var r=this.reverseTransformPt(this._searchPoint);if(this._pointInPolygon(r,e)&&(this._earlyReturn=!0),!this._earlyReturn){var n=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(r,e,n)&&(this._earlyReturn=!0)}}},{key:"_hitTestStroke",value:function(t,e){var i=null;if((0,P.YX)(t)){var r=t;i=[[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]}else if((0,P.oU)(t))i=t.rings;else{if(!(0,P.l9)(t))return;i=t.paths}var n=this.reverseTransformPt(this._searchPoint),a=e*this.geomUnitsPerPoint(),s=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(n,i,a/2+s)&&(this._earlyReturn=!0)}},{key:"_pointInPolygon",value:function(t,e){var i,r=0,n=(0,l.Z)(e);try{for(n.s();!(i=n.n()).done;)for(var a=i.value,s=a.length,o=1;o<s;o++){var h=a[o-1],u=a[o];h[1]>t[1]!=u[1]>t[1]&&((u[0]-h[0])*(t[1]-h[1])-(u[1]-h[1])*(t[0]-h[0])>0?r++:r--)}}catch(c){n.e(c)}finally{n.f()}return 0!==r}},{key:"_nearLine",value:function(t,e,i){var r,n=(0,l.Z)(e);try{for(n.s();!(r=n.n()).done;)for(var a=r.value,s=a.length,o=1;o<s;o++){var h=a[o-1],u=a[o],c=(u[0]-h[0])*(u[0]-h[0])+(u[1]-h[1])*(u[1]-h[1]);if(0!==c){c=Math.sqrt(c);var f=((u[0]-h[0])*(t[1]-h[1])-(u[1]-h[1])*(t[0]-h[0]))/c;if(Math.abs(f)<i){var v=((u[0]-h[0])*(t[0]-h[0])+(u[1]-h[1])*(t[1]-h[1]))/c;if(v>-i&&v<c+i)return!0}}}}catch(m){n.e(m)}finally{n.f()}return!1}}]),i}(F),X=function(t){(0,a.Z)(i,t);var e=(0,s.Z)(i);function i(t,r,n,a){var s;return(0,h.Z)(this,i),(s=e.call(this,r,n))._applyAdditionalRenderProps=a,s._colorSubstitutionHelper=new b,s._ctx=t,s}return(0,u.Z)(i,[{key:"drawSolidFill",value:function(t,e){if(t){if((0,P.oU)(t))this._buildPath(t.rings,!0);else if((0,P.l9)(t))this._buildPath(t.paths,!0);else if((0,P.YX)(t))this._buildPath(Y(t).rings,!0);else{if(!(0,P.aW)(t))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}var i=this._ctx;i.fillStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+e[3]/255+")",i.fill("evenodd")}}},{key:"drawSolidStroke",value:function(t,e,i,r,n,a){if(t&&e&&0!==i){if((0,P.oU)(t))this._buildPath(t.rings,!0);else if((0,P.l9)(t))this._buildPath(t.paths,!1);else{if(!(0,P.YX)(t))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(Y(t).rings,!0)}var s=this._ctx;s.strokeStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+e[3]/255+")",s.lineWidth=Math.max(this.transformSize(i),.5),this._setCapStyle(r),this._setJoinStyle(n),s.miterLimit=a,s.stroke()}}},{key:"pushClipPath",value:function(t){if(this._ctx.save(),(0,P.oU)(t))this._buildPath(t.rings,!0);else if((0,P.l9)(t))this._buildPath(t.paths,!0);else{if(!(0,P.YX)(t))return;this._buildPath(Y(t).rings,!0)}this._ctx.clip("evenodd")}},{key:"popClipPath",value:function(){this._ctx.restore()}},{key:"drawImage",value:function(t,e){var i,r=t.colorSubstitutions,n=t.url,a=t.tintColor,s=null!==(i=t.scaleX)&&void 0!==i?i:1,l=this._resourceManager.getResource(n);if(!(0,p.Wi)(l)){var h=e*(l.width/l.height),u=e;e||(h=l.width,u=l.height);var c=(0,L.TB)(n)||"src"in l&&(0,L.TB)(l.src),f="getFrame"in l?I(l):l;r&&(f=this._colorSubstitutionHelper.applyColorSubstituition(f,r)),this._applyAdditionalRenderProps&&!c&&a&&(f=this._colorSubstitutionHelper.tintImageData(f,a));var v=this.transformPt([0,0]),m=this.getTransformAngle(),d=(0,o.Z)(m,2),_=d[0],y=d[1],g=this.transformSize(1),k=this._ctx;k.save(),k.setTransform({m11:s*g*_,m12:s*g*y,m21:-g*y,m22:g*_,m41:v[0],m42:v[1]}),k.drawImage(f,-h/2,-u/2,h,u),k.restore()}}},{key:"drawText",value:function(t,e){if(e&&0!==e.length){this._textRasterizer||(this._textRasterizer=new N.Z);var i=V(t);i.size*=this.transformSize((0,_.Wz)(1));var r=this._textRasterizer.rasterizeText(e,i);if(r){var n=r.size,a=r.anchorX,s=r.anchorY,l=r.canvas,h=n[0]*(a+.5),u=n[1]*(s-.5),c=this._ctx,f=this.transformPt([0,0]),v=this.getTransformAngle(),m=(0,o.Z)(v,2),p=m[0],d=m[1];c.save(),c.setTransform({m11:1*p,m12:1*d,m21:-1*d,m22:1*p,m41:f[0]-1*h,m42:f[1]+1*u}),c.drawImage(l,0,0),c.restore()}}}},{key:"drawPictureFill",value:function(t,e){if(t){var i=e.colorSubstitutions,r=e.height,n=e.offsetX,a=e.offsetY,s=e.rotation,o=e.scaleX,l=e.tintColor,h=e.url,u=this._resourceManager.getResource(h);if(!(0,p.Wi)(u)){if((0,P.oU)(t))this._buildPath(t.rings,!0);else if((0,P.l9)(t))this._buildPath(t.paths,!0);else if((0,P.YX)(t))this._buildPath(Y(t).rings,!0);else{if(!(0,P.aW)(t))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}var c,f=this._ctx,v=(0,L.TB)(h)||"src"in u&&(0,L.TB)(u.src),m="getFrame"in u?I(u):u;if(i&&(m=this._colorSubstitutionHelper.applyColorSubstituition(m,i)),this._applyAdditionalRenderProps){v||l&&(m=this._colorSubstitutionHelper.tintImageData(m,l)),c=f.createPattern(m,"repeat");var d=this.transformSize(1);s||(s=0),n?n*=d:n=0,a?a*=d:a=0,r&&(r*=d);var _=r?r/u.height:1,y=o&&r?o*r/u.width:1;if(0!==s||1!==_||1!==y||0!==n||0!==a){var g=new DOMMatrix;g.rotateSelf(0,0,-s).translateSelf(n,a).scaleSelf(y,_,1),c.setTransform(g)}}else c=f.createPattern(m,"repeat");f.save(),f.fillStyle=c,f.fill("evenodd"),f.restore()}}}},{key:"drawPictureStroke",value:function(t,e){if(t){var i=e.colorSubstitutions,r=e.capStyle,n=e.joinStyle,a=e.miterLimit,s=e.tintColor,o=e.url,h=e.width,u=this._resourceManager.getResource(o);if(!(0,p.Wi)(u)){var c;if((0,P.oU)(t))c=t.rings;else if((0,P.l9)(t))c=t.paths;else if((0,P.YX)(t))c=Y(t).rings;else{if(!(0,P.aW)(t))return;console.log("CanvasDrawHelper.drawPictureStroke - No implementation!")}h||(h=u.width);var f=(0,L.TB)(o)||"src"in u&&(0,L.TB)(u.src),m="getFrame"in u?I(u):u;i&&(m=this._colorSubstitutionHelper.applyColorSubstituition(m,i)),this._applyAdditionalRenderProps&&(f||s&&(m=this._colorSubstitutionHelper.tintImageData(m,s)));var d,y,g=Math.max(this.transformSize((0,_.F2)(h)),.5),k=g/m.width,x=this._ctx,M=x.createPattern(m,"repeat-y");x.save(),this._setCapStyle(r),this._setJoinStyle(n),x.miterLimit=a,x.lineWidth=g;var b,S=(0,l.Z)(c);try{for(S.s();!(b=S.n()).done;){var C=b.value;if(J(C=(0,v.d9)(C)),C&&!(C.length<=1)){d=this.transformPt(C[0]);for(var w=1;w<C.length;w++){var Z=D(d,y=this.transformPt(C[w])),N=new DOMMatrix;N.translateSelf(0,d[1]-g/2).scaleSelf(k,k,1).rotateSelf(0,0,90-Z),M.setTransform(N),x.strokeStyle=M,x.beginPath(),x.moveTo(d[0],d[1]),x.lineTo(y[0],y[1]),x.stroke(),d=y}}}}catch(A){S.e(A)}finally{S.f()}x.restore()}}}},{key:"_buildPath",value:function(t,e){var i=this._ctx;if(i.beginPath(),t){var r,n=(0,l.Z)(t);try{for(n.s();!(r=n.n()).done;){var a=r.value,s=a?a.length:0;if(s>1){var o=this.transformPt(a[0]);i.moveTo(o[0],o[1]);for(var h=1;h<s;h++)o=this.transformPt(a[h]),i.lineTo(o[0],o[1]);e&&i.closePath()}}}catch(u){n.e(u)}finally{n.f()}}}},{key:"_setCapStyle",value:function(t){switch(t){case w.kP.Butt:this._ctx.lineCap="butt";break;case w.kP.Round:this._ctx.lineCap="round";break;case w.kP.Square:this._ctx.lineCap="square"}}},{key:"_setJoinStyle",value:function(t){switch(t){case w.r4.Bevel:this._ctx.lineJoin="bevel";break;case w.r4.Round:this._ctx.lineJoin="round";break;case w.r4.Miter:this._ctx.lineJoin="miter"}}}]),i}(F);function D(t,e){var i=e[0]-t[0],r=e[1]-t[1];return 180/Math.PI*Math.atan2(r,i)}var Y=function(t){return t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null},U=function(t){switch(t){case"Left":return A.M7.Left;case"Right":return A.M7.Right;case"Center":return A.M7.Center;case"Justify":return O.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),A.M7.Center}},W=function(t){switch(t){case"Top":return A.TR.Top;case"Center":return A.TR.Center;case"Bottom":return A.TR.Bottom;case"Baseline":return A.TR.Baseline}},B=function(t,e,i){switch(t){case"ExtraLeading":return 1+e/i;case"Multiple":return e;case"Exact":return e/i}};function V(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=(0,L.BX)(t),r=(0,L.wi)(t.fontStyleName),n=(0,f.BN)(t.fontFamilyName),a=r.weight,s=r.style,o=e*(t.height||5),l=(0,L.X_)(t.horizontalAlignment),h=(0,L.FG)(t.verticalAlignment),u=(0,L.W7)(t),c=(0,L.$Z)(t.haloSymbol),v=c?e*(0|t.haloSize):0;return{color:u,size:o,horizontalAlignment:l,verticalAlignment:h,font:{family:n,style:(0,L.pJ)(s),weight:(0,L.On)(a),decoration:i},halo:{size:v||0,color:c,style:s},pixelRatio:1,premultiplyColors:!0}}function J(t){for(var e,i,r,n,a,s=t[0],o=1;o<t.length;)e=t[o][0]-s[0],i=t[o][1]-s[1],n=0!==e?i/e:Math.PI/2,void 0!==r&&n-r<=1e-4?(t.splice(o-1,1),s=a):(a=s,s=t[o],o++),r=n}},78915:function(t,e,i){i.d(e,{B$:function(){return G},E0:function(){return H},U1:function(){return q},bP:function(){return F},rW:function(){return T}});var r=i(74165),n=i(15861),a=i(1413),s=i(29439),o=i(15671),l=i(43144),h=i(37762),u=i(51995),c=i(75746),f=i(84652),v=i(32718),m=i(92026),p=i(84936),d=i(17842),_=i(65156),y=i(376),g=i(819),k=i(84284),P=i(66726),x=i(48202),M=i(31027),b=i(91935),S=i(99201),C=i(94109),w=i(47975),I=Math.PI,Z=I/2,N=96/72,L=Math.PI/180,A=v.Z.getLogger("esri.symbols.cim.CIMSymbolHelper");function T(t){if(!t||!t.type)return null;var e;switch(t.type){case"cim":return t.data;case"web-style":return t;case"simple-marker":e=G.fromSimpleMarker(t);break;case"picture-marker":e=G.fromPictureMarker(t);break;case"simple-line":e=G.fromSimpleLineSymbol(t);break;case"simple-fill":e=G.fromSimpleFillSymbol(t);break;case"picture-fill":e=G.fromPictureFillSymbol(t);break;case"text":e=G.fromTextSymbol(t)}return{type:"CIMSymbolReference",symbol:e}}function z(t,e,i){switch(e.type){case"CIMSymbolReference":return z(t,e.symbol,i);case"CIMPointSymbol":null==i&&(i={x:0,y:0}),t.drawSymbol(e,i);break;case"CIMLineSymbol":null==i&&(i={paths:[[[0,0],[10,0]]]}),t.drawSymbol(e,i);break;case"CIMPolygonSymbol":null==i&&(i={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),t.drawSymbol(e,i);break;case"CIMTextSymbol":t.drawSymbol(e,{x:0,y:0});break;case"CIMVectorMarker":var r=new k.u;t.drawMarker(e,r)}return t.envelope()}function E(t){if(!t)return 0;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(t.offset);default:return 0}}function O(t){if(!t)return 0;switch(t.type){case"CIMGeometricEffectArrow":return Math.abs(.5*t.width);case"CIMGeometricEffectBuffer":return Math.abs(t.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(t.length);case"CIMGeometricEffectJog":return Math.abs(.5*t.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,M.NA)(t.offsetX)),Math.abs((0,M.NA)(t.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(t.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(t.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(t.fromWidth),Math.abs(t.toWidth));case"CIMGeometricEffectWave":return Math.abs(t.amplitude)}}function R(t){if(!t)return 0;var e,i=0,r=(0,h.Z)(t);try{for(r.s();!(e=r.n()).done;){i+=O(e.value)}}catch(n){r.e(n)}finally{r.f()}return i}var F=function(){function t(){(0,o.Z)(this,t)}return(0,l.Z)(t,[{key:"getSymbolInflateSize",value:function(t,e,i,r,n){return t||(t=[0,0,0,0]),e?this._getInflateSize(t,e,i,r,n):t}},{key:"_vectorMarkerBounds",value:function(t,e,i,r){var n=!0,a=(0,_.Ue)();if(e&&e.markerGraphics){var s,o=(0,h.Z)(e.markerGraphics);try{for(o.s();!(s=o.n()).done;){var l=s.value,u=[0,0,0,0];l.geometry&&((0,y.$P)(a,l.geometry),u[0]=0,u[1]=0,u[2]=0,u[3]=0,this.getSymbolInflateSize(u,l.symbol,i,0,r),a[0]+=u[0],a[1]+=u[1],a[2]+=u[2],a[3]+=u[3],n?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],n=!1):(t[0]=Math.min(t[0],a[0]),t[1]=Math.min(t[1],a[1]),t[2]=Math.max(t[2],a[2]),t[3]=Math.max(t[3],a[3])))}}catch(c){o.e(c)}finally{o.f()}}return t}},{key:"_getInflateSize",value:function(t,e,i,r,n){if(function(t){return void 0!==t.symbolLayers}(e)){var a=this._getLayersInflateSize(t,e.symbolLayers,i,r,n),s=R(e.effects);return s>0&&(a[0]-=s,a[1]-=s,a[2]+=s,a[3]+=s),a}return this._getTextInflatedSize(t,e,n)}},{key:"_getLayersInflateSize",value:function(t,e,i,r,n){var a=!0;if(!e)return t;var s,o=(0,h.Z)(e);try{for(o.s();!(s=o.n()).done;){var l=s.value;if(l){var u=[0,0,0,0];switch(l.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":var c=l,f=c.width;c.capStyle===x.kP.Square||c.joinStyle===x.r4.Miter?f/=1.4142135623730951:f/=2,u[0]=-f,u[1]=-f,u[2]=f,u[3]=f;break;case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":var v=l;if("CIMVectorMarker"===l.type){var p=l;if(u=this._vectorMarkerBounds(u,p,i,n),p.frame){var d=(p.frame.xmin+p.frame.xmax)/2,y=(p.frame.ymin+p.frame.ymax)/2;u[0]-=d,u[1]-=y,u[2]-=d,u[3]-=y;var g=p.size/(p.frame.ymax-p.frame.ymin);u[0]*=g,u[1]*=g,u[2]*=g,u[3]*=g}}else if("CIMPictureMarker"===l.type){var k=l,P=i.getResource(k.url),b=1;(0,m.pC)(P)&&P.height&&(b=P.width/P.height);var C=v.size/2,w=v.size*b*k.scaleX/2;u=[-w,-C,w,C]}else{var I=v.size/2;u=[-I,-I,I,I]}if(v.anchorPoint){var Z=void 0,N=void 0;"Absolute"===v.anchorPointUnits?(Z=v.anchorPoint.x,N=v.anchorPoint.y):(Z=v.anchorPoint.x*(u[2]-u[0]),N=v.anchorPoint.y*(u[3]-u[1])),u[0]-=Z,u[1]-=N,u[2]-=Z,u[3]-=N}var A=(0,M.NA)(v.rotation);if(v.rotateClockwise&&(A=-A),r&&(A-=r),A){var T=L*A,z=Math.cos(T),O=Math.sin(T),F=(0,_.Ue)([S.B1,S.B1,-S.B1,-S.B1]);(0,_.Ho)(F,[u[0]*z-u[1]*O,u[0]*O+u[1]*z]),(0,_.Ho)(F,[u[0]*z-u[3]*O,u[0]*O+u[3]*z]),(0,_.Ho)(F,[u[2]*z-u[1]*O,u[2]*O+u[1]*z]),(0,_.Ho)(F,[u[2]*z-u[3]*O,u[2]*O+u[3]*z]),u=F}var G=(0,M.NA)(v.offsetX),H=(0,M.NA)(v.offsetY);if(r){var X=L*r,D=Math.cos(X),Y=Math.sin(X),U=G*Y+H*D;G=G*D-H*Y,H=U}u[0]+=G,u[1]+=H,u[2]+=G,u[3]+=H;var W=E(v.markerPlacement);W>0&&(u[0]-=W,u[1]-=W,u[2]+=W,u[3]+=W)}var B=R(l.effects);B>0&&(u[0]-=B,u[1]-=B,u[2]+=B,u[3]+=B),a?(t[0]=u[0],t[1]=u[1],t[2]=u[2],t[3]=u[3],a=!1):(t[0]=Math.min(t[0],u[0]),t[1]=Math.min(t[1],u[1]),t[2]=Math.max(t[2],u[2]),t[3]=Math.max(t[3],u[3]))}}}catch(V){o.e(V)}finally{o.f()}return t}},{key:"_getTextInflatedSize",value:function(t,e,i){var r,n,a=null!==(r=e.height)&&void 0!==r?r:10;if(t[0]=-a/2,t[1]=-a/2,t[2]=a/2,t[3]=a/2,!i)return t;var s=i.get(e);if(!s)return t;var o=s.text,l=s.mosaicItem;if(!l||0===l.glyphMosaicItems.length)return t;var h=(0,P.et)(e.lineGapType,null!==(n=e.lineGap)&&void 0!==n?n:0,a),u=(0,c.E)(o)[1],f=l.glyphMosaicItems,v=(0,w.Nr)(f,u,{scale:a/C.Ex,angle:(0,M.NA)(e.angle),xOffset:(0,M.NA)(e.offsetX),yOffset:(0,M.NA)(e.offsetY),hAlign:(0,P.x1)(e.horizontalAlignment),vAlign:(0,P.g)(e.verticalAlignment),maxLineWidth:512,lineHeight:C.xm*Math.max(.25,Math.min(h||1,4)),decoration:e.font.decoration||"none",isCIM:!0}).boundsT;return t[0]=v.x-v.halfWidth,t[1]=-v.y-v.halfHeight,t[2]=v.x+v.halfWidth,t[3]=-v.y+v.halfHeight,t}}],[{key:"safeSize",value:function(t){var e=Math.max(Math.abs(t[0]),Math.abs(t[2])),i=Math.max(Math.abs(t[1]),Math.abs(t[3]));return Math.sqrt(e*e+i*i)}}]),t}(),G=function(){function t(){(0,o.Z)(this,t)}return(0,l.Z)(t,null,[{key:"getEnvelope",value:function(t,e,i){var r=new P.uQ(i);if(Array.isArray(t)){var n,a,s=(0,h.Z)(t);try{for(s.s();!(a=s.n()).done;){var o=a.value;n?n.union(z(r,o,e)):n=z(r,o,e)}}catch(l){s.e(l)}finally{s.f()}return n}return z(r,t,e)}},{key:"getTextureAnchor",value:function(t,e){var i=this.getEnvelope(t,null,e);if(!i)return[0,0,0];var r=(i.x+.5*i.width)*N,n=(i.y+.5*i.height)*N,a=i.width*N+2,s=i.height*N+2;return[-r/a,-n/s,s]}},{key:"rasterize",value:function(t,e,i,r){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=i||this.getEnvelope(e,null,r);if(!a)return[null,0,0,0,0];var s=(a.x+.5*a.width)*N,o=(a.y+.5*a.height)*N;t.width=a.width*N,t.height=a.height*N,i||(t.width+=2,t.height+=2);var l=t.getContext("2d"),h=P.zA.createScale(N,-N);h.translate(.5*t.width-s,.5*t.height+o);var u=new P.cD(l,r,h);switch(e.type){case"CIMPointSymbol":var c={type:"point",x:0,y:0};u.drawSymbol(e,c);break;case"CIMVectorMarker":var f=new k.u;u.drawMarker(e,f)}var v=l.getImageData(0,0,t.width,t.height),m=new Uint8Array(v.data);if(n)for(var p,d=0;d<m.length;d+=4)p=m[d+3]/255,m[d]=m[d]*p,m[d+1]=m[d+1]*p,m[d+2]=m[d+2]*p;return[m,t.width,t.height,-s/t.width,-o/t.height]}},{key:"fromTextSymbol",value:function(t){var e,i,r,n,a,s=t.angle,o=t.color,l=t.font,h=t.haloColor,u=t.haloSize,f=t.horizontalAlignment,v=t.kerning,m=t.text,p=t.verticalAlignment,d=t.xoffset,_=t.yoffset;l&&(e=l.family,i=l.style,r=l.weight,n=l.size,a=l.decoration);var y=!1;return m&&(y=(0,c.E)(m)[1]),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:s,blockProgression:x.zV.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:x.eZ.Normal,fontEncoding:x.DD.Unicode,fontFamilyName:e||"Arial",fontStyleName:B(i,r),fontType:x.Ky.Unspecified,haloSize:u,height:n,hinting:x.Dd.Default,horizontalAlignment:Y(null!==f&&void 0!==f?f:"center"),kerning:v,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:(0,M.NA)(d),offsetY:(0,M.NA)(_),strikethrough:"line-through"===a,underline:"underline"===a,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:W(o)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:W(h)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:y?x.UX.RTL:x.UX.LTR,verticalAlignment:U(null!==p&&void 0!==p?p:"baseline"),verticalGlyphOrientation:x.RS.Right,wordSpacing:100,billboardMode3D:x.UR.FaceNearPlane},textString:m}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}},{key:"fromPictureFillSymbol",value:function(t){var e=t.height,i=t.outline,r=t.width,n=t.xoffset,a=t.xscale,s=t.yoffset,o=t.yscale,l=[],h={type:"CIMPolygonSymbol",symbolLayers:l};if(i){var u=i.cap,c=i.join,f=i.miterLimit,v=i.width;l.push({type:"CIMSolidStroke",color:W(i.color),capStyle:X(u),joinStyle:D(c),miterLimit:f,width:v})}var m=t.url;"esriPFS"===t.type&&t.imageData&&(m=t.imageData);var p="angle"in t?t.angle:0,d=r*(a||1),_=e*(o||1);return l.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:x.Qb.Picture,tintColor:null,url:m,height:_,width:d,offsetX:(0,M.NA)(n),offsetY:(0,M.NA)(s),rotation:(0,M.NA)(-p),colorSubstitutions:null}),h}},{key:"fromSimpleFillSymbol",value:function(t){var e=t.color,i=t.style,r=t.outline,n=[],a={type:"CIMPolygonSymbol",symbolLayers:n},s=null;if(r){var o=r.cap,l=r.join,h=r.style;"solid"!==h&&"none"!==h&&"esriSLSSolid"!==h&&"esriSLSNull"!==h&&(s=[{type:"CIMGeometricEffectDashes",dashTemplate:q(h,o),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),n.push({type:"CIMSolidStroke",color:W(r.color),capStyle:X(o),joinStyle:D(l),miterLimit:r.miterLimit,width:r.width,effects:s})}if(i&&"solid"!==i&&"none"!==i&&"esriSFSSolid"!==i&&"esriSFSNull"!==i){var u={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:W(e),capStyle:x.kP.Butt,joinStyle:x.r4.Miter,width:.75}]},c=0,v=(0,d.Wz)(Q(i)?8:10);switch(i){case"vertical":case"esriSFSVertical":c=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":c=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":c=45;break;case"cross":case"esriSFSCross":c=0}n.push({type:"CIMHatchFill",lineSymbol:u,offsetX:0,offsetY:0,rotation:c,separation:v}),"cross"===i||"esriSFSCross"===i?n.push({type:"CIMHatchFill",lineSymbol:(0,f.d9)(u),offsetX:0,offsetY:0,rotation:90,separation:v}):"diagonal-cross"!==i&&"esriSFSDiagonalCross"!==i||n.push({type:"CIMHatchFill",lineSymbol:(0,f.d9)(u),offsetX:0,offsetY:0,rotation:45,separation:v})}else!i||"solid"!==i&&"esriSFSSolid"!==i||n.push({type:"CIMSolidFill",enable:!0,color:W(e)});return a}},{key:"fromSimpleLineSymbol",value:function(e){var i=e.cap,r=e.color,n=e.join,a=e.marker,s=e.miterLimit,o=e.style,l=e.width,h=null;"solid"!==o&&"none"!==o&&"esriSLSSolid"!==o&&"esriSLSNull"!==o&&(h=[{type:"CIMGeometricEffectDashes",dashTemplate:q(o,i),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);var u=[];if(a){var c;switch(a.placement){case"begin-end":c=x.Tx.Both;break;case"begin":c=x.Tx.JustBegin;break;case"end":c=x.Tx.JustEnd;break;default:c=x.Tx.None}var f=t.fromSimpleMarker(a,l,r).symbolLayers[0];f.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:c,offsetAlongLine:0},u.push(f)}return"none"!==o&&"esriSLSNull"!==o&&u.push({type:"CIMSolidStroke",color:W(r),capStyle:X(i),joinStyle:D(n),miterLimit:s,width:l,effects:h}),{type:"CIMLineSymbol",symbolLayers:u}}},{key:"fromPictureMarker",value:function(t){var e=t.angle,i=t.height,r=t.width,n=t.xoffset,a=t.yoffset,s=t.url;return"esriPMS"===t.type&&t.imageData&&(s=t.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:x.Qb.Picture,tintColor:null,url:s,size:i,width:r,offsetX:(0,M.NA)(n),offsetY:(0,M.NA)(a),rotation:(0,M.NA)(-e)}]}}},{key:"fromSimpleMarker",value:function(t,e,i){var r,n=t.style,a=null!==(r=t.color)&&void 0!==r?r:i;if("path"===n){var o=[];if("outline"in t&&t.outline){var l=t.outline;o.push({type:"CIMSolidStroke",enable:!0,width:(0,d.F2)(Math.round((0,d.Wz)(l.width))),color:W(l.color)})}o.push({type:"CIMSolidFill",enable:!0,color:W(a),path:t.path});var h=$("square"),u=(0,s.Z)(h,2),c=u[0],f=u[1];return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,M.NA)(-t.angle),size:(0,M.NA)(t.size||6),offsetX:(0,M.NA)(t.xoffset),offsetY:(0,M.NA)(t.yoffset),frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:f,symbol:{type:"CIMPolygonSymbol",symbolLayers:o}}]}]}}var v,m=$(n),p=(0,s.Z)(m,2),_=p[0],y=p[1];if(y&&_){var g=[];if("outline"in t&&t.outline){var k=t.outline;g.push({type:"CIMSolidStroke",enable:!0,width:k.width>.667?(0,d.F2)(Math.round((0,d.Wz)(k.width))):k.width,color:W(k.color)})}else!e||"line-marker"!==t.type||"cross"!==t.style&&"x"!==t.style||g.push({type:"CIMSolidStroke",enable:!0,width:e,color:W(a)});g.push({type:"CIMSolidFill",enable:!0,color:W(a)});var P={type:"CIMPolygonSymbol",symbolLayers:g};v={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,M.NA)(-t.angle),size:(0,M.NA)(t.size||6*e),offsetX:(0,M.NA)(t.xoffset),offsetY:(0,M.NA)(t.yoffset),frame:_,markerGraphics:[{type:"CIMMarkerGraphic",geometry:y,symbol:P}]}]}}return v}},{key:"fromCIMHatchFill",value:function(t,e){for(var i,r=e*(null!==(i=t.separation)&&void 0!==i?i:4),n=r/2,a=(0,f.d9)(t.lineSymbol),s=this._getLineSymbolPeriod(a)||4;s<4;)s*=2;var o=s/2,l={xmin:-o,xmax:o,ymin:-n,ymax:n},h=a.symbolLayers.find((function(t){return"CIMSolidStroke"===t.type}));return h&&(h.width*=e),{type:"CIMVectorMarker",frame:l,markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-o,0],[o,0]]]},symbol:a}],size:r}}},{key:"fetchResources",value:function(e,i,r){if(e&&i)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":var n=e.symbolLayers;if(!n)return;var a,s=(0,h.Z)(n);try{for(s.s();!(a=s.n()).done;){var o=a.value;switch(tt(o,i,r),o.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in o&&o.url&&r.push(i.fetchResource(o.url,null));break;case"CIMVectorMarker":var l=o.markerGraphics;if(!l)continue;var u,c=(0,h.Z)(l);try{for(c.s();!(u=c.n()).done;){var f=u.value;if(f){var v=f.symbol;v&&t.fetchResources(v,i,r)}}}catch(m){c.e(m)}finally{c.f()}}}}catch(m){s.e(m)}finally{s.f()}}}},{key:"_getLineSymbolPeriod",value:function(t){if(t){var e=this._getEffectsRepeat(t.effects);if(e)return e;if(t.symbolLayers){var i,r=(0,h.Z)(t.symbolLayers);try{for(r.s();!(i=r.n()).done;){var n=i.value;if(n){var a=this._getEffectsRepeat(n.effects);if(a)return a;switch(n.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":var s=this._getPlacementRepeat(n.markerPlacement);if(s)return s}}}}catch(o){r.e(o)}finally{r.f()}}}return 0}},{key:"_getEffectsRepeat",value:function(t){if(t){var e,i=(0,h.Z)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r)switch(r.type){case"CIMGeometricEffectDashes":var n=r.dashTemplate;if(n&&n.length){var a,s=0,o=(0,h.Z)(n);try{for(o.s();!(a=o.n()).done;){s+=a.value}}catch(l){o.e(l)}finally{o.f()}return 1&n.length&&(s*=2),s}break;case"CIMGeometricEffectWave":return r.period;default:A.error("unsupported geometric effect type ".concat(r.type))}}}catch(l){i.e(l)}finally{i.f()}}return 0}},{key:"_getPlacementRepeat",value:function(t){if(t)switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":var e=t.placementTemplate;if(e&&e.length){var i,r=0,n=(0,h.Z)(e);try{for(n.s();!(i=n.n()).done;){r+=i.value}}catch(a){n.e(a)}finally{n.f()}return 1&e.length&&(r*=2),r}}return 0}},{key:"fromCIMInsidePolygon",value:function(t){var e,i=t.markerPlacement,r=(0,a.Z)({type:t.type},t);r.markerPlacement=null,r.anchorPoint=null;var n,s,o,l,h=Math.abs(i.stepX),u=Math.abs(i.stepY),c=(null!==(e=i.randomness)&&void 0!==e?e:100)/100;if("Random"===i.gridType){var f=(0,d.Wz)(C.C1),v=Math.max(Math.floor(f/h),1),m=Math.max(Math.floor(f/u),1);n=v*h/2,o=2*(s=m*u/2);var _=new p.Z(i.seed),y=c*h/1.5,g=c*u/1.5;l=[];for(var k=0;k<v;k++)for(var P=0;P<m;P++){var x=k*h-n+y*(.5-_.getFloat()),M=P*u-s+g*(.5-_.getFloat());l.push({x:x,y:M}),0===k&&l.push({x:x+2*n,y:M}),0===P&&l.push({x:x,y:M+2*s})}}else!0===i.shiftOddRows?(o=2*u,l=[{x:-(n=h/2),y:0},{x:n,y:0},{x:0,y:s=u},{x:0,y:-s}]):(n=h/2,s=u/2,o=u,l=[{x:-h,y:0},{x:0,y:-u},{x:-h,y:-u},{x:0,y:0},{x:h,y:0},{x:0,y:u},{x:h,y:u},{x:-h,y:u},{x:h,y:-u}]);return{type:"CIMVectorMarker",frame:{xmin:-n,xmax:n,ymin:-s,ymax:s},markerGraphics:l.map((function(t){return{type:"CIMMarkerGraphic",geometry:t,symbol:{type:"CIMPointSymbol",symbolLayers:[r]}}})),size:o}}},{key:"getSize",value:function(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":var e=0;if(t.symbolLayers){var i,r=(0,h.Z)(t.symbolLayers);try{for(r.s();!(i=r.n()).done;){var n=i.value;if(n)switch(n.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":var a=n.size;a>e&&(e=a)}}}catch(v){r.e(v)}finally{r.f()}}return e;case"CIMLineSymbol":case"CIMPolygonSymbol":var s=0;if(t.symbolLayers){var o,l=(0,h.Z)(t.symbolLayers);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(u)switch(u.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":var c=u.width;c>s&&(s=c);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if((0,M.gJ)(u.markerPlacement)){var f=u.size;f>s&&(s=f)}}}}catch(v){l.e(v)}finally{l.f()}}return s}}},{key:"getMarkerScaleRatio",value:function(t){if(t&&"CIMVectorMarker"===t.type&&!1!==t.scaleSymbolsProportionally&&t.frame){var e=t.frame.ymax-t.frame.ymin;return t.size/e}return 1}}]),t}(),H=function(){function t(){(0,o.Z)(this,t)}return(0,l.Z)(t,null,[{key:"findApplicableOverrides",value:function(e,i,r){if(e&&i){if(e.primitiveName){var n,a=!1,s=(0,h.Z)(r);try{for(s.s();!(n=s.n()).done;){if(n.value.primitiveName===e.primitiveName){a=!0;break}}}catch(M){s.e(M)}finally{s.f()}if(!a){var o,l=(0,h.Z)(i);try{for(l.s();!(o=l.n()).done;){var u=o.value;u.primitiveName===e.primitiveName&&r.push(u)}}catch(M){l.e(M)}finally{l.f()}}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects){var c,f=(0,h.Z)(e.effects);try{for(f.s();!(c=f.n()).done;){var v=c.value;t.findApplicableOverrides(v,i,r)}}catch(M){f.e(M)}finally{f.f()}}if(e.symbolLayers){var m,p=(0,h.Z)(e.symbolLayers);try{for(p.s();!(m=p.n()).done;){var d=m.value;t.findApplicableOverrides(d,i,r)}}catch(M){p.e(M)}finally{p.f()}}break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects){var _,y=(0,h.Z)(e.effects);try{for(y.s();!(_=y.n()).done;){var g=_.value;t.findApplicableOverrides(g,i,r)}}catch(M){y.e(M)}finally{y.f()}}if(e.markerPlacement&&t.findApplicableOverrides(e.markerPlacement,i,r),"CIMVectorMarker"===e.type){if(e.markerGraphics){var k,P=(0,h.Z)(e.markerGraphics);try{for(P.s();!(k=P.n()).done;){var x=k.value;t.findApplicableOverrides(x,i,r),t.findApplicableOverrides(x.symbol,i,r)}}catch(M){P.e(M)}finally{P.f()}}}else"CIMCharacterMarker"===e.type?t.findApplicableOverrides(e.symbol,i,r):"CIMHatchFill"===e.type?t.findApplicableOverrides(e.lineSymbol,i,r):"CIMPictureMarker"===e.type&&t.findApplicableOverrides(e.animatedSymbolProperties,i,r)}}}},{key:"findEffectOverrides",value:function(t,e,i){if(e&&t)for(var r=t.length,n=0;n<r;n++){var a,s=null===(a=t[n])||void 0===a?void 0:a.primitiveName;if(s){var o,l=!1,u=(0,h.Z)(i);try{for(u.s();!(o=u.n()).done;){if(o.value.primitiveName===s){l=!0;break}}}catch(m){u.e(m)}finally{u.f()}if(!l){var c,f=(0,h.Z)(e);try{for(f.s();!(c=f.n()).done;){var v=c.value;v.primitiveName===s&&i.push(v)}}catch(m){f.e(m)}finally{f.f()}}}}}},{key:"resolveSymbolOverrides",value:function(){var e=(0,n.Z)((0,r.Z)().mark((function e(i,n,a,s,o,l,h){var u,c,v,m,p;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&i.symbol){e.next=2;break}return e.abrupt("return",null);case 2:if(u=i.symbol,c=i.primitiveOverrides,(v=!!c)||s){e.next=6;break}return e.abrupt("return",u);case 6:if(u=(0,f.d9)(u),m=!0,n||(n={attributes:{}},m=!1),!v){e.next=14;break}if(m||(c=c.filter((function(t){var e;return!(null!==(e=t.valueExpressionInfo)&&void 0!==e&&e.expression.includes("$feature"))}))),h||(c=c.filter((function(t){var e;return!(null!==(e=t.valueExpressionInfo)&&void 0!==e&&e.expression.includes("$view"))}))),!(c.length>0)){e.next=13;break}return p=(0,M.Qf)(n.attributes),e.next=13,t.evaluateOverrides(c,n,{spatialReference:a,fields:p,geometryType:o},l,h);case 13:t.applyOverrides(u,c);case 14:return e.abrupt("return",(s&&t.applyDictionaryTextOverrides(u,n,s),u));case 15:case"end":return e.stop()}}),e)})));return function(t,i,r,n,a,s,o){return e.apply(this,arguments)}}()},{key:"evaluateOverrides",value:function(){var t=(0,n.Z)((0,r.Z)().mark((function t(e,i,n,a,s){var o,l,u,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i){t.next=2;break}return t.abrupt("return");case 2:l=(0,h.Z)(e);try{for(c=function(){var t=u.value,e=t.valueExpressionInfo;if(e&&n){o||(o=[]),t.value=void 0;var r=(0,g.Yi)(e.expression,n.spatialReference,n.fields).then((function(e){t.value=(0,b.Z)(e,i,{$view:s},n.geometryType,a)}));o.push(r)}},l.s();!(u=l.n()).done;)c()}catch(r){l.e(r)}finally{l.f()}if(t.t0=void 0!==o&&o.length>0,!t.t0){t.next=8;break}return t.next=8,Promise.all(o);case 8:case"end":return t.stop()}}),t)})));return function(e,i,r,n,a){return t.apply(this,arguments)}}()},{key:"applyDictionaryTextOverrides",value:function(e,i,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Normal";if(e&&e.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":var a=e.symbolLayers;if(!a)return;var s,o=(0,h.Z)(a);try{for(o.s();!(s=o.n()).done;){var l=s.value;l&&"CIMVectorMarker"===l.type&&t.applyDictionaryTextOverrides(l,i,r,"CIMTextSymbol"===e.type?e.textCase:n)}}catch(d){o.e(d)}finally{o.f()}break;case"CIMVectorMarker":var u=e.markerGraphics;if(!u)return;var c,f=(0,h.Z)(u);try{for(f.s();!(c=f.n()).done;){var v=c.value;v&&t.applyDictionaryTextOverrides(v,i,r)}}catch(d){f.e(d)}finally{f.f()}break;case"CIMMarkerGraphic":var m=e.textString;if(m&&m.includes("[")){var p=(0,M.H1)(m,r);e.textString=(0,M.E_)(i,p,n)}}}},{key:"applyOverrides",value:function(e,i,r,n){if(e.primitiveName){var a,s=(0,h.Z)(i);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(o.primitiveName===e.primitiveName){var l=K(o.propertyName);if(n&&n.push({cim:e,nocapPropertyName:l,value:e[l]}),o.expression&&(o.value=t.toValue(o.propertyName,o.expression)),r){var u,c=!1,f=(0,h.Z)(r);try{for(f.s();!(u=f.n()).done;){u.value.primitiveName===e.primitiveName&&(c=!0)}}catch(C){f.e(C)}finally{f.f()}c||r.push(o)}(0,m.pC)(o.value)&&(e[l]=o.value)}}}catch(C){s.e(C)}finally{s.f()}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects){var v,p=(0,h.Z)(e.effects);try{for(p.s();!(v=p.n()).done;){var d=v.value;t.applyOverrides(d,i,r,n)}}catch(C){p.e(C)}finally{p.f()}}if(e.symbolLayers){var _,y=(0,h.Z)(e.symbolLayers);try{for(y.s();!(_=y.n()).done;){var g=_.value;t.applyOverrides(g,i,r,n)}}catch(C){y.e(C)}finally{y.f()}}break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects){var k,P=(0,h.Z)(e.effects);try{for(P.s();!(k=P.n()).done;){var x=k.value;t.applyOverrides(x,i,r,n)}}catch(C){P.e(C)}finally{P.f()}}if("CIMVectorMarker"===e.type&&e.markerGraphics){var M,b=(0,h.Z)(e.markerGraphics);try{for(b.s();!(M=b.n()).done;){var S=M.value;t.applyOverrides(S,i,r,n),t.applyOverrides(S.symbol,i,r,n)}}catch(C){b.e(C)}finally{b.f()}}}}},{key:"restoreOverrides",value:function(t){var e,i=(0,h.Z)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.cim[r.nocapPropertyName]=r.value}}catch(n){i.e(n)}finally{i.f()}}},{key:"buildOverrideKey",value:function(t){var e,i="",r=(0,h.Z)(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;void 0!==n.value&&(i+="".concat(n.primitiveName).concat(n.propertyName).concat(JSON.stringify(n.value)))}}catch(a){r.e(a)}finally{r.f()}return i}},{key:"toValue",value:function(t,e){if("DashTemplate"===t)return e.split(" ").map((function(t){return Number(t)}));if("Color"===t){var i=new u.Z(e).toRgba();return i[3]*=255,i}return e}}]),t}(),X=function(t){if(!t)return x.kP.Butt;switch(t){case"butt":return x.kP.Butt;case"square":return x.kP.Square;case"round":return x.kP.Round}},D=function(t){if(!t)return x.r4.Miter;switch(t){case"miter":return x.r4.Miter;case"round":return x.r4.Round;case"bevel":return x.r4.Bevel}},Y=function(t){if((0,m.Wi)(t))return"Center";switch(t){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},U=function(t){if((0,m.Wi)(t))return"Center";switch(t){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},W=function(t){return t?[t.r,t.g,t.b,255*t.a]:[0,0,0,0]},B=function(t,e){var i=V(e),r=J(t);return i&&r?"".concat(i,"-").concat(r):"".concat(i).concat(r)},V=function(t){if(!t)return"";switch(t.toLowerCase()){case"bold":case"bolder":return"bold"}return""},J=function(t){if(!t)return"";switch(t.toLowerCase()){case"italic":case"oblique":return"italic"}return""},q=function(t,e){var i="butt"===e;switch(t){case"dash":case"esriSLSDash":return i?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return i?[4,3,1,3]:[3,4,0,4];case"dot":case"esriSLSDot":return i?[1,3]:[0,4];case"long-dash":case"esriSLSLongDash":return i?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return i?[8,3,1,3]:[7,4,0,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return i?[8,3,1,3,1,3]:[7,4,0,4,0,4];case"short-dash":case"esriSLSShortDash":return i?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return i?[4,1,1,1]:[3,2,0,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return i?[4,1,1,1,1,1]:[3,2,0,2,0,2];case"short-dot":case"esriSLSShortDot":return i?[1,1]:[0,2];case"solid":case"esriSLSSolid":case"none":return A.error("Unexpected: style does not require rasterization"),[0,0];default:return A.error("Tried to rasterize SLS, but found an unexpected style: ".concat(t,"!")),[0,0]}};var j,$=function(t){var e,i,r=50,n=t;if("circle"===n||"esriSMSCircle"===n){var a=Math.acos(.995),s=Math.ceil(I/a/4);0===s&&(s=1),a=Z/s,s*=4;var o=[];o.push([r,0]);for(var l=1;l<s;l++)o.push([r*Math.cos(l*a),-r*Math.sin(l*a)]);o.push([r,0]),e={rings:[o]},i={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if("cross"===n||"esriSMSCross"===n){e={rings:[[[0,r],[0,0],[r,0],[r,-0],[0,-0],[0,-r],[-0,-r],[-0,-0],[-r,-0],[-r,0],[-0,0],[-0,r],[0,r]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if("diamond"===n||"esriSMSDiamond"===n)e={rings:[[[-r,0],[0,r],[r,0],[0,-r],[-r,0]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("square"===n||"esriSMSSquare"===n)e={rings:[[[-r,-r],[-r,r],[r,r],[r,-r],[-r,-r]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("x"===n||"esriSMSX"===n){e={rings:[[[0,0],[50,r],[r,50],[0,0],[r,-50],[50,-r],[0,-0],[-50,-r],[-r,-50],[-0,0],[-r,50],[-50,r],[0,0]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if("triangle"===n||"esriSMSTriangle"===n){var h=57.735026918962575,u=-h,c=2/3*100,f=c-100;e={rings:[[[u,f],[0,c],[h,f],[u,f]]]},i={xmin:u,ymin:f,xmax:h,ymax:c}}else"arrow"===n&&(e={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r});return[i,e]},Q=function(t){return"vertical"===t||"horizontal"===t||"cross"===t||"esriSFSCross"===t||"esriSFSVertical"===t||"esriSFSHorizontal"===t},K=function(t){return t?t.charAt(0).toLowerCase()+t.substr(1):t};function tt(t,e,i){t.effects&&!(0,m.pC)(e.geometryEngine)&&(j?i.push(j):(0,M.Cc)(t.effects)&&(j=(0,M.RI)(),i.push(j),j.then((function(t){return e.geometryEngine=t}))))}},691:function(t,e,i){i.d(e,{Z:function(){return a}});var r=i(15671),n=i(43144),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.Z)(this,t),this.x=e,this.y=i,this.width=n,this.height=a}return(0,n.Z)(t,[{key:"isEmpty",get:function(){return this.width<=0||this.height<=0}},{key:"union",value:function(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}]),t}()},6388:function(t,e,i){i.d(e,{Fp:function(){return l},RL:function(){return f},UV:function(){return c},bk:function(){return u}});var r=i(29439),n=i(37762),a=i(46228),s=i(77981),o=i(691);function l(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":var e=t.symbolLayers;return e&&1===e.length?l(e[0]):null;case"CIMVectorMarker":var i,r=t.markerGraphics;if(!r||1!==r.length)return null;var n=r[0];if(!n)return null;var a=n.geometry;if(!a)return null;var s=n.symbol;return!s||"CIMPolygonSymbol"!==s.type&&"CIMLineSymbol"!==s.type||null!==(i=s.symbolLayers)&&void 0!==i&&i.some((function(t){return!!t.effects}))?null:{geom:a,asFill:"CIMPolygonSymbol"===s.type};case"sdf":return{geom:t.geom,asFill:t.asFill}}return null}function h(t){var e,i=1/0,r=-1/0,a=1/0,s=-1/0,o=(0,n.Z)(t);try{for(o.s();!(e=o.n()).done;){var l,h=e.value,u=(0,n.Z)(h);try{for(u.s();!(l=u.n()).done;){var c=l.value;c[0]<i&&(i=c[0]),c[0]>r&&(r=c[0]),c[1]<a&&(a=c[1]),c[1]>s&&(s=c[1])}}catch(f){u.e(f)}finally{u.f()}}}catch(f){o.e(f)}finally{o.f()}return[i,a,r,s]}function u(t){return t?t.rings?h(t.rings):t.paths?h(t.paths):(0,s.YX)(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function c(t,e,i,n,a){var s=(0,r.Z)(t,4),o=s[0],l=s[1],h=s[2],u=s[3];if(h<o||u<l)return[0,0,0];var c=h-o,f=u-l,v=Math.floor(31.5),m=(128-2*(v+1))/Math.max(c,f),p=Math.round(c*m)+2*v,d=Math.round(f*m)+2*v,_=1;e&&(_=d/m/(e.ymax-e.ymin));var y=0,g=0,k=1;n&&(a?e&&i&&e.ymax-e.ymin>0&&(k=(e.xmax-e.xmin)/(e.ymax-e.ymin),y=n.x/(i*k),g=n.y/i):(y=n.x,g=n.y)),y=.5*(e.xmax+e.xmin)+y*(e.xmax-e.xmin),g=.5*(e.ymax+e.ymin)+g*(e.ymax-e.ymin),y-=o,g-=l,y*=m,g*=m;var P=(y+=v)/p-.5,x=(g+=v)/d-.5;return a&&(P*=i*k,x*=i),[_,P,x]}function f(t){var e,i=function(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}(t.geom),a=function(t){var e,i=1/0,r=-1/0,a=1/0,s=-1/0,l=(0,n.Z)(t);try{for(l.s();!(e=l.n()).done;){var h,u=e.value,c=(0,n.Z)(u);try{for(c.s();!(h=c.n()).done;){var f=h.value;f[0]<i&&(i=f[0]),f[0]>r&&(r=f[0]),f[1]<a&&(a=f[1]),f[1]>s&&(s=f[1])}}catch(v){c.e(v)}finally{c.f()}}}catch(v){l.e(v)}finally{l.f()}return new o.Z(i,a,r-i,s-a)}(i),s=Math.floor(31.5),l=(128-2*(s+1))/Math.max(a.width,a.height),h=Math.round(a.width*l)+2*s,u=Math.round(a.height*l)+2*s,c=[],f=(0,n.Z)(i);try{for(f.s();!(e=f.n()).done;){var m=e.value;if(m&&m.length>1){var p,d=[],_=(0,n.Z)(m);try{for(_.s();!(p=_.n()).done;){var y=p.value,g=(0,r.Z)(y,2),k=g[0],P=g[1];k-=a.x,P-=a.y,k*=l,P*=l,k+=s-.5,P+=s-.5,t.asFill?d.push([k,P]):d.push([Math.round(k),Math.round(P)])}}catch(b){_.e(b)}finally{_.f()}if(t.asFill){var x=d.length-1;d[0][0]===d[x][0]&&d[0][1]===d[x][1]||d.push(d[0])}c.push(d)}}}catch(b){f.e(b)}finally{f.f()}var M=function(t,e,i,r){for(var a=e*i,s=new Array(a),o=r*r+1,l=0;l<a;++l)s[l]=o;var h,u=(0,n.Z)(t);try{for(u.s();!(h=u.n()).done;)for(var c=h.value,f=c.length,v=1;v<f;++v){var m=c[v-1],p=c[v],d=void 0,_=void 0,y=void 0,g=void 0;m[0]<p[0]?(d=m[0],_=p[0]):(d=p[0],_=m[0]),m[1]<p[1]?(y=m[1],g=p[1]):(y=p[1],g=m[1]);var k=Math.floor(d)-r,P=Math.floor(_)+r,x=Math.floor(y)-r,M=Math.floor(g)+r;k<0&&(k=0),P>e&&(P=e),x<0&&(x=0),M>i&&(M=i);for(var S=p[0]-m[0],C=p[1]-m[1],w=S*S+C*C,I=k;I<P;I++)for(var Z=x;Z<M;Z++){var N=void 0,L=void 0,A=(I-m[0])*S+(Z-m[1])*C;A<0?(N=m[0],L=m[1]):A>w?(N=p[0],L=p[1]):(A/=w,N=m[0]+A*S,L=m[1]+A*C);var T=(I-N)*(I-N)+(Z-L)*(Z-L),z=(i-Z-1)*e+I;T<s[z]&&(s[z]=T)}}}catch(b){u.e(b)}finally{u.f()}for(var E=0;E<a;++E)s[E]=Math.sqrt(s[E]);return s}(c,h,u,s);return t.asFill&&function(t,e,i,r,a){var s,o=(0,n.Z)(t);try{for(o.s();!(s=o.n()).done;)for(var l=s.value,h=l.length,u=1;u<h;++u){var c=l[u-1],f=l[u],v=void 0,m=void 0,p=void 0,d=void 0;c[0]<f[0]?(v=c[0],m=f[0]):(v=f[0],m=c[0]),c[1]<f[1]?(p=c[1],d=f[1]):(p=f[1],d=c[1]);var _=Math.floor(v),y=Math.floor(m)+1,g=Math.floor(p),k=Math.floor(d)+1;_<r&&(_=r),y>e-r&&(y=e-r),g<r&&(g=r),k>i-r&&(k=i-r);for(var P=g;P<k;++P)if(c[1]>P!=f[1]>P){for(var x=(i-P-1)*e,M=_;M<y;++M)M<(f[0]-c[0])*(P-c[1])/(f[1]-c[1])+c[0]&&(a[x+M]=-a[x+M]);for(var S=r;S<_;++S)a[x+S]=-a[x+S]}}}catch(b){o.e(b)}finally{o.f()}}(c,h,u,s,M),[v(M,s),h,u]}function v(t,e){for(var i=2*e,r=t.length,n=new Uint8Array(4*r),s=0;s<r;++s){var o=.5-t[s]/i;(0,a.I)(o,n,4*s)}return n}},22532:function(t,e,i){i.d(e,{Z:function(){return o}});var r=i(37762),n=i(15671),a=i(43144),s=i(17842);var o=function(){function t(e){(0,n.Z)(this,t),e&&(this._textRasterizationCanvas=e)}return(0,a.Z)(t,[{key:"rasterizeText",value:function(t,e){var i;this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var n=this._textRasterizationCanvas,a=n.getContext("2d");this._setFontProperties(a,e),this._parameters=e,this._textLines=t.split(/\r?\n/),this._lineHeight=this._computeLineHeight();var s=this._computeTextWidth(a,e),o=e.font,l=o.decoration,h=o.weight;this._lineThroughWidthOffset=l&&"line-through"===l?.1*this._lineHeight:0;var u=this._lineHeight*this._textLines.length;n.width=s+2*this._lineThroughWidthOffset,n.height=u,this._renderedLineHeight=Math.round(this._lineHeight*e.pixelRatio),this._renderedHaloSize=e.halo.size*e.pixelRatio,this._renderedWidth=s*e.pixelRatio,this._renderedHeight=u*e.pixelRatio,this._lineThroughWidthOffset*=e.pixelRatio;var c=null!==(i=e.color)&&void 0!==i?i:[0,0,0,0],f=e.halo&&e.halo.color?e.halo.color:[0,0,0,0];this._fillStyle=function(t){return"rgba(".concat(t.slice(0,3).toString(),",").concat(t[3],")")}(c),this._haloStyle=function(t){return"rgb(".concat(t.slice(0,3).toString(),")")}(f);var v=this._renderedLineHeight,m=this._renderedHaloSize;a.save(),a.clearRect(0,0,n.width,n.height),this._setFontProperties(a,e);var p=function(t,e){return"center"===t?.5*e:"right"===t?e:0}(a.textAlign,this._renderedWidth)+m,d=m,_=m>0,y=this._lineThroughWidthOffset,g=0;_&&this._renderHalo(a,p,d,y,g,e),g+=d,y+=p;var k,P=(0,r.Z)(this._textLines);try{for(P.s();!(k=P.n()).done;){var x=k.value;_?(a.globalCompositeOperation="destination-out",a.fillStyle="rgb(0, 0, 0)",a.fillText(x,y,g),a.globalCompositeOperation="source-over",a.fillStyle=this._fillStyle,a.fillText(x,y,g)):(a.fillStyle=this._fillStyle,a.fillText(x,y,g)),l&&"none"!==l&&this._renderDecoration(a,y,g,l,h),g+=v}}catch(L){P.e(L)}finally{P.f()}a.restore();var M,b,S=this._renderedWidth+2*this._lineThroughWidthOffset,C=this._renderedHeight,w=a.getImageData(0,0,S,C),I=new Uint8Array(w.data);if(e.premultiplyColors)for(var Z,N=0;N<I.length;N+=4)Z=I[N+3]/255,I[N]=I[N]*Z,I[N+1]=I[N+1]*Z,I[N+2]=I[N+2]*Z;switch(e.horizontalAlignment){case"left":M=-.5;break;case"right":M=.5;break;default:M=0}switch(e.verticalAlignment){case"bottom":b=-.5;break;case"top":b=.5;break;default:b=0}return{size:[S,C],image:new Uint32Array(I.buffer),sdf:!1,simplePattern:!1,anchorX:M,anchorY:b,canvas:n}}},{key:"_renderHalo",value:function(t,e,i,r,n,a){var s=this._renderedWidth,o=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=s,this._haloRasterizationCanvas.height=o;var l=this._haloRasterizationCanvas,h=l.getContext("2d");h.clearRect(0,0,s,o),this._setFontProperties(h,a);var u=a.font,c=u.decoration,f=u.weight;h.fillStyle=this._haloStyle,h.strokeStyle=this._haloStyle,h.lineJoin="round",this._renderHaloNative(h,e,i,c,f),t.globalAlpha=this._parameters.halo.color[3],t.drawImage(l,0,0,s,o,r,n,s,o),t.globalAlpha=1}},{key:"_renderHaloNative",value:function(t,e,i,n,a){var s,o=this._renderedLineHeight,l=this._renderedHaloSize,h=(0,r.Z)(this._textLines);try{for(h.s();!(s=h.n()).done;){for(var u=s.value,c=2*l,f=0;f<5;f++){var v=(.6+.1*f)*c;t.lineWidth=v,t.strokeText(u,e,i),n&&"none"!==n&&this._renderDecoration(t,e,i,n,a,v)}i+=o}}catch(m){h.e(m)}finally{h.f()}}},{key:"_setFontProperties",value:function(t,e){var i,r=Math.max(e.size,.5),n=e.font,a="".concat(n.style," ").concat(n.weight," ").concat((0,s.F2)(r*e.pixelRatio).toFixed(1),"px ").concat(n.family,", sans-serif");switch(t.font=a,t.textBaseline="top",e.horizontalAlignment){case"left":default:i="left";break;case"right":i="right";break;case"center":i="center"}t.textAlign=i}},{key:"computeTextSize",value:function(t,e){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var i=this._textRasterizationCanvas,r=i.getContext("2d");this._setFontProperties(r,e),this._parameters=e,this._textLines=t.split(/\r?\n/),this._lineHeight=this._computeLineHeight();var n=this._computeTextWidth(r,e),a=this._lineHeight*this._textLines.length;return i.width=n,i.height=a,[n*e.pixelRatio,a*e.pixelRatio]}},{key:"_computeTextWidth",value:function(t,e){var i,n=0,a=(0,r.Z)(this._textLines);try{for(a.s();!(i=a.n()).done;){var s=i.value;n=Math.max(n,t.measureText(s).width)}}catch(l){a.e(l)}finally{a.f()}var o=e.font;return("italic"===o.style||"oblique"===o.style||"string"==typeof o.weight&&("bold"===o.weight||"bolder"===o.weight)||"number"==typeof o.weight&&o.weight>600)&&(n+=.3*t.measureText("w").width),n+=2*this._parameters.halo.size,Math.round(n)}},{key:"_computeLineHeight",value:function(){var t=1.275*this._parameters.size,e=this._parameters.font.decoration;return e&&"underline"===e&&(t*=1.3),Math.round(t+2*this._parameters.halo.size)}},{key:"_renderDecoration",value:function(t,e,i,r,n,a){var s=.9*this._lineHeight,o="bold"===n?.06:"bolder"===n?.09:.04;switch(t.textAlign){case"center":e-=this._renderedWidth/2;break;case"right":e-=this._renderedWidth}var l=t.textBaseline;if("underline"===r)switch(l){case"top":i+=s;break;case"middle":i+=s/2}else if("line-through"===r)switch(l){case"top":i+=s/1.5;break;case"middle":i+=s/3}var h=a?1.5*a:Math.ceil(s*o);t.save(),t.beginPath(),t.strokeStyle=t.fillStyle,t.lineWidth=h,t.moveTo(e-this._lineThroughWidthOffset,i),t.lineTo(e+this._renderedWidth+2*this._lineThroughWidthOffset,i),t.stroke(),t.restore()}}]),t}()},98991:function(t,e,i){i.d(e,{S:function(){return it},c:function(){return T}});var r=i(74165),n=i(1413),a=i(37762),s=i(29439),o=i(93433),l=i(15861),h=i(51995),u=i(82272),c=i(84652),f=i(32718),v=i(92026),m=i(17842),p=i(643),d=i(819),_=i(78915),y=i(48202);function g(t){return.05*Math.max(Math.round(t/.05),1)}var k=new Set(["StartTimeOffset","Duration","RepeatDelay"]);function P(t,e){return k.has(e)?g(t):t}var x=i(6388),M=i(31027),b=i(95954),S=i(91935),C=i(94109),w=i(93592),I=f.Z.getLogger("esri.symbols.cim.cimAnalyzer");function Z(t){switch(t){case"Butt":return y.RL.BUTT;case"Square":return y.RL.SQUARE;default:return y.RL.ROUND}}function N(t){switch(t){case"Bevel":return y.AH.BEVEL;case"Miter":return y.AH.MITER;default:return y.AH.ROUND}}function L(t,e,i,r){var n;t[e]?n=t[e]:(n={},t[e]=n),n[i]=r}function A(t){var e=t.markerPlacement;return e&&e.angleToLine?y.v2.MAP:y.v2.SCREEN}function T(t,e,i,r,n){return z.apply(this,arguments)}function z(){return z=(0,l.Z)((0,r.Z)().mark((function t(e,i,n,s,o){var l,h,u,c,f,m,p,y,g;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=null!==s&&void 0!==s?s:[],e){t.next=3;break}return t.abrupt("return",l);case 3:if(c={},"CIMSymbolReference"===e.type){t.next=6;break}return t.abrupt("return",(I.error("Expect cim type to be 'CIMSymbolReference'"),l));case 6:if(h=e.symbol,!(u=e.primitiveOverrides)){t.next=14;break}f=[],m=(0,a.Z)(u);try{for(y=function(){var t=p.value,e=t.valueExpressionInfo;if(e&&i){var r=e.expression,n=(0,d.Yi)(r,i.spatialReference,i.fields).then((function(e){(0,v.Wi)(e)||L(c,t.primitiveName,t.propertyName,e)}));f.push(n)}else null!=t.value&&L(c,t.primitiveName,t.propertyName,t.value)},m.s();!(p=m.n()).done;)y()}catch(r){m.e(r)}finally{m.f()}if(t.t0=f.length>0,!t.t0){t.next=14;break}return t.next=14,Promise.all(f);case 14:if(g=[],_.B$.fetchResources(h,n,g),t.t2=g.length>0,!t.t2){t.next=20;break}return t.next=20,Promise.all(g);case 20:t.t1=h.type,t.next="CIMPointSymbol"===t.t1||"CIMLineSymbol"===t.t1||"CIMPolygonSymbol"===t.t1?23:24;break;case 23:E(h,u,c,i,l,n,o);case 24:return t.abrupt("return",l);case 25:case"end":return t.stop()}}),t)}))),z.apply(this,arguments)}function E(t,e,i,r,n,a,s){if(t){var l=t.symbolLayers;if(l){var h,u=t.effects,c=_.B$.getSize(t);"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(h=y.v2.MAP);for(var f=l.length;f--;){var v,m=l[f];if(m&&!1!==m.enable){var p=void 0;u&&u.length&&(p=(0,o.Z)(u));var d=m.effects;d&&d.length&&(u?(v=p).push.apply(v,(0,o.Z)(d)):p=(0,o.Z)(d));var g,k=[];_.E0.findEffectOverrides(p,e,k),g=k.length>0?K(p,k,i,r):p;var P=[];switch(_.E0.findApplicableOverrides(m,e,P),m.type){case"CIMSolidFill":O(m,g,i,P,r,n);break;case"CIMPictureFill":R(m,g,i,P,r,a,n);break;case"CIMHatchFill":F(m,g,i,P,r,n);break;case"CIMGradientFill":G(m,g,i,P,r,n);break;case"CIMSolidStroke":H(m,g,i,P,r,n,"CIMPolygonSymbol"===t.type,c);break;case"CIMPictureStroke":X(m,g,i,P,r,n,"CIMPolygonSymbol"===t.type,c);break;case"CIMGradientStroke":D(m,g,i,P,r,n,"CIMPolygonSymbol"===t.type,c);break;case"CIMCharacterMarker":if(Y(m,g,i,P,r,n))break;break;case"CIMPictureMarker":if(Y(m,g,i,P,r,n))break;"CIMLineSymbol"===t.type&&(h=A(m)),U(m,g,i,P,r,a,n,h,c);break;case"CIMVectorMarker":if(Y(m,g,i,P,r,n))break;"CIMLineSymbol"===t.type&&(h=A(m)),W(m,g,i,P,r,n,a,h,c,s);break;default:I.error("Cannot analyze CIM layer",m.type)}}}}}}function O(t,e,i,r,n,a){var o=t.primitiveName,l=(0,M.NO)(t.color),h=rt(r,o,e,null,null),u=(0,s.Z)(h,2),c=u[0],f=u[1],v=(0,p.hP)(JSON.stringify(t)+f).toString();a.push({type:"fill",templateHash:v,materialHash:c?function(){return v}:v,cim:t,materialOverrides:null,colorLocked:t.colorLocked,color:$(o,i,"Color",n,l,j),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e,applyRandomOffset:!1,sampleAlphaOnly:!0})}function R(t,e,i,r,n,a,o){var l=t.primitiveName,h=t.tintColor?(0,M.NO)(t.tintColor):{r:255,g:255,b:255,a:1},u=rt(r,l,e,null,null),c=(0,s.Z)(u,2),f=c[0],m=c[1],d=(0,p.hP)(JSON.stringify(t)+m).toString(),_=(0,p.hP)("".concat(t.url).concat(JSON.stringify(t.colorSubstitutions))).toString(),y=(0,M.NA)(t.scaleX);if("width"in t){var g=t.width,k=1,P=a.getResource(t.url);(0,v.pC)(P)&&(k=P.width/P.height),y/=k*(t.height/g)}o.push({type:"fill",templateHash:d,materialHash:f?function(){return _}:_,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:e,color:$(l,i,"TintColor",n,h,j),height:$(l,i,"Height",n,t.height),scaleX:$(l,i,"ScaleX",n,y),angle:$(l,i,"Rotation",n,(0,M.NA)(t.rotation)),offsetX:$(l,i,"OffsetX",n,(0,M.NA)(t.offsetX)),offsetY:$(l,i,"OffsetY",n,(0,M.NA)(t.offsetY)),url:t.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function F(t,e,i,r,n,a){var o=["Rotation","OffsetX","OffsetY"],l=r.filter((function(e){return e.primitiveName!==t.primitiveName||!o.includes(e.propertyName)})),h=t.primitiveName,u=rt(r,h,e,null,null),c=(0,s.Z)(u,2),f=c[0],v=c[1],m=(0,p.hP)(JSON.stringify(t)+v).toString(),d=(0,p.hP)("".concat(t.separation).concat(JSON.stringify(t.lineSymbol))).toString(),_={r:255,g:255,b:255,a:1};if(t.lineSymbol){var y,g=null===(y=t.lineSymbol)||void 0===y?void 0:y.symbolLayers.find((function(t){return"CIMSolidStroke"===t.type}));g&&(_=(0,M.NO)(g.color))}a.push({type:"fill",templateHash:m,materialHash:f?et(d,i,l,n):d,cim:t,materialOverrides:l,colorLocked:t.colorLocked,effects:e,color:_,height:$(h,i,"Separation",n,t.separation),scaleX:1,angle:$(h,i,"Rotation",n,(0,M.NA)(t.rotation)),offsetX:$(h,i,"OffsetX",n,(0,M.NA)(t.offsetX)),offsetY:$(h,i,"OffsetY",n,(0,M.NA)(t.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}function G(t,e,i,r,n,a){var o=rt(r,t.primitiveName,e,null,null),l=(0,s.Z)(o,2),h=l[0],u=l[1],c=(0,p.hP)(JSON.stringify(t)+u).toString();a.push({type:"fill",templateHash:c,materialHash:h?et(c,i,r,n):c,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:e,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}function H(t,e,i,r,n,a,l,h){var u,c,f=t.primitiveName,v=(0,M.NO)(t.color),m=void 0!==t.width?t.width:4,d=Z(t.capStyle),_=N(t.joinStyle),y=t.miterLimit,g=rt(r,f,e,null,null),k=(0,s.Z)(g,2),P=k[0],x=k[1],b=(0,p.hP)(JSON.stringify(t)+x).toString();if(e&&e instanceof Array&&e.length>0){var S=e[e.length-1];if("CIMGeometricEffectDashes"===S.type&&"NoConstraint"===S.lineDashEnding&&null===S.offsetAlongLine){var C=(e=(0,o.Z)(e)).pop();u=C.dashTemplate,c=C.scaleDash}}a.push({type:"line",templateHash:b,materialHash:P?function(){return b}:b,cim:t,materialOverrides:null,isOutline:l,colorLocked:t.colorLocked,effects:e,color:$(f,i,"Color",n,v,j),width:$(f,i,"Width",n,m),cap:$(f,i,"CapStyle",n,d),join:$(f,i,"JoinStyle",n,_),miterLimit:$(f,i,"MiterLimit",n,y),referenceWidth:h,zOrder:q(t.name),dashTemplate:u,scaleDash:c,sampleAlphaOnly:!0})}function X(t,e,i,r,n,a,o,l){var h=(0,p.hP)("".concat(t.url).concat(JSON.stringify(t.colorSubstitutions))).toString(),u=t.primitiveName,c=(0,M.NO)(t.tintColor),f=void 0!==t.width?t.width:4,v=Z(t.capStyle),m=N(t.joinStyle),d=t.miterLimit,_=rt(r,u,e,null,null),y=(0,s.Z)(_,2),g=y[0],k=y[1],P=(0,p.hP)(JSON.stringify(t)+k).toString();a.push({type:"line",templateHash:P,materialHash:g?function(){return h}:h,cim:t,materialOverrides:null,isOutline:o,colorLocked:t.colorLocked,effects:e,color:$(u,i,"TintColor",n,c,j),width:$(u,i,"Width",n,f),cap:$(u,i,"CapStyle",n,v),join:$(u,i,"JoinStyle",n,m),miterLimit:$(u,i,"MiterLimit",n,d),referenceWidth:l,zOrder:q(t.name),dashTemplate:null,scaleDash:!1,url:t.url,sampleAlphaOnly:!1})}function D(t,e,i,r,n,a,o,l){var h=t.primitiveName,u=void 0!==t.width?t.width:4,c=Z(t.capStyle),f=N(t.joinStyle),v=t.miterLimit,m=rt(r,h,e,null,null),d=(0,s.Z)(m,2),_=d[0],y=d[1],g=(0,p.hP)(JSON.stringify(t)+y).toString();a.push({type:"line",templateHash:g,materialHash:_?et(g,i,r,n):g,cim:t,materialOverrides:null,isOutline:o,colorLocked:t.colorLocked,effects:e,color:{r:128,g:128,b:128,a:1},width:$(h,i,"Width",n,u),cap:$(h,i,"CapStyle",n,c),join:$(h,i,"JoinStyle",n,f),miterLimit:$(h,i,"MiterLimit",n,v),referenceWidth:l,zOrder:q(t.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}function Y(t,e,i,r,n,a){var o=t.markerPlacement;if(!o||"CIMMarkerPlacementInsidePolygon"!==o.type)return!1;var l=o,h=Math.abs(l.stepX),u=Math.abs(l.stepY);if(0===h||0===u)return!0;var c,f,v=["Rotation","OffsetX","OffsetY"],d=r.filter((function(e){return e.primitiveName!==t.primitiveName||!v.includes(e.propertyName)})),_="url"in t?t.url:null,y=rt(r,l.primitiveName,e,null,null),g=(0,s.Z)(y,2),k=g[0],P=g[1],x=(0,p.hP)(JSON.stringify(t)+P).toString(),b=null;if("Random"===o.gridType){var S=(0,m.Wz)(C.C1),w=Math.max(Math.floor(S/h),1),I=Math.max(Math.floor(S/u),1);b=function(t){return t?t*I:0},f=w*h/(c=u*I)}else o.shiftOddRows?(c=2*u,b=function(t){return t?2*t:0},f=h/u*.5):(c=u,b=null,f=h/u);var Z={r:255,g:255,b:255,a:1};return"tintColor"in t&&(Z=(0,M.NO)(t.tintColor)),a.push({type:"fill",templateHash:x,materialHash:k?et(x,i,d,n):x,cim:t,materialOverrides:d,colorLocked:t.colorLocked,effects:e,color:$(l.primitiveName,i,"TintColor",n,Z,j),height:$(l.primitiveName,i,"StepY",n,c,b),scaleX:f,angle:$(l.primitiveName,i,"GridAngle",n,l.gridAngle),offsetX:$(l.primitiveName,i,"OffsetX",n,(0,M.NA)(l.offsetX)),offsetY:$(l.primitiveName,i,"OffsetY",n,(0,M.NA)(l.offsetY)),url:_,applyRandomOffset:"Random"===o.gridType,sampleAlphaOnly:!_}),!0}function U(t,e,i,r,n,o,l,h,u){var f,m=t.primitiveName,y=(0,M.NA)(t.size),g=(0,M.NA)(t.scaleX,1),k=(0,M.NA)(t.rotation),x=(0,M.NA)(t.offsetX),b=(0,M.NA)(t.offsetY),C=t.tintColor?(0,M.NO)(t.tintColor):{r:255,g:255,b:255,a:1},I=(0,p.hP)("".concat(t.url).concat(JSON.stringify(t.colorSubstitutions)).concat(JSON.stringify(t.animatedSymbolProperties))).toString(),Z=tt(t.markerPlacement,r,i,n),N=function(t,e,i,r){var n=[];if(_.E0.findApplicableOverrides(t,e,n),0===n.length)return t;for(var s=0,o=n;s<o.length;s++){var l=o[s];l.valueExpressionInfo&&function(){var t=i[l.primitiveName]&&i[l.primitiveName][l.propertyName];t instanceof d.mz&&(l.fn=function(e,i,n){return(0,S.Z)(t,e,{$view:n},r.geometryType,i)})}()}return function(e,i,r){var s,o=(0,a.Z)(n);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.fn&&(l.value=l.fn(e,i,r))}}catch(_){o.e(_)}finally{o.f()}var h,u=(0,c.d9)(t),f=t.primitiveName,v=(0,a.Z)(n);try{for(v.s();!(h=v.n()).done;){var m=h.value;if(m.primitiveName===f){var p=Q(m.propertyName);if(null!=m.value){var d=P(m.value,m.propertyName);d!==u[p]&&(u[p]=d)}}}}catch(_){v.e(_)}finally{v.f()}return u}}(t.animatedSymbolProperties,r,i,n),L=rt(r,m,e,Z,N),A=(0,s.Z)(L,2),T=A[0],z=A[1],E=(0,p.hP)(JSON.stringify(t)+z).toString(),O=null!==(f=t.anchorPoint)&&void 0!==f?f:{x:0,y:0};if("width"in t){var R=t.width,F=1,G=o.getResource(t.url);(0,v.pC)(G)&&(F=G.width/G.height),g/=F*(y/R)}function H(t,e){return(0,M.hf)(N,t,e)}var X=t.animatedSymbolProperties&&!0===t.animatedSymbolProperties.randomizeStartTime?function(t,e,i,r){var n=(0,w.$)(r),a=H(t,e);return I+"-MATERIALGROUP(".concat(n,")")+"-ASP(".concat(JSON.stringify(a),")")}:T?function(t,e){var i=H(t,e);return I+"-ASP(".concat(JSON.stringify(i),")")}:I;l.push({type:"marker",templateHash:E,materialHash:X,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:e,scaleSymbolsProportionally:!1,alignment:h,size:$(m,i,"Size",n,y),scaleX:$(m,i,"ScaleX",n,g),rotation:$(m,i,"Rotation",n,k),offsetX:$(m,i,"OffsetX",n,x),offsetY:$(m,i,"OffsetY",n,b),color:$(m,i,"TintColor",n,C,j),anchorPoint:{x:O.x,y:-O.y},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:t.rotateClockwise,referenceSize:u,sizeRatio:1,markerPlacement:Z,url:t.url,animatedSymbolProperties:N})}function W(t,e,i,r,n,s,o,l,h,u){var c=t.markerGraphics;if(c){var f=0;if(t.scaleSymbolsProportionally){var v=t.frame;v&&(f=v.ymax-v.ymin)}var m,p=tt(t.markerPlacement,r,i,n),d=(0,a.Z)(c);try{for(d.s();!(m=d.n()).done;){var _=m.value;if(_){var y=_.symbol;if(!y)continue;switch(y.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":V(t,e,p,null,_,r,i,n,s,o,l,h,f,u);break;case"CIMTextSymbol":B(t,e,p,_,i,r,n,s,l,h,f)}}}}catch(g){d.e(g)}finally{d.f()}}}function B(t,e,i,r,a,o,l,h,c,f,v){_.E0.findApplicableOverrides(r,o,[]);var m=r.geometry;if("x"in m&&"y"in m){var d=r.symbol,y=(0,M.BX)(d),g=(0,M.wi)(d.fontStyleName),k=(0,u.BN)(d.fontFamilyName);d.font=(0,n.Z)({family:k,decoration:y},g);var P=t.frame,x=m.x-.5*(P.xmin+P.xmax),b=m.y-.5*(P.ymin+P.ymax),S=t.size/v,C=t.primitiveName,w=(0,M.NA)(d.height)*S,I=(0,M.NA)(d.angle),Z=(0,M.NA)(t.offsetX)+((0,M.NA)(d.offsetX)+x)*S,N=(0,M.NA)(t.offsetY)+((0,M.NA)(d.offsetY)+b)*S,L=(0,M.NO)((0,M.W7)(d)),A=(0,M.NO)((0,M.$Z)(d)),T=(0,M.F)(d);T||(A=(0,M.NO)((0,M.W7)(d.haloSymbol)),T=d.haloSize*S);var z=rt(o,C,e,i,null),E=(0,s.Z)(z,2),O=E[0],R=E[1],F=JSON.stringify(t.effects)+Number(t.colorLocked).toString()+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement)+t.size.toString(),G=(0,p.hP)(JSON.stringify(r)+F+R).toString(),H=$(r.primitiveName,a,"TextString",l,r.textString,M.QI,d.textCase);if(null!=H){var X=d.fontStyleName,D=k+(X?"-"+X.toLowerCase():"-regular"),Y=D;"string"==typeof H&&H.includes("[")&&d.fieldMap&&(H=(0,M.Qs)(d.fieldMap,H,d.textCase)),h.push({type:"text",templateHash:G,materialHash:O||"function"==typeof H||H.match(/\[(.*?)\]/)?function(t,e,i){return Y+"-"+(0,M.hf)(H,t,e,i)}:Y+"-"+(0,p.hP)(H),cim:d,materialOverrides:null,colorLocked:t.colorLocked,effects:e,alignment:c,anchorPoint:{x:t.anchorPoint?t.anchorPoint.x:0,y:t.anchorPoint?t.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:D,decoration:y,weight:$(C,a,"Weight",l,g.weight),style:$(C,a,"Size",l,g.style),size:$(C,a,"Size",l,w),angle:$(C,a,"Rotation",l,I),offsetX:$(C,a,"OffsetX",l,Z),offsetY:$(C,a,"OffsetY",l,N),horizontalAlignment:(0,M.X_)(d.horizontalAlignment),verticalAlignment:(0,M.FG)(d.verticalAlignment),text:H,color:L,outlineColor:A,outlineSize:T,referenceSize:f,sizeRatio:1,markerPlacement:i})}}}function V(t,e,i,r,o,l,h,u,c,f,m,d,_,y){var g=o.symbol,k=g.symbolLayers;if(k)if(y)J(t,e,i,r,o,h,l,u,c,f,m,d,_);else{var P=k.length;if(nt(k))!function(t,e,i,r,o,l,h,u,c,f,v,m,d){var _=o.geometry,y=l[0],g=l[1],k=(0,x.bk)(_);if(!k)return;var P,b="Relative"!==t.anchorPointUnits,S=(0,x.UV)(k,t.frame,t.size,t.anchorPoint,b),C=(0,s.Z)(S,3),w=C[0],I=C[1],Z=C[2],N={type:"sdf",geom:_,asFill:!0},L=t.primitiveName,A=(0,M.NA)(t.size),T=(0,M.NA)(t.rotation),z=(0,M.NA)(t.offsetX),E=(0,M.NA)(t.offsetY),O=g.path,R=g.primitiveName,F=y.primitiveName,G=(0,M.NO)((0,M.W7)(g)),H=(0,M.NO)((0,M.$Z)(y)),X=(0,M.F)(y),D=!1,Y="",U=(0,a.Z)(h);try{for(U.s();!(P=U.n()).done;){var W=P.value;W.primitiveName!==R&&W.primitiveName!==F&&W.primitiveName!==L||(void 0!==W.value?Y+="-".concat(W.primitiveName,"-").concat(W.propertyName,"-").concat(JSON.stringify(W.value)):W.valueExpressionInfo&&(D=!0))}}catch(q){U.e(q)}finally{U.f()}var B=JSON.stringify((0,n.Z)((0,n.Z)({},t),{},{markerGraphics:null})),V=(0,p.hP)(JSON.stringify(N)+O).toString(),J={type:"marker",templateHash:(0,p.hP)(JSON.stringify(o)+JSON.stringify(g)+JSON.stringify(y)+B+Y).toString(),materialHash:D?function(){return V}:V,cim:N,materialOverrides:null,colorLocked:t.colorLocked,effects:e,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:v,anchorPoint:{x:I,y:Z},isAbsoluteAnchorPoint:b,size:$(t.primitiveName,u,"Size",c,A),rotation:$(t.primitiveName,u,"Rotation",c,T),offsetX:$(t.primitiveName,u,"OffsetX",c,z),offsetY:$(t.primitiveName,u,"OffsetY",c,E),scaleX:1,frameHeight:d,rotateClockwise:t.rotateClockwise,referenceSize:m,sizeRatio:w,color:$(R,u,"Color",c,G,j),outlineColor:$(F,u,"Color",c,H,j),outlineWidth:$(F,u,"Width",c,X),markerPlacement:i,path:O,animatedSymbolProperties:r};f.push(J)}(t,e,i,r,o,k,l,h,u,c,m,d,_);else{var S=b.j.applyEffects(g.effects,o.geometry,f.geometryEngine);if(S)for(;P--;){var C=k[P];if(C&&!1!==C.enable)switch(C.type){case"CIMSolidFill":case"CIMSolidStroke":var w=function(){var y,g=b.j.applyEffects(C.effects,S,f.geometryEngine),k=(0,x.bk)(g);if(!k)return"continue";var P="Relative"!==t.anchorPointUnits,w=(0,x.UV)(k,t.frame,t.size,t.anchorPoint,P),I=(0,s.Z)(w,3),Z=I[0],N=I[1],L=I[2],A="CIMSolidFill"===C.type,T={type:"sdf",geom:g,asFill:A},z=t.primitiveName,E=null!==(y=(0,M.NA)(t.size))&&void 0!==y?y:10,O=(0,M.NA)(t.rotation),R=(0,M.NA)(t.offsetX),F=(0,M.NA)(t.offsetY),G=C.path,H=C.primitiveName,X=(0,M.NO)(A?(0,M.W7)(C):(0,M.$Z)(C)),D=A?{r:0,g:0,b:0,a:0}:(0,M.NO)((0,M.$Z)(C)),Y=(0,M.F)(C);if(!A&&!Y)return"break";var U,W=!1,B="",V=(0,a.Z)(l);try{for(V.s();!(U=V.n()).done;){var J=U.value;J.primitiveName!==H&&J.primitiveName!==z||(void 0!==J.value?B+="-".concat(J.primitiveName,"-").concat(J.propertyName,"-").concat(JSON.stringify(J.value)):J.valueExpressionInfo&&(W=!0))}}catch(tt){V.e(tt)}finally{V.f()}(0,v.pC)(e)&&"function"==typeof e&&(W=!0);var q=JSON.stringify((0,n.Z)((0,n.Z)({},t),{},{markerGraphics:null})),Q=(0,p.hP)(JSON.stringify(T)+G).toString(),K={type:"marker",templateHash:(0,p.hP)(JSON.stringify(o)+JSON.stringify(C)+q+B).toString(),materialHash:W?function(){return Q}:Q,cim:T,materialOverrides:null,colorLocked:t.colorLocked,effects:e,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:m,anchorPoint:{x:N,y:L},isAbsoluteAnchorPoint:P,size:$(t.primitiveName,h,"Size",u,E),rotation:$(t.primitiveName,h,"Rotation",u,O),offsetX:$(t.primitiveName,h,"OffsetX",u,R),offsetY:$(t.primitiveName,h,"OffsetY",u,F),scaleX:1,frameHeight:_,rotateClockwise:t.rotateClockwise,referenceSize:d,sizeRatio:Z,color:$(H,h,"Color",u,X,j),outlineColor:$(H,h,"Color",u,D,j),outlineWidth:$(H,h,"Width",u,Y),markerPlacement:i,animatedSymbolProperties:r,path:G};return c.push(K),"break"}();if("continue"===w)continue;if("break"===w)break;default:J(t,e,i,r,o,h,l,u,c,f,m,d,_)}}}}}function J(t,e,i,r,n,o,l,h,u,c,f,d,y){var g,k=function(t,e){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[e],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath}}(t,n),P=["Rotation","OffsetX","OffsetY"],x=l.filter((function(e){return e.primitiveName!==t.primitiveName||!P.includes(e.propertyName)})),b="",S=(0,a.Z)(l);try{for(S.s();!(g=S.n()).done;){var C=g.value;void 0!==C.value&&(b+="-".concat(C.primitiveName,"-").concat(C.propertyName,"-").concat(JSON.stringify(C.value)))}}catch(F){S.e(F)}finally{S.f()}var w=_.B$.getTextureAnchor(k,c),I=(0,s.Z)(w,3),Z=I[0],N=I[1],L=I[2],A=t.primitiveName,T=(0,M.NA)(t.rotation),z=(0,M.NA)(t.offsetX),E=(0,M.NA)(t.offsetY),O=(0,p.hP)(JSON.stringify(k)+b).toString(),R={type:"marker",templateHash:O,materialHash:x.length>0||(0,v.pC)(e)&&"function"==typeof e?et(O,o,x,h):O,cim:k,materialOverrides:x,colorLocked:t.colorLocked,effects:e,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:f,anchorPoint:{x:Z,y:N},isAbsoluteAnchorPoint:!1,size:t.size,rotation:$(A,o,"Rotation",h,T),offsetX:$(A,o,"OffsetX",h,z),offsetY:$(A,o,"OffsetY",h,E),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:y,rotateClockwise:t.rotateClockwise,referenceSize:d,sizeRatio:L/(0,m.F2)(t.size),markerPlacement:i,animatedSymbolProperties:r};u.push(R)}function q(t){if(t&&0===t.indexOf("Level_")){var e=parseInt(t.substr(6),10);if(!isNaN(e))return e}return 0}function j(t){if(!t||0===t.length)return null;var e=new h.Z(t).toRgba();return{r:e[0],g:e[1],b:e[2],a:e[3]}}function $(t,e,i,r,n,a,s){var o=e[t];if(o){var l=o[i];if("string"==typeof l||"number"==typeof l||l instanceof Array)return a?a.call(null,l,s):l;if(null!=l&&l instanceof d.mz)return function(t,e,i){var o=(0,S.Z)(l,t,{$view:i},r.geometryType,e);return null!==o&&a&&(o=a.call(null,o,s)),null!==o?o:n}}return n}function Q(t){return t?t.charAt(0).toLowerCase()+t.substr(1):t}function K(t,e,i,r){var n,s=(0,a.Z)(e);try{for(s.s();!(n=s.n()).done;){var o=n.value;o.valueExpressionInfo&&function(){var t=i[o.primitiveName]&&i[o.primitiveName][o.propertyName];t instanceof d.mz&&(o.fn=function(e,i,n){return(0,S.Z)(t,e,{$view:n},r.geometryType,i)})}()}}catch(l){s.e(l)}finally{s.f()}return function(i,r,n){var s,o=(0,a.Z)(e);try{for(o.s();!(s=o.n()).done;){var h=s.value;h.fn&&(h.value=h.fn(i,r,n))}}catch(l){o.e(l)}finally{o.f()}var u,f=[],v=(0,a.Z)(t);try{for(v.s();!(u=v.n()).done;){var m,p=u.value,d=null===(m=p)||void 0===m?void 0:m.primitiveName;if(d){var _,y=!1,g=(0,a.Z)(e);try{for(g.s();!(_=g.n()).done;){var k=_.value;if(k.primitiveName===d){var P=Q(k.propertyName);null!=k.value&&k.value!==p[P]&&(y||(p=(0,c.d9)(p),y=!0),p[P]=k.value)}}}catch(l){g.e(l)}finally{g.f()}}f.push(p)}}catch(l){v.e(l)}finally{v.f()}return f}}function tt(t,e,i,r){var n=[];if(_.E0.findApplicableOverrides(t,e,n),0===n.length)return t;for(var s=0,o=n;s<o.length;s++){var l=o[s];l.valueExpressionInfo&&function(){var t=i[l.primitiveName]&&i[l.primitiveName][l.propertyName];t instanceof d.mz&&(l.fn=function(e,i,n){return(0,S.Z)(t,e,{$view:n},r.geometryType,i)})}()}return function(e,i,r){var s,o=(0,a.Z)(n);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.fn&&(l.value=l.fn(e,i,r))}}catch(d){o.e(d)}finally{o.f()}var h,u=(0,c.d9)(t),f=t.primitiveName,v=(0,a.Z)(n);try{for(v.s();!(h=v.n()).done;){var m=h.value;if(m.primitiveName===f){var p=Q(m.propertyName);null!=m.value&&m.value!==u[p]&&(u[p]=m.value)}}}catch(d){v.e(d)}finally{v.f()}return u}}function et(t,e,i,r){var n,s=(0,a.Z)(i);try{for(s.s();!(n=s.n()).done;){var o=n.value;o.valueExpressionInfo&&function(){var t=e[o.primitiveName]&&e[o.primitiveName][o.propertyName];t instanceof d.mz&&(o.fn=function(e,i,n){return(0,S.Z)(t,e,{$view:n},r.geometryType,i)})}()}}catch(l){s.e(l)}finally{s.f()}return function(e,r,n){var s,o=(0,a.Z)(i);try{for(o.s();!(s=o.n()).done;){var h=s.value;h.fn&&(h.value=h.fn(e,r,n))}}catch(l){o.e(l)}finally{o.f()}return(0,p.hP)(t+_.E0.buildOverrideKey(i)).toString()}}function it(t,e){if(!e||0===e.length)return t;var i=(0,c.d9)(t);return _.E0.applyOverrides(i,e),i}function rt(t,e,i,r,n){var s,o=!1,l="",h=(0,a.Z)(t);try{for(h.s();!(s=h.n()).done;){var u=s.value;u.primitiveName===e&&(void 0!==u.value?l+="-".concat(u.primitiveName,"-").concat(u.propertyName,"-").concat(JSON.stringify(u.value)):u.valueExpressionInfo&&(o=!0))}}catch(c){h.e(c)}finally{h.f()}return(0,v.pC)(i)&&"function"==typeof i&&(o=!0),(0,v.pC)(r)&&"function"==typeof r&&(o=!0),(0,v.pC)(n)&&"function"==typeof n&&(o=!0),[o,l]}var nt=function(t){return t&&2===t.length&&t[0].enable&&t[1].enable&&"CIMSolidStroke"===t[0].type&&"CIMSolidFill"===t[1].type&&!t[0].effects&&!t[1].effects}},95954:function(t,e,i){i.d(e,{j:function(){return c}});var r=i(93433),n=i(37762),a=i(15671),s=i(43144),o=i(77981),l=i(25290),h=i(35747),u=i(81434),c=function(){function t(){(0,a.Z)(this,t)}return(0,s.Z)(t,null,[{key:"executeEffects",value:function(t,e,i){var r,a=(0,l.GP)(e),s=new h.M(a),o=(0,n.Z)(t);try{for(o.s();!(r=o.n()).done;){var c=r.value,f=(0,u.h)(c);f&&(s=f.execute(s,c,1.3333333333333333,i))}}catch(v){o.e(v)}finally{o.f()}return s}},{key:"next",value:function(t){var e=t.next();return(0,l.wp)(e),e}},{key:"applyEffects",value:function(t,e,i){if(!t)return e;var a,s=new h.M(e),l=(0,n.Z)(t);try{for(l.s();!(a=l.n()).done;){var c=a.value,f=(0,u.h)(c);f&&(s=f.execute(s,c,1,i))}}catch(_){l.e(_)}finally{l.f()}for(var v,m=null;v=s.next();){var p,d;m?(0,o.l9)(m)?(0,o.l9)(v)&&(p=m.paths).push.apply(p,(0,r.Z)(v.paths)):(0,o.oU)(m)&&(0,o.oU)(v)&&(d=m.rings).push.apply(d,(0,r.Z)(v.rings)):m=v}return m}}]),t}()},91935:function(t,e,i){i.d(e,{Z:function(){return l}});var r=i(1413),n=i(10064),a=i(32718),s=i(92026),o=i(58971);function l(t,e,i,n,o){if((0,s.Wi)(t))return null;var l=t.referencesGeometry()&&o?u(e,n,o):e,h=t.repurposeFeature(l);try{return t.evaluate((0,r.Z)((0,r.Z)({},i),{},{$feature:h}))}catch(c){return a.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",c),null}}var h=new Map;function u(t,e,i){var s=i.transform,l=i.hasZ,u=i.hasM;h.has(e)||h.set(e,function(t){var e={};switch(t){case"esriGeometryPoint":return function(t,i,r,n){return(0,o.U1)(i,e,t,r,n)};case"esriGeometryPolygon":return function(t,i,r,n){return(0,o.Ie)(i,e,t,r,n)};case"esriGeometryPolyline":return function(t,i,r,n){return(0,o.G6)(i,e,t,r,n)};case"esriGeometryMultipoint":return function(t,i,r,n){return(0,o.J9)(i,e,t,r,n)};default:return a.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.Z("mapview-arcade","Unable to handle geometryType: ".concat(t))),function(t){return t}}}(e));var c=h.get(e)(t.geometry,s,l,u);return(0,r.Z)((0,r.Z)({},t),{},{geometry:c})}},93592:function(t,e,i){i.d(e,{$:function(){return a},f:function(){return n}});var r=i(643);function n(t,e){var i;if("string"==typeof t)i=(0,r.hP)(t+"-seed(".concat(e,")"));else{var n=12;i=t^e;do{i=107*(i>>8^i)+n|0}while(0!=--n)}return(1+i/(1<<31))/2}function a(t){return Math.floor(n(t,s)*o)}var s=53290320,o=10},47975:function(t,e,i){i.d(e,{Nr:function(){return P}});var r=i(37762),n=i(15671),a=i(43144),s=i(22018),o=i(11245),l=i(88396),h=i(15245),u=i(38999),c=i(73271),f=i(12233),v=function(){function t(e,i,r,a){(0,n.Z)(this,t),this.center=(0,h.f)(e,i),this.centerT=(0,h.c)(),this.halfWidth=r/2,this.halfHeight=a/2,this.width=r,this.height=a}return(0,a.Z)(t,[{key:"x",get:function(){return this.center[0]},set:function(t){this.center[0]=t}},{key:"y",get:function(){return this.center[1]},set:function(t){this.center[1]=t}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}},{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"serialize",value:function(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}},{key:"findCollisionDelta",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=Math.abs(t.centerT[0]-this.centerT[0]),r=Math.abs(t.centerT[1]-this.centerT[1]),n=(t.halfWidth+this.halfWidth+e)/i,a=(t.halfHeight+this.halfHeight+e)/r,s=Math.min(n,a);return Math.log2(s)}},{key:"extend",value:function(t){var e=Math.min(this.xmin,t.xmin),i=Math.min(this.ymin,t.ymin),r=Math.max(this.xmax,t.xmax)-e,n=Math.max(this.ymax,t.ymax)-i,a=e+r/2,s=i+n/2;this.width=r,this.height=n,this.halfWidth=r/2,this.halfHeight=n/2,this.x=a,this.y=s}}],[{key:"deserialize",value:function(e){return new t(e.readF32(),e.readF32(),e.readInt32(),e.readInt32())}}]),t}(),m=Math.PI/180,p=function(){function t(e,i,r,a){(0,n.Z)(this,t),this._rotationT=(0,o.c)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;var s=r.rect,l=new Float32Array(8);e*=a,i*=a;var h=r.code?s.width*a:r.metrics.width,u=r.code?s.height*a:r.metrics.height;l[0]=e,l[1]=i,l[2]=e+h,l[3]=i,l[4]=e,l[5]=i+u,l[6]=e+h,l[7]=i+u,this._data=l,this._setTextureCoords(s),this._scale=a,this._mosaic=r,this.x=e,this.y=i,this.maxOffset=Math.max(e+h,i+u)}return(0,a.Z)(t,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(t){this._angle=t,(0,s.b)(this._rotationT,-t),this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){return this._offsets||this._setOffsets(this._data),this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){var t=this._mosaic.metrics,e=t.height,i=t.width*this._scale,r=Math.abs(e)*this._scale,n=new Float32Array(8);n[0]=this.x,n[1]=this.y,n[2]=this.x+i,n[3]=this.y,n[4]=this.x,n[5]=this.y+r,n[6]=this.x+i,n[7]=this.y+r;var a=(0,s.m)((0,o.c)(),this._rotationT,this._transform);(0,o.t)(n,n,a);for(var l=1/0,h=1/0,u=0,c=0,f=0;f<4;f++){var m=n[2*f],p=n[2*f+1];l=Math.min(l,m),h=Math.min(h,p),u=Math.max(u,m),c=Math.max(c,p)}var d=u-l,_=c-h,y=l+d/2,g=h+_/2;this._bounds=new v(y,g,d,_)}return this._bounds}},{key:"setTransform",value:function(t){this._transform=t,this._offsets=null}},{key:"_setOffsets",value:function(t){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var e=this._offsets,i=new Float32Array(8),r=(0,s.m)((0,o.c)(),this._rotationT,this._transform);(0,o.t)(i,t,r),e.upperLeft=(0,c.UJ)(8*i[0],8*i[1]),e.upperRight=(0,c.UJ)(8*i[2],8*i[3]),e.lowerLeft=(0,c.UJ)(8*i[4],8*i[5]),e.lowerRight=(0,c.UJ)(8*i[6],8*i[7])}},{key:"_setTextureCoords",value:function(t){var e=t.x,i=t.y,r=t.width,n=t.height;this._texcoords={upperLeft:(0,c.UJ)(e,i),upperRight:(0,c.UJ)(e+r,i),lowerLeft:(0,c.UJ)(e,i+n),lowerRight:(0,c.UJ)(e+r,i+n)}}}]),t}(),d=function(t,e){return{code:0,page:0,sdf:!0,rect:new f.Z(0,0,11,8),textureBinding:e,metrics:{advance:0,height:4,width:t,left:0,top:0}}},_=function(){function t(e,i,a){(0,n.Z)(this,t),this._rotation=0,this._decorate(e,i,a),this.glyphs=e,this.bounds=this._createBounds(e),this.isMultiline=i.length>1,this._hasRotation=0!==a.angle,this._transform=this._createGlyphTransform(this.bounds,a);var s,o=(0,r.Z)(e);try{for(o.s();!(s=o.n()).done;){s.value.setTransform(this._transform)}}catch(l){o.e(l)}finally{o.f()}}return(0,a.Z)(t,[{key:"setRotation",value:function(t){if(0!==t||0!==this._rotation){this._rotation=t;var e=this._transform,i=(0,s.b)((0,o.c)(),t);(0,s.m)(e,i,e);var n,a=(0,r.Z)(this.glyphs);try{for(a.s();!(n=a.n()).done;){n.value.setTransform(this._transform)}}catch(l){a.e(l)}finally{a.f()}}}},{key:"_decorate",value:function(t,e,i){if(i.decoration&&"none"!==i.decoration&&t.length){var n,a=i.scale,s="underline"===i.decoration?30:20,o=t[0].textureBinding,l=(0,r.Z)(e);try{for(l.s();!(n=l.n()).done;){var h=n.value,u=h.startX*a,c=h.startY*a,f=(h.width+h.glyphWidthEnd)*a;t.push(new p(u,c+s*a,d(f,o),1))}}catch(v){l.e(v)}finally{l.f()}}}},{key:"boundsT",get:function(){var t=this.bounds,e=(0,l.s)((0,h.c)(),t.x,t.y);if((0,l.t)(e,e,this._transform),this._hasRotation){var i=Math.max(t.width,t.height);return new v(e[0],e[1],i,i)}return new v(e[0],e[1],t.width,t.height)}},{key:"_createBounds",value:function(t){var e,i=1/0,n=1/0,a=0,s=0,o=(0,r.Z)(t);try{for(o.s();!(e=o.n()).done;){var l=e.value;i=Math.min(i,l.xTopLeft),n=Math.min(n,l.yTopLeft),a=Math.max(a,l.xTopLeft+l.width),s=Math.max(s,l.yBottomRight)}}catch(c){o.e(c)}finally{o.f()}var h=a-i,u=s-n;return new v(i+h/2,n+u/2,h,u)}},{key:"_createGlyphTransform",value:function(t,e){var i=m*e.angle,r=(0,o.c)(),n=(0,h.c)();return(0,s.t)(r,r,(0,l.s)(n,e.xOffset,-e.yOffset)),e.isCIM?(0,s.r)(r,r,i):((0,s.t)(r,r,(0,l.s)(n,t.x,t.y)),(0,s.r)(r,r,i),(0,s.t)(r,r,(0,l.s)(n,-t.x,-t.y))),r}}]),t}(),y=(0,a.Z)((function t(e,i,r,a,s,o){(0,n.Z)(this,t),this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(i,r)),this.end=Math.max(0,Math.max(i,r)),this.end<e.length&&(this.glyphWidthEnd=e[this.end].metrics.width),this.width=a,this.yMin=s,this.yMax=o})),g=function(t){return 10===t},k=function(t){return 32===t};function P(t,e,i){for(var r=i.scale,n=new Array,a=function(t,e,i){for(var r=new Array,n=1/i.scale,a=i.maxLineWidth*n,s=e?t.length-1:0,o=e?-1:t.length,l=e?-1:1,h=s,u=0,c=0,f=h,v=f,m=0,p=1/0,d=0;h!==o;){var _=t[h],P=_.code,x=_.metrics,M=Math.abs(x.top);if(g(P)||k(P)||(p=Math.min(p,M),d=Math.max(d,M+x.height)),g(P))h!==s&&(r.push(new y(t,f,h-l,u,p,d)),p=1/0,d=0),u=0,f=h+l,v=h+l,c=0;else if(k(P))v=h+l,c=0,m=x.advance,u+=x.advance;else if(u>a){if(v!==f){var b=v-2*l;u-=m,r.push(new y(t,f,b,u-c,p,d)),p=1/0,d=0,f=v,u=c}else r.push(new y(t,f,h-l,u,p,d)),p=1/0,d=0,f=h,v=h,u=0;u+=x.advance,c+=x.advance}else u+=x.advance,c+=x.advance;h+=l}var S=new y(t,f,h-l,u,p,d);return S.start>=0&&S.end<t.length&&r.push(S),r}(t,e,i),s=function(t,e){for(var i=0,r=0;r<t.length;r++){var n=t[r].width;i=Math.max(n,i)}var a="underline"===e.decoration?4:0,s=t[0].yMin;return{x:0,y:s,height:t[t.length-1].yMax+e.lineHeight*(t.length-1)+a-s,width:i}}(a,i),o=i.vAlign,l=i.hAlign,h=o===u.TR.Baseline?1:0,c=h?0:o-1,f=(1-h)*-s.y+c*(s.height/2)+-26*(h?1:0),v=0;v<a.length;v++){var m=a[v],d=m.start,P=m.end,x=-1*(l+1)*(m.width/2)-3,M=v*i.lineHeight+f-3;a[v].startX=x,a[v].startY=M;for(var b=d;b<=P;b++){var S=t[b];if(!g(S.code)){var C=new p(x+S.metrics.left,M-S.metrics.top,S,r);x+=S.metrics.advance,n.push(C)}}}return new _(n,a,i)}}}]);
//# sourceMappingURL=8991.b617eecf.chunk.js.map