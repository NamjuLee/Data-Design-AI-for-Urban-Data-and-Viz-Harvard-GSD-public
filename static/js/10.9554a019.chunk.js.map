{"version":3,"file":"static/js/10.9554a019.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/support/infoFor3D.js","../node_modules/@arcgis/core/layers/graphics/editingSupport.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nvar _;!function(_){_.GLTF_BINARY=\"3D_glb\",_.GLTF_JSON=\"3D_gltf\"}(_||(_={}));export{_ as AssetType};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../../Graphic.js\";import t from\"../../core/Collection.js\";import a from\"../../core/Error.js\";import{clone as r}from\"../../core/lang.js\";import{isSome as s,isNone as i}from\"../../core/maybe.js\";import{dataComponents as o}from\"../../core/urlUtils.js\";import{generateUUID as d}from\"../../core/uuid.js\";import{normalizeCentralMeridian as n}from\"../../geometry/support/normalizeUtils.js\";import{isEditBusLayer as l,editEventBus as u}from\"../mixins/EditBusLayer.js\";import{AssetType as p}from\"../support/infoFor3D.js\";function c(e){return e&&null!=e.applyEdits}async function h(e,t,a,s={}){let i,o;const d={edits:a,result:new Promise(((e,t)=>{i=e,o=t}))};e.emit(\"apply-edits\",d);try{const{results:o,edits:d}=await m(e,t,a,s),n=e=>e.filter((e=>!e.error)).map(r),p={edits:d,addedFeatures:n(o.addFeatureResults),updatedFeatures:n(o.updateFeatureResults),deletedFeatures:n(o.deleteFeatureResults),addedAttachments:n(o.addAttachmentResults),updatedAttachments:n(o.updateAttachmentResults),deletedAttachments:n(o.deleteAttachmentResults)};return o.editedFeatureResults?.length&&(p.editedFeatures=o.editedFeatureResults),(p.addedFeatures.length||p.updatedFeatures.length||p.deletedFeatures.length||p.addedAttachments.length||p.updatedAttachments.length||p.deletedAttachments.length)&&(e.emit(\"edits\",p),l(e)&&u.emit(\"edits\",{layer:e,event:p})),i(p),o}catch(n){throw o(n),n}}async function m(e,t,r,s){if(await e.load(),!c(t))throw new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e});if(!e.editingEnabled)throw new a(`${e.type}-layer:editing-disabled`,\"Editing is disabled for layer\",{layer:e});const{edits:i,options:o}=await y(e,r,s);return i.addFeatures.length||i.updateFeatures.length||i.deleteFeatures.length||i.addAttachments.length||i.updateAttachments.length||i.deleteAttachments.length?{edits:i,results:await t.applyEdits(i,o)}:{edits:i,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}}async function y(e,r,i){const o=r&&(r.addFeatures||r.updateFeatures||r.deleteFeatures),d=r&&(r.addAttachments||r.updateAttachments||r.deleteAttachments),n=s(e.infoFor3D);if(!r||!o&&!d)throw new a(`${e.type}-layer:missing-parameters`,\"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required\");if(!e.capabilities.data.isVersioned&&i&&i.gdbVersion)throw new a(`${e.type}-layer:invalid-parameter`,\"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'\");if(!e.capabilities.editing.supportsRollbackOnFailure&&i&&i.rollbackOnFailureEnabled)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'\");if(!e.capabilities.editing.supportsGlobalId&&i&&i.globalIdUsed)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'\");if(!e.capabilities.editing.supportsGlobalId&&d)throw new a(`${e.type}-layer:invalid-parameter`,\"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'\");if((!i||!i.globalIdUsed)&&d)throw new a(`${e.type}-layer:invalid-parameter`,\"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true\");const l={...i};if(null!=l.rollbackOnFailureEnabled||e.capabilities.editing.supportsRollbackOnFailure||(l.rollbackOnFailureEnabled=!0),!1===l.rollbackOnFailureEnabled&&\"original-and-current-features\"===l.returnServiceEditsOption)throw new a(`${e.type}-layer:invalid-parameter`,\"'original-and-current-features' is valid for 'returnServiceEditsOption' only when 'rollBackOnFailure' is true.\");if(!e.capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference&&l.returnServiceEditsInSourceSR)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'returnServiceEditsInSourceSR' parameter. See: 'capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference'\");if(l.returnServiceEditsInSourceSR&&\"original-and-current-features\"!==l.returnServiceEditsOption)throw new a(`${e.type}-layer:invalid-parameter`,\"'returnServiceEditsOption' is valid only when 'returnServiceEditsOption' is set to 'original-and-current-features'\");const u={...r};if(u.addFeatures=r&&t.isCollection(r.addFeatures)?r.addFeatures.toArray():u.addFeatures||[],u.updateFeatures=r&&t.isCollection(r.updateFeatures)?r.updateFeatures.toArray():u.updateFeatures||[],u.deleteFeatures=r&&t.isCollection(r.deleteFeatures)?r.deleteFeatures.toArray():u.deleteFeatures||[],u.addFeatures.length&&!e.capabilities.operations.supportsAdd)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support adding features.\");if(u.updateFeatures.length&&!e.capabilities.operations.supportsUpdate)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support updating features.\");if(u.deleteFeatures.length&&!e.capabilities.operations.supportsDelete)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support deleting features.\");u.addAttachments=u.addAttachments||[],u.updateAttachments=u.updateAttachments||[],u.deleteAttachments=u.deleteAttachments||[],u.addFeatures=u.addFeatures.map(v),u.updateFeatures=u.updateFeatures.map(v),u.addAssets=[];const p=i&&i.globalIdUsed||n;u.addFeatures.forEach((t=>g(t,e,p))),u.updateFeatures.forEach((t=>F(t,e,p))),u.deleteFeatures.forEach((t=>b(t,e,p))),u.addAttachments.forEach((t=>w(t,e))),u.updateAttachments.forEach((t=>w(t,e))),n&&await I(u,e);return{edits:await A(u),options:l}}function f(e,t,r){if(r){if(\"attributes\"in e&&!e.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Feature should have 'globalId' when 'globalIdUsed' is true\");if(!(\"attributes\"in e)&&!e.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"'globalId' of the feature should be passed when 'globalIdUsed' is true\")}if(\"geometry\"in e&&s(e.geometry)){if(e.geometry.hasZ&&!1===t.capabilities.data.supportsZ)throw new a(`${t.type}-layer:z-unsupported`,\"Layer does not support z values while feature has z values.\");if(e.geometry.hasM&&!1===t.capabilities.data.supportsM)throw new a(`${t.type}-layer:m-unsupported`,\"Layer does not support m values while feature has m values.\")}}function g(e,t,a){f(e,t,a)}function b(e,t,a){f(e,t,a)}function F(e,t,r){if(f(e,t,r),\"geometry\"in e&&s(e.geometry)&&!t.capabilities.editing.supportsGeometryUpdate)throw new a(`${t.type}-layer:unsupported-operation`,\"Layer does not support geometry updates.\")}function w(e,t){const{feature:r,attachment:s}=e;if(!r||\"attributes\"in r&&!r.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to a feature with 'globalId'\");if(!(\"attributes\"in r)&&!r.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to 'globalId' of the parent feature\");if(!s.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'globalId'\");if(!s.data&&!s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'data' or 'uploadId'\");if(!(s.data instanceof File&&!!s.data.name)&&!s.name)throw new a(`${t.type}-layer:invalid-parameter`,\"'name' is required when attachment is specified as Base64 encoded string using 'data'\");if(!t.capabilities.editing.supportsUploadWithItemId&&s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'\");if(\"string\"==typeof s.data){const e=o(s.data);if(e&&!e.isBase64)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment 'data' should be a Blob, File or Base64 encoded string\")}}async function A(e){const t=e.addFeatures,a=e.updateFeatures,r=t.concat(a).map((e=>e.geometry)),s=await n(r),i=t.length,o=a.length;return s.slice(0,i).forEach(((t,a)=>e.addFeatures[a].geometry=t)),s.slice(i,i+o).forEach(((t,a)=>e.updateFeatures[a].geometry=t)),e}function v(t){const a=new e;return t.attributes||(t.attributes={}),a.geometry=t.geometry,a.attributes=t.attributes,a}async function I(e,t){if(i(t.infoFor3D))return;const{infoFor3D:a}=t;let r=!1;for(const i of a.editFormats)if(i===p.GLTF_BINARY){r=!0;break}const s=[];for(const i of e.addFeatures)s.push(E(i,e,t,r));for(const i of e.updateFeatures)s.push(E(i,e,t,r));const o=await Promise.allSettled(s);for(const i of o)if(\"rejected\"===i.status)throw i.reason}async function E(e,t,r,o){if(i(e.geometry)||\"mesh\"!==e.geometry.type)return;const n=e.geometry,l=r.globalIdField;if(s(r.parsedUrl)&&s(n.external)&&Array.isArray(n.external.source)&&1===n.external.source.length&&\"source\"in n.external.source[0]&&\"string\"==typeof n.external.source[0].source&&n.external.source[0].source.startsWith(r.parsedUrl.path))return;if(!o)throw new a(`${r.type}-layer:binary-gltf-asset-not-supported`,\"3DObjectFeatureLayer requires binary glTF (.glb) support for updating mesh geometry.\");const u=await n.toBinaryGLTF(),c=await u.buffer(),h=`{${d()}}`,m=`${h}.glb`;t.addAssets.push({featureGlobalId:e.getAttribute(l),assetMapGlobalId:h,assetName:m,flags:0,data:c.data,mimeType:c.type,assetType:p.GLTF_BINARY,feature:e})}export{h as applyEdits};\n"],"names":["_","c","e","applyEdits","h","t","a","s","d","edits","result","Promise","i","o","emit","m","results","n","filter","error","map","r","p","addedFeatures","addFeatureResults","updatedFeatures","updateFeatureResults","deletedFeatures","deleteFeatureResults","addedAttachments","addAttachmentResults","updatedAttachments","updateAttachmentResults","deletedAttachments","deleteAttachmentResults","editedFeatureResults","length","editedFeatures","l","u","layer","event","load","type","editingEnabled","y","options","addFeatures","updateFeatures","deleteFeatures","addAttachments","updateAttachments","deleteAttachments","infoFor3D","capabilities","data","isVersioned","gdbVersion","editing","supportsRollbackOnFailure","rollbackOnFailureEnabled","supportsGlobalId","globalIdUsed","returnServiceEditsOption","supportsReturnServiceEditsInSourceSpatialReference","returnServiceEditsInSourceSR","toArray","operations","supportsAdd","supportsUpdate","supportsDelete","v","addAssets","forEach","g","F","b","w","I","A","f","attributes","globalIdField","globalId","geometry","hasZ","supportsZ","hasM","supportsM","supportsGeometryUpdate","feature","attachment","uploadId","File","name","supportsUploadWithItemId","isBase64","concat","slice","editFormats","push","E","allSettled","status","reason","parsedUrl","external","Array","isArray","source","startsWith","path","toBinaryGLTF","buffer","featureGlobalId","getAttribute","assetMapGlobalId","assetName","flags","mimeType","assetType","GLTF_BINARY","GLTF_JSON"],"sourceRoot":""}